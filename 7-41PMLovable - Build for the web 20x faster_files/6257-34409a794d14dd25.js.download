try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7e447a33-d492-41f9-a232-ddd8ec9e4f6c",e._sentryDebugIdIdentifier="sentry-dbid-7e447a33-d492-41f9-a232-ddd8ec9e4f6c")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6257],{76678:function(e,t,s){s.d(t,{g:function(){return p},s:function(){return g}});var a=s(57437),n=s(2265),r=s(44956),i=s(7355),l=s(26110),o=s(41135),c=s(5103),d=s(52558),u=s(61922),m=s(71759);function p(e){var t;let{dialogDescription:s}=e,n=(0,u.aS)(e=>e.currentWorkspace),r=(0,u.aS)(e=>e.hasFetchedCurrentWorkspace),i=(0,u.aS)(e=>e.memberships),{authUser:l}=(0,d.Eu)(),o=null===(t=i.find(e=>e.user_id===(null==l?void 0:l.uid)))||void 0===t?void 0:t.role;return(0,m.MD)()?(0,a.jsx)(h,{dialogDescription:s}):(0,a.jsx)(x,{hasFetchedWorkspace:r,dialogDescription:s,myWorkspaceRole:o,workspace:n,isLoggedIn:!!l})}function h(e){var t;let{dialogDescription:s}=e,{authUser:n}=(0,d.Eu)(),{projectWorkspace:r,workspaceMemberships:i}=(0,c.f)(),l=null===(t=i.find(e=>e.user_id===(null==n?void 0:n.uid)))||void 0===t?void 0:t.role,o=(0,m.hO)(e=>e.hasFetchedProjectWorkspace);return(0,a.jsx)(x,{dialogDescription:s,myWorkspaceRole:l,workspace:r,hasFetchedWorkspace:o,isLoggedIn:!!n})}function x(e){let{dialogDescription:t,myWorkspaceRole:s,workspace:c,hasFetchedWorkspace:d,isLoggedIn:u}=e,m=!!c,{title:p,description:h}=(0,n.useMemo)(()=>d&&!m?{title:"Error",description:"Something went wrong."}:{title:"Upgrade required",description:t||"Upgrade to Pro and unlock more features & usage"},[d,m,t]);return(0,a.jsxs)(l.cZ,{className:"max-h-[90vh] overflow-y-auto md:max-w-3xl",size:"lg",children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(o.xx,{className:"mb-1 size-9 shrink-0"}),(0,a.jsx)(l.$N,{className:"text-2xl",children:u?p:"Upgrade required"}),(0,a.jsx)(l.Be,{className:"text-sm",children:u?h:t||"Upgrade to Pro and unlock more features & usage"})]}),u?d?c?(0,a.jsx)(r.om,{planCardContext:"outOfCredits",workspace:c,myWorkspaceRole:s,children:(0,a.jsx)(i.SV,{showEnterprise:!1})}):(0,a.jsx)(g,{}):(0,a.jsx)(r._M,{}):(0,a.jsx)(r.om,{planCardContext:"loggedOut",myWorkspaceRole:void 0,children:(0,a.jsx)(i.SV,{showEnterprise:!1})})]})}let g=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"We couldn't load the data needed to upgrade your workspace."}),(0,a.jsxs)("p",{children:["Please refresh the page and try again. If the problem continues, contact our"," ",(0,a.jsx)("a",{href:"/support",className:"underline",children:"Support"}),"."]})]})},34319:function(e,t,s){s.d(t,{v:function(){return i}});var a=s(57437),n=s(94508),r=s(46170);let i=e=>{let{plan:t,className:s}=e,i=(0,r.ZN)(t);return(0,a.jsx)("span",{className:(0,n.cn)("rounded-full px-2 py-px text-[10px] font-medium uppercase transition-colors duration-150 ease-in-out","free"===t?"bg-muted text-muted-foreground":"bg-brand-twilight-primary text-brand-twilight-primary-foreground",s),children:i})}},60616:function(e,t,s){s.d(t,{A:function(){return N}});var a=s(57437),n=s(92850),r=s(49852),i=s(33145),l=s(46214),o=s(2265),c=s(14438),d=s(61922),u=s(82176),m=s(62869),p=s(26110),h=s(57346),x=s(95186),g=s(93022),f=s(49284),j=s(10531),v=s(89668);let b=["This offer is for new Lovable users only (gotta share the magic with fresh eyes).","Rewards are unlocked once your invite actually publishes an app. No ghost referrals, please.","We reserve the right to change, pause, or end this program anytime. We're experimental like that.","Don't spam or post your link where it doesn't belong. Let's keep it classy.","If we suspect sketchy behavior, we may withhold rewards or deactivate your link.","One reward per new user invited. No stacking loopholes - we're nerds, we'll catch it."],y=e=>{let{back:t}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)(p.fK,{className:"flex flex-col gap-4",children:[(0,a.jsxs)(m.z,{onClick:t,variant:"ghost",className:"w-fit px-2",children:[(0,a.jsx)(h.Z,{name:"arrow_left_alt"}),"Back"]}),(0,a.jsx)(p.$N,{children:"Terms and conditions"})]}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)("ul",{className:"flex max-h-[15rem] list-disc flex-col gap-2 overflow-auto px-5",children:b.map((e,t)=>(0,a.jsx)("li",{children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:e})},t))})})]})},w=[{icon:"bolt",children:"Share your invite link"},{icon:"crown",children:(0,a.jsxs)(a.Fragment,{children:["They sign up and get ",(0,a.jsx)("b",{children:"extra 10 credits"})]})},{icon:"chat",children:(0,a.jsxs)(a.Fragment,{children:["You get ",(0,a.jsx)("b",{children:"10 credits"})," once they publish their first website"]})}],N=e=>{var t,s,b;let{onSuccess:N}=e,[_,k]=(0,o.useState)(!1),S=(0,d.aS)(e=>e.currentWorkspace),[C,E]=(0,o.useState)(!1),z=null!==(b=(0,u.dl)(j.P.ReferralCopyConfetti))&&void 0!==b&&b,A=(0,n.a)(v.t.referralCode({referralCode:null==S?void 0:S.referral_code,workspaceId:null==S?void 0:S.id})),I=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.zIndex="10001",e.style.pointerEvents="none",document.body.appendChild(e),I.current=new r.Z({canvas:e}),()=>{document.body.removeChild(e)}},[]);let D=window.location.protocol+"//"+window.location.host,O="".concat(D,"/invite/").concat(null===(t=A.data)||void 0===t?void 0:t.referral_code),P=async()=>{if(!_)try{if(await navigator.clipboard.writeText(O),k(!0),z){var e;null===(e=I.current)||void 0===e||e.addConfetti({emojis:["❤️","\uD83D\uDC96","\uD83D\uDC9D","\uD83D\uDC97","\uD83D\uDC93"],emojiSize:58})}l.ZP.capture(f.PU.COPIED_LINK,{method:"button",did_confetti:z}),setTimeout(()=>{k(!1)},2e3)}catch(e){c.Am.error("Failed to copy link")}};return(0,a.jsxs)(p.cZ,{hideCloseButton:!0,className:"pointer-events-auto flex max-h-[95vh] flex-col gap-4 overflow-y-auto border-none bg-background outline-none",children:[(0,a.jsx)(p.$N,{className:"sr-only",children:"Refer & Earn"}),C?(0,a.jsx)(y,{back:()=>E(!1)}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.fK,{children:(0,a.jsxs)("div",{className:"relative h-fit overflow-hidden rounded-xl",children:[(0,a.jsx)("button",{onClick:N,className:"absolute right-4 top-4 z-10 bg-transparent",tabIndex:-1,children:(0,a.jsx)(h.Z,{name:"close",className:"h-5 w-5 cursor-pointer text-muted-foreground"})}),(0,a.jsx)(i.default,{src:"/img/referral/dark-spread.png",alt:"Referral",className:"hidden w-full object-contain dark:block",width:406,height:188,priority:!0}),(0,a.jsx)(i.default,{src:"/img/referral/light-spread.png",alt:"Lovable 2.0",className:"block w-full object-contain dark:hidden",width:406,height:188,priority:!0})]})}),(0,a.jsxs)("div",{className:"md:py-2",children:[(0,a.jsx)("div",{className:"mb-3 text-base font-normal text-muted-foreground",children:"How it works:"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:w.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(h.Z,{name:e.icon,className:"h-5 w-5"}),(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("span",{className:"text-base font-normal text-foreground",children:e.children})})]},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-3 text-base font-normal text-muted-foreground",children:"Your invite link:"}),A.isLoading?(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(g.O,{className:"h-12 w-full rounded-xl"})}):(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2 rounded-xl bg-muted p-2 sm:flex-row sm:space-y-0",children:[(0,a.jsxs)("div",{className:"flex w-full flex-1 items-center px-2",children:[(0,a.jsx)(h.Z,{name:"link",className:"mr-2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)(x.I,{onCopy:()=>{l.ZP.capture(f.PU.COPIED_LINK,{method:"input_copy",did_confetti:z})},value:A.error?"Error fetching the link, sorry":O,tabIndex:-1,readOnly:!0,className:"border-none shadow-none focus:outline-none focus:ring-0 focus-visible:ring-0"})]}),(0,a.jsx)(m.z,{onClick:P,className:"w-full rounded-xl sm:w-24",variant:"default",disabled:A.isLoading||!(null===(s=A.data)||void 0===s?void 0:s.referral_code),children:_?"Copied!":"Copy link"})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(m.z,{variant:"link",className:"h-fit w-fit py-0 text-xs font-normal text-muted-foreground underline",onClick:()=>E(!0),children:"View Terms and Conditions"})})]})]})}},15492:function(e,t,s){s.d(t,{B:function(){return n}});var a=s(89651);let n=function(e){let{defaultValue:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defaultValue:!1},[s,n]=(0,a.Z)(e,{defaultValue:t});return[s,n]}},96027:function(e,t,s){s.d(t,{E:function(){return g}});var a=s(57437),n=s(5978),r=s(2265),i=s(27648),l=s(99376),o=s(46214),c=s(94508),d=s(15492),u=s(62869),m=s(57346),p=s(25566),h=e=>{let{type:t,message:s,persistDismiss:n=!1,storageKey:h,bgColor:x,href:g,onClick:f,className:j,darkCloseIcon:v=!1}=e,b=(0,l.usePathname)(),y=(0,r.useRef)(null),[w,N]=(0,d.B)(h||"default-banner-key",{defaultValue:!0}),[_,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{C(!0),k(!0)},[]);let E=(null==b?void 0:b.startsWith("/projects/"))&&["ph-launch-banner","rebrand-banner"].includes(h||""),z=!E&&(n?w:_);if(E)return null;if(n&&!h)return console.error("storageKey is required when persistDismiss is true"),null;if(!z||p.env.TEST_E2E)return null;let A=(0,a.jsxs)("div",{ref:y,className:(0,c.cn)("z-[1050] hidden w-full items-center justify-between px-2 py-2 text-sm text-white transition-opacity duration-300 md:px-4 md:text-base",x||("error"===t?"bg-destructive-primary":"bg-background"),j,S&&"flex"),children:[(0,a.jsx)("div",{className:"flex flex-grow items-center justify-center space-x-4 pr-6 md:text-center",children:s}),(0,a.jsx)(u.z,{variant:"ghost",size:"icon",className:(0,c.cn)("hover:bg-transparent md:absolute md:right-2",v?"text-primary-foreground hover:text-primary-foreground":"text-primary"),onClick:e=>{e.stopPropagation(),n?N(!1):k(!1),o.ZP.capture("banner_dismissed",{banner_type:t,message:s,persisted:n})},children:(0,a.jsx)(m.Z,{name:"close_small"})})]});return g?(0,a.jsx)(i.default,{href:g,target:"_blank",rel:"noopener noreferrer",onClick:f,className:"transition-opacity hover:opacity-90",children:A}):A},x=s(78099);let g=e=>{let{className:t}=e,[s,i]=(0,r.useState)({showStatusBanner:!1,statusBannerContent:""});return((0,r.useEffect)(()=>{(async()=>{try{let e=(0,n.JU)(x.db,"system","info"),t=await (0,n.QT)(e);t.exists()&&i(t.data())}catch(e){console.error("Failed to fetch system info:",e)}})()},[]),s.showStatusBanner&&s.statusBannerContent)?(0,a.jsx)(h,{message:s.statusBannerContent,type:"error",className:t}):null}},32429:function(e,t,s){s.d(t,{G:function(){return c},h:function(){return o}});var a=s(57437),n=s(92850),r=s(2265),i=s(51408);let l=(0,r.createContext)(null);function o(e){let{children:t,user:s}=e,{data:o,isLoading:c}=(0,n.a)(i.V.experimentalFeatures({user:s})),d=(0,r.useMemo)(()=>({features:o||null,isLoading:c}),[o,c]);return(0,a.jsx)(l.Provider,{value:d,children:t})}function c(){let e=(0,r.useContext)(l);if(!e)throw Error("LabsFeaturesContext not found");return e}},90962:function(e,t,s){s.d(t,{A4:function(){return d},C0:function(){return c},Lm:function(){return o}});var a=s(73521),n=s(85755),r=s(93252),i=s(67457),l=s(74494);let o=(0,i.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#2d333b",caret:"#c9d1d9",foreground:"#c9d1d9",gutterActiveForeground:"#c9d1d9",gutterForeground:"#6e7681",gutterBorder:"#21262d",lineHighlight:"#c9d1d910",selectionMatch:"#3392FF44"},styles:[{tag:r.pJ.comment,color:"#8b949e"},{tag:r.pJ.variableName,color:"#c9d1d9"},{tag:[r.pJ.string,r.pJ.special(r.pJ.brace)],color:"#a5d6ff"},{tag:r.pJ.number,color:"#79c0ff"},{tag:r.pJ.bool,color:"#ff7b72"},{tag:r.pJ.null,color:"#ff7b72"},{tag:r.pJ.keyword,color:"oklch(0.833 0.145 321.434)"},{tag:r.pJ.operator,color:"#ff7b72"},{tag:r.pJ.className,color:"#ffa657"},{tag:r.pJ.definition(r.pJ.typeName),color:"#ffa657"},{tag:r.pJ.typeName,color:"#ffa657"},{tag:r.pJ.angleBracket,color:"#7ee787"},{tag:r.pJ.tagName,color:"#7ee787"},{tag:r.pJ.attributeName,color:"#79c0ff"},{tag:r.pJ.function(r.pJ.variableName),color:"#d2a8ff"},{tag:r.pJ.function(r.pJ.propertyName),color:"#d2a8ff"},{tag:r.pJ.squareBracket,color:"#c9d1d9"},{tag:r.pJ.brace,color:"#c9d1d9"}]}),c=(0,i.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#C7E4FF",caret:"#24292e",foreground:"#24292e",gutterActiveForeground:"#24292e",gutterForeground:"#57606a",gutterBorder:"#e8eaed",lineHighlight:"#2437921a",selectionMatch:"#3392FF33"},styles:[{tag:r.pJ.comment,color:"#6e7781"},{tag:r.pJ.variableName,color:"#24292e"},{tag:[r.pJ.string,r.pJ.special(r.pJ.brace)],color:"#0a3069"},{tag:r.pJ.number,color:"#0550ae"},{tag:r.pJ.bool,color:"#cf222e"},{tag:r.pJ.null,color:"#cf222e"},{tag:r.pJ.keyword,color:"#3479E5"},{tag:r.pJ.operator,color:"#cf222e"},{tag:r.pJ.className,color:"#953800"},{tag:r.pJ.definition(r.pJ.typeName),color:"#953800"},{tag:r.pJ.typeName,color:"#953800"},{tag:r.pJ.angleBracket,color:"#116329"},{tag:r.pJ.tagName,color:"#116329"},{tag:r.pJ.attributeName,color:"#0550ae"},{tag:r.pJ.function(r.pJ.variableName),color:"#8250df"},{tag:r.pJ.function(r.pJ.propertyName),color:"#8250df"},{tag:r.pJ.squareBracket,color:"#24292e"},{tag:r.pJ.brace,color:"#24292e"},{tag:[r.pJ.name,r.pJ.deleted,r.pJ.character,r.pJ.propertyName,r.pJ.macroName],color:"#0E7490"},{tag:[r.pJ.meta],color:"#0E7490"},{tag:[r.pJ.definition(r.pJ.name),r.pJ.separator],color:"#a3be8c"},{tag:[r.pJ.operator,r.pJ.operatorKeyword],color:"#15803D"},{tag:[r.pJ.string],color:"#15803D"},{tag:r.pJ.link,color:"#15803D",textDecoration:"underline",textUnderlinePosition:"under"}]}),d=[(0,n.eJ)({jsx:!0,typescript:!0}),(0,a.dy)({autoCloseTags:!0}),l.T0]},74494:function(e,t,s){s.d(t,{Px:function(){return d},T0:function(){return c}});var a=s(62997),n=s(90277);let r=a.Py.define(),i=a.QQ.define({create:()=>null,update(e,t){for(let e of t.effects)if(e.is(r))return e.value;return e}}),l=n.p.line({attributes:{style:"background-color: rgba(255, 255, 0, 0.2); border-left: 3px solid #ffcc00;"}}),o=n.lg.fromClass(class{update(e){e.state.field(i)!==e.startState.field(i)&&(this.decorations=this.buildDecorations(e.view))}buildDecorations(e){let t=e.state.field(i);if(null===t)return n.p.none;let{startLine:s,endLine:a}=t,r=[];if(s===a){let t=e.state.doc.line(Math.min(s,e.state.doc.lines));r.push({from:t.from,to:t.from,value:l})}else for(let t=s;t<=a&&!(t>e.state.doc.lines);t++){let s=e.state.doc.line(t);r.push({from:s.from,to:s.from,value:l})}return n.p.set(r)}constructor(e){this.decorations=this.buildDecorations(e)}},{decorations:e=>e.decorations}),c=[i,o],d=(e,t,s)=>{let a=s||t,i=Math.floor((t+a)/2),l=e.state.doc.line(Math.min(i,e.state.doc.lines)),o=e.state.doc.line(Math.min(t,e.state.doc.lines));e.dispatch({effects:[r.of({startLine:t,endLine:a}),n.tk.scrollIntoView(l.from,{y:"center"})],selection:{anchor:o.from}})}},93261:function(e,t,s){var a=s(57437),n=s(59040),r=s(2265),i=s(14438),l=s(62869),o=s(26110),c=s(57346),d=s(64040),u=s(49131),m=s(21288),p=s(77113);let h=e=>{try{return(0,n.xX)(e)}catch(t){return m.logging.error("Failed to get UTF-8 domain",{domain:e,error:t}),e}};t.Z=e=>{let{domain:t,showRemove:s,showIcon:n,refetchDomains:m}=e,[x,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),y=(0,p.iZ)(e=>e.project),w=async e=>{b(!0);try{let t=(0,u.SJ)();await t.delete("/projects/".concat(null==y?void 0:y.id,"/domains/").concat(e)),null==m||m(),b(!1),g(!1),i.Am.success("Domain removed",{description:'Your custom domain "'.concat(e,'" was successfully removed from the project.')})}catch(e){b(!1),(0,d.Eo)(e)}},N=()=>{j(!0),null==m||m(),setTimeout(()=>j(!1),1e3)},_=h(t.domain);return(0,a.jsxs)("li",{className:"flex min-h-7 w-full items-center gap-2 text-sm",children:["active"!==t.status?(0,a.jsxs)("span",{className:"flex-grow truncate text-muted-foreground",title:"The domain ".concat(_," is still being configured..."),onClick:()=>N(),children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_,(0,a.jsxs)("span",{className:"relative ml-2 mr-1 inline-flex size-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex size-2 rounded-full bg-primary"})]})]}):(0,a.jsxs)("span",{className:"flex-grow truncate",title:t.domain,children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_]}),s&&(0,a.jsxs)(o.Vq,{open:x,onOpenChange:g,children:[(0,a.jsx)(o.hg,{asChild:!0,children:(0,a.jsx)(l.z,{variant:"ghost",size:"icon-sm",type:"button",className:"ml-auto",children:(0,a.jsx)(c.Z,{name:"delete",size:"small"})})}),(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Remove ",_,"?"]}),(0,a.jsx)(o.Be,{children:"This will disconnect the domain from this project. You will need to reconfigure it if you will want to use it with this project in the future."})]}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>{g(!1)},children:"Cancel"}),(0,a.jsx)(l.z,{variant:"destructive",size:"sm",onClick:()=>w(t.domain),loading:v,children:"Remove"})]})]})]}),"active"!==t.status?(0,a.jsx)("span",{title:"Refresh status",className:"ml-auto cursor-pointer",onClick:()=>N(),children:(0,a.jsx)(c.Z,{name:"refresh",size:"small",className:f?"animate-spin":""})}):(0,a.jsx)("a",{href:"https://".concat(t.domain),target:"_blank",title:"Open in a new tab",rel:"noopener noreferrer",className:"ml-auto text-muted-foreground",children:(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small"})})]})}},95565:function(e,t,s){s.d(t,{W:function(){return r}});var a=s(92850),n=s(49131);let r=e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.a)({queryKey:["projects",t,"integrations","ai_gateway"],queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/integrations/ai_gateway")),enabled:s&&!!t})}},26237:function(e,t,s){s.d(t,{C:function(){return i}});var a=s(2265),n=s(77113);let r=e=>{try{if(null==e)return!1;let t=e.toDate();if(new Date().getTime()-t.getTime()>6e4)return!1;return!0}catch(e){return!1}},i=()=>{let e=(0,n.iZ)(e=>e.project),t=null==e?void 0:e.locked_at,[s,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!t||!r(t)){i(!1);return}let e=setInterval(()=>{let s=r(t);i(s),s||clearInterval(e)},250);return()=>clearInterval(e)},[t]),s}},69084:function(e,t,s){s.d(t,{z:function(){return i}});var a=s(57437),n=s(92825),r=s(79858);let i=e=>{var t;let{isInteractive:s=!1,className:i,workspace:l,...o}=e,c=(0,r.Q)(null==l?void 0:l.id),d=null==l?void 0:l.name,u=null!==(t=null==l?void 0:l.image_url)&&void 0!==t?t:void 0;return(0,a.jsx)(n.N,{name:d,isInteractive:s,photoSrc:u,userColor:c,className:i,isWorkspace:!0,...o})}},14411:function(e,t,s){s.d(t,{H:function(){return j}});var a=s(57437),n=s(57346),r=s(27132),i=s(94508),l=s(79358);let o=e=>{let{bonusCredits:t}=e,s=(0,r.Z)("md");return(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center justify-between gap-2 rounded-md bg-muted p-3 text-base md:text-sm"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Z,{name:"rewarded_ads",size:s?"default":"small"}),(0,a.jsx)("p",{children:"Bonus Credits"})]}),(0,a.jsx)("p",{className:"text-sm md:text-xs",children:(0,l.H)(t)})]})};var c=s(55157),d=s(81103),u=s(66491),m=s(63070),p=s(31091),h=s(3813);let x=e=>{let{progress:t,label:s,description:r,tooltip:o,showUpgrade:x,rolloverLabel:g}=function(e){let{dailyLimit:t,dailyUsed:s,billingPeriodEndDate:a,type:n,rolloverCredits:r,rolloverCreditsLimit:i}=e,o=t-s,c=o>0;switch(n){case"free":{let a=e.totalCreditsUsedInBillingPeriod>=30,n=a?100:s/t*100,o=a?(0,l.u)(30,30):(0,l.u)(s,t),d=a?"You've used all your free monthly credits":c?"".concat((0,l.H)(s)," of your daily credits used"):"Your daily credits renew at midnight UTC",h="on ".concat((0,u.WU)((0,m.N)((0,p.z)(new Date,1)),"MMMM d"));return{progress:n,label:o,description:d,tooltip:a?"You'll receive new credits ".concat(h," (at midnight UTC)."):"You get 5 free credits daily (up to 30 per month).",showUpgrade:a||!c,rolloverLabel:i&&void 0!==r?"".concat(i-r,"/").concat(i):void 0}}case"paidWithMonthlyLimit":{let t=e.billingLimit-e.billingUsed>0,s=e.billingUsed/e.billingLimit*100,n=(0,l.u)(e.billingUsed,e.billingLimit),d=c?"You have ".concat((0,l.H)(o)," daily ").concat(1===o?"credit":"credits"," to use first"):"".concat((0,l.H)(e.billingUsed)," of your monthly credits used"),m=a?"on ".concat((0,u.WU)(a,"MMMM d")," at ").concat((0,u.WU)(a,"HH:mm")):"each month";return{progress:s,label:n,description:d,tooltip:c?"Daily credits are used before monthly credits.":t?"Your daily credits renew at midnight UTC.":"Your monthly credits will renew ".concat(m,". You will still receive 5 daily credits."),showUpgrade:!t,rolloverLabel:i&&void 0!==r?"".concat(i-r,"/").concat(i):void 0}}case"paidWithoutMonthlyLimit":{let e=s/t*100,a=(0,l.u)(s,t);return{progress:e,label:a,description:c?"".concat((0,l.H)(s)," of your daily credits used"):"Your daily credits renew at midnight UTC",tooltip:"You get ".concat(t," credits daily"),showUpgrade:!1,rolloverLabel:i&&void 0!==r?"".concat(i-r,"/").concat(i):void 0}}default:return n}}(e),{isOwnerOfWorkspace:f,rolloverCredits:j,rolloverCreditsLimit:v}=e,b=v&&void 0!==j?v-j:0,{openSettings:y}=(0,c.r)(),w=v&&v>0?b/v*100:0,N=(0,h.Ys)();return(0,a.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-1 rounded-xl bg-muted p-4 md:rounded-md md:p-3",{}),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:(0,i.cn)("text-base font-medium md:text-sm",{}),children:"Credits Used"}),f&&(0,a.jsx)("p",{className:(0,i.cn)("cursor-pointer text-sm font-medium text-muted-foreground transition-opacity duration-150 ease-in-out hover:opacity-80 md:text-xs",{"text-muted-foreground":x}),onClick:()=>{y("billing")},children:x?"Upgrade":"Manage"})]}),(0,a.jsx)("div",{className:"mt-2 flex w-full items-center gap-2",children:(0,a.jsxs)("div",{className:"min-w-0 flex-1 space-y-2",children:[void 0!==j&&void 0!==v&&v>0&&N&&(0,a.jsxs)("div",{className:"flex w-full items-center gap-1",children:[(0,a.jsxs)(d.u,{instant:!0,children:[(0,a.jsx)(d.aJ,{asChild:!0,children:(0,a.jsx)("p",{className:"w-12 flex-shrink-0 cursor-pointer whitespace-nowrap text-sm text-muted-foreground md:text-xs",children:"Rollover"})}),(0,a.jsx)(d._v,{children:"Unused credits from last month"})]}),(0,a.jsx)("div",{className:"relative h-[7px] flex-1 overflow-hidden rounded-full bg-muted-active",children:(0,a.jsx)("div",{className:"h-full bg-green-500 transition-all",style:{width:"".concat(w,"%")}})}),(0,a.jsx)("p",{className:"w-12 whitespace-nowrap text-right text-sm text-muted-foreground md:text-xs",children:g||"".concat(b,"/").concat(v)})]}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-1",children:[(0,a.jsx)("p",{className:"w-12 flex-shrink-0 whitespace-nowrap text-sm text-muted-foreground md:text-xs",children:"Plan"}),(0,a.jsx)("div",{className:"relative h-[7px] flex-1 overflow-hidden rounded-full bg-muted-active",children:(0,a.jsx)("div",{className:"h-full bg-brand-twilight-primary transition-all",style:{width:"".concat(t,"%")}})}),(0,a.jsx)("p",{className:"ml-2 min-w-10 whitespace-nowrap text-right text-sm text-muted-foreground md:text-xs",children:s})]})]})}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between gap-2",children:[(0,a.jsx)("p",{className:(0,i.cn)("max-w-[35ch] text-wrap text-sm text-muted-foreground md:text-xs",{}),children:r}),(0,a.jsxs)(d.u,{instant:!0,children:[(0,a.jsx)(d.aJ,{className:"hidden text-muted-foreground sm:flex",children:(0,a.jsx)(n.Z,{name:"info",className:"h-3.5 w-3.5"})}),(0,a.jsx)(d._v,{className:"max-w-[25ch]",children:o})]})]})]})};var g=s(59053),f=s(46170);let j=e=>{let{workspace:t,isOwnerOfWorkspace:s,className:n}=e,r=t.rollover_credits_limit,{billingPeriodCreditLimit:l,billingPeriodCreditsUsed:c,dailyCreditLimit:d,dailyCreditsUsed:u,bonusCredits:m,rolloverCredits:p,totalCreditsUsedInBillingPeriod:h,billingPeriodEndDate:j}=(0,g.O)({projectWorkspace:t}),v=void 0!==l&&void 0!==c&&l>0,b=void 0!==d&&void 0!==u&&d>0,y=t.plan,w="free"===y,N="ktlo"===y,_=(0,f.B9)(y),k=(0,f.fA)(y),S=_||k||"ambassador"===y||"enterprise"===y||N;return"inactive"===y?null:(0,a.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-1",n),children:[(w||N)&&b&&(0,a.jsx)(x,{dailyLimit:d,dailyUsed:u,isOwnerOfWorkspace:s,totalCreditsUsedInBillingPeriod:h||0,billingPeriodEndDate:j,rolloverCredits:p,rolloverCreditsLimit:r,type:"free"}),S&&!N&&v&&b&&(0,a.jsx)(x,{dailyLimit:d,dailyUsed:u,billingLimit:l,billingUsed:c,isOwnerOfWorkspace:s,billingPeriodEndDate:j,rolloverCredits:p,rolloverCreditsLimit:r,type:"paidWithMonthlyLimit"}),S&&!N&&!v&&b&&(0,a.jsx)(x,{dailyLimit:d,dailyUsed:u,isOwnerOfWorkspace:s,billingPeriodEndDate:j,rolloverCredits:p,rolloverCreditsLimit:r,type:"paidWithoutMonthlyLimit"}),void 0!==m&&m>0&&(0,a.jsx)(o,{bonusCredits:m})]})}},47483:function(e,t,s){s.d(t,{r:function(){return m}});var a=s(57437),n=s(38706),r=s(88391),i=s(57346),l=s(60616),o=s(55721),c=s(46214),d=s(49284),u=s(3813);let m=()=>{let e=(0,n.T_)("EarnFreeCredits"),t=(0,u.SK)(),s=(0,r.z)(l.A);return t?(0,a.jsxs)(o.Xi,{onClick:()=>{c.ZP.capture(d.PU.OPENED_DIALOG,{button_used:"menu_item"}),s({childProps:{onSuccess:()=>s(!1)}})},children:[(0,a.jsx)(i.Z,{name:"featured_seasonal_and_gifts",size:"small"}),(0,a.jsx)("span",{children:e("getFreeCredits")})]}):null}},32800:function(e,t,s){s.d(t,{s:function(){return p}});var a=s(57437),n=s(2265),r=s(44481),i=s(14438),l=s(62869),o=s(55721),c=s(57346),d=s(54616),u=s(30811);let m=e=>{var t,s;let{selectedRole:r,onRoleChange:i,roleOptions:d,disabled:u=!1}=e,[m,p]=(0,n.useState)(!1);return u?(0,a.jsx)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null===(s=d.find(e=>e.value===r))||void 0===s?void 0:s.label}):(0,a.jsxs)(o.h_,{open:m,onOpenChange:p,children:[(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null===(t=d.find(e=>e.value===r))||void 0===t?void 0:t.label,(0,a.jsx)(c.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,a.jsx)(o.AW,{children:(0,a.jsx)(o._x,{value:r,onValueChange:e=>{i(e),p(!1)},children:d.map(e=>(0,a.jsx)(o.qB,{value:e.value,className:"hover:bg-accent",children:e.label},e.value))})})]})},p=e=>{let{onInvite:t,isInviting:s,roleOptions:o,defaultRole:c,canSelectRoles:p=!0,placeholder:h="Add emails",completelyDisabled:x=!1,onInputChange:g}=e,[f,j]=(0,n.useState)([]),[v,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(c),N=f.length>0||""!==v.trim(),_=async()=>{let e=[...f],s=v.trim();if(""===s||f.includes(s)||(e.push(s),j(e),b("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.Jh)(e))){1===e.length?i.Am.error("Invalid email address",{description:"Please check the email address and try again."}):i.Am.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."});return}let{success:a}=await t({emails:e,role:y});a&&(j([]),b(""),null==g||g(""))};(0,r.y1)("mod+enter",e=>{e.preventDefault(),s||_()},{enableOnFormTags:!0});let k=""===v.trim()&&0===f.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.B,{tags:f,setTags:j,inputValue:v,setInputValue:e=>{b(e),null==g||g(e)},placeholder:h,disabled:x,className:"min-w-0 flex-1"}),N&&(0,a.jsx)(m,{selectedRole:y,onRoleChange:w,roleOptions:o,disabled:!p||x}),(0,a.jsx)(l.z,{onClick:_,variant:"affirmative",className:"flex-shrink-0",disabled:s||k||x,loading:s,children:"Invite"})]})}},39484:function(e,t,s){s.d(t,{T:function(){return i}});var a=s(57437),n=s(94508),r=s(22287);let i=e=>{let{text:t,className:s}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("mt-1 flex items-center gap-2 text-sm opacity-70",s),children:[(0,a.jsx)("div",{className:"my-1",children:(0,a.jsx)(r.$,{size:"small"})}),(0,a.jsx)("div",{children:t})]})}},45659:function(e,t,s){s.d(t,{Q:function(){return l}});var a=s(57437),n=s(70335),r=s(35974),i=s(94508);let l=e=>{let{id:t,username:s,displayName:l,photoURL:o,avatarClassName:c,actionComponent:d,email:u,isCurrentUser:m=!1,isInvited:p=!1,showBadge:h=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(n.Y,{className:(0,i.cn)(c,p&&"opacity-60"),user:{id:t,username:null!=l?l:u},photoURL:o,isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(p&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[l," ",m&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:u})]})}),p&&h&&(0,a.jsx)(r.C,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),d&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:d})]})}},12285:function(e,t,s){s.d(t,{O:function(){return S}});var a=s(57437),n=s(2265),r=s(34319),i=s(6812),l=s(77113),o=s(71759),c=s(62869),d=s(26110),u=s(53647),m=s(29827),p=s(21770),h=s(14438),x=s(52558),g=s(64040),f=s(49131),j=s(21288),v=s(97318);let b=e=>{let{onSettled:t}=e,{authUser:s}=(0,x.Eu)(),a=(0,m.NL)(),{mutate:n,isPending:r}=(0,p.D)({mutationFn:async e=>{let{projectId:t,workspaceId:a}=e;if(!s)throw Error("User must be logged in to move projects");let n=(0,f.SJ)();await n.put("/projects/".concat(t,"/move-to-workspace"),{workspace_id:a})},onSuccess:async(e,t)=>{a.invalidateQueries({queryKey:v.iZ.detail(t.projectId)}).catch(e=>{j.logging.error("Failed to invalidate project query after transfer",{error:e})}),h.Am.success("Project moved successfully",{description:"Moved project to ".concat(t.workspaceName||"new workspace")})},onError:e=>{(0,g.Eo)(e)},onSettled:()=>{null==t||t()}});return{moveProjectToWorkspace:n,isMovingProject:r}};var y=s(94508),w=s(46170),N=s(69084),_=s(65613),k=s(57346);function S(e){let{trigger:t,projectId:s,projectName:m,open:p,setOpen:h,isRootDialog:x=!1}=e,g=(0,i.Q)(e=>e.workspaces),{moveProjectToWorkspace:f,isMovingProject:j}=b({onSettled:()=>{E(!1),I("")}}),v=(0,o.hO)(e=>e.projectWorkspace),[S,C]=(0,n.useState)(!1),E=h||C,z=async e=>{s&&f({projectId:s,workspaceId:e.id,workspaceName:e.name})},[A,I]=(0,n.useState)(""),D=(0,i.Q)(e=>e.setShowCreateWorkspaceDialog),O=g.find(e=>e.id===A),P=(0,l.iZ)(e=>e.project);if(!v)return null;let T=(0,w.B9)(null==O?void 0:O.plan)?"private":(null==O?void 0:O.plan)==="free"?"public":null;return(0,a.jsxs)(d.Vq,{open:h?p:S,onOpenChange:E,children:[!x&&(0,a.jsx)(d.hg,{asChild:!0,children:t||(0,a.jsx)(c.z,{variant:"default",children:"Transfer"})}),(0,a.jsxs)(d.cZ,{size:"sm",children:[(0,a.jsxs)(d.fK,{children:[(0,a.jsxs)(d.$N,{className:"text-left",children:["Transfer ",m||"Project"]}),(0,a.jsxs)(d.Be,{className:"text-left",children:[(0,a.jsx)("p",{children:O?(0,a.jsxs)("span",{children:["Moving this project to"," ",(0,a.jsx)("span",{className:"font-medium",children:O.name})," ","will:"]}):(0,a.jsx)("span",{children:"Moving this project to a new workspace will:"})}),(0,a.jsxs)("ul",{className:"list-disc pl-4 text-sm",children:[(0,a.jsxs)("li",{children:["Remove access for members of"," ",(0,a.jsx)("span",{className:"font-medium",children:v.name})]}),(0,a.jsxs)("li",{children:["Grant access to members of"," ",O?(0,a.jsx)("span",{className:"font-medium",children:null==O?void 0:O.name}):(0,a.jsx)("span",{children:"the new workspace"})]}),(0,a.jsx)("li",{children:"Preserve access for anyone directly invited to the project"}),(0,a.jsx)("li",{children:"May require you to re-link GitHub and Supabase organizations/projects"})]}),(0,a.jsxs)(_.bZ,{className:(0,y.cn)((!T||T===(null==P?void 0:P.visibility))&&"hidden","text-sm","mt-4"),children:[(0,a.jsx)(k.Z,{name:"info",className:"h-4 w-4"}),(0,a.jsx)(_.Cd,{children:"Warning"}),(0,a.jsxs)(_.X,{className:"text-sm",children:["This action will turn the project"," ",(0,a.jsx)("span",{className:"font-medium",children:"private"===T?"private":"public"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"From"}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-md border px-2 py-1.5 opacity-70",children:[(0,a.jsx)(N.z,{workspace:v,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{className:"text-sm",children:null==v?void 0:v.name}),(0,a.jsx)(r.v,{plan:null==v?void 0:v.plan})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"To"}),(0,a.jsxs)(u.Ph,{value:A,onValueChange:I,children:[(0,a.jsx)(u.i4,{className:"px-2 py-1.5",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(u.ki,{placeholder:"Select a workspace",className:"mr-auto"})})}),(0,a.jsxs)(u.Bw,{children:[g.map(e=>{var t,s,n,i;return(0,a.jsx)(u.Ql,{value:e.id,disabled:e.id===v.id||(null===(t=e.membership)||void 0===t?void 0:t.role)!=="owner"&&(null===(s=e.membership)||void 0===s?void 0:s.role)!=="admin",className:"focus:bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.z,{workspace:e,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{children:e.name}),e.plan&&(0,a.jsx)(r.v,{plan:e.plan}),(null===(n=e.membership)||void 0===n?void 0:n.role)!=="owner"&&(null===(i=e.membership)||void 0===i?void 0:i.role)!=="admin"&&(0,a.jsx)("span",{className:"text-sm text-destructive-foreground",children:"(Not admin)"})]})},e.id)}),(0,a.jsxs)("button",{className:"flex w-full items-center gap-2 rounded-sm px-2 py-1.5 text-sm hover:bg-accent",onClick:()=>{D(!0)},children:[(0,a.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,a.jsx)(k.Z,{name:"add",size:"small"})}),"Create new"]})]})]})]})]}),(0,a.jsxs)(d.cN,{className:"gap-2",children:[(0,a.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(c.z,{disabled:!O,variant:"affirmative",size:"sm",onClick:()=>{O&&z(O)},loading:j,children:j?"Transferring...":"Confirm transfer"})]})]})]})}},61011:function(e,t,s){var a=s(57437),n=s(2265),r=s(62869),i=s(26110);t.Z=e=>{let{title:t="Remove",targetName:s,descriptionTemplate:l="Are you sure you want to remove {name}? They will no longer have access.",confirmButtonText:o="Remove",cancelButtonText:c="Cancel",onConfirm:d,onCancel:u}=e,[m,p]=(0,n.useState)(!1),h=async()=>{p(!0);try{await d()}finally{p(!1)}},x=l.replace("{name}",s);return(0,a.jsxs)(i.cZ,{size:"sm",children:[(0,a.jsxs)(i.fK,{children:[(0,a.jsx)(i.$N,{children:t}),(0,a.jsx)(i.Be,{children:x})]}),(0,a.jsxs)(i.cN,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(r.z,{variant:"outline",onClick:u,disabled:m,children:c}),(0,a.jsx)(r.z,{variant:"destructive",onClick:h,disabled:m,loading:m,children:m?"Removing...":o})]})]})}},27058:function(e,t,s){s.d(t,{H:function(){return i}});var a=s(57437),n=s(35974),r=s(94508);let i=e=>{let{status:t}=e;return(0,a.jsxs)(n.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,r.cn)("h-1.5 w-1.5 rounded-full","connected"===t?"bg-success-primary":"bg-warning-primary")}),"connected"===t?"Connected":"Not connected"]})}},93459:function(e,t,s){s.d(t,{_:function(){return c}});var a=s(2265),n=s(14438),r=s(78079),i=s(10867),l=s(64040),o=s(72384);let c=(e,t)=>{let{mutateAsync:s,isPending:c}=(0,r.mo)({projectId:e,onSuccess:()=>{n.Am.success("Supabase connected",{description:"Follow the instructions in the chat to complete the integration."}),null==t||t()}});return{handleProjectSelect:(0,a.useCallback)(async t=>{if(t)try{await s({body:{id:(0,i.Fd)(),message:"Please connect my supabase project `".concat(t.name,"`"),mode:o.S.INSTANT,contains_error:!1,integrate_supabase_project_id:t.id,integrate_supabase_org_id:t.organization_id},projectId:e},{})}catch(e){(0,l.Eo)(e)}},[s,e]),isConnecting:c}}},38343:function(e,t,s){s.d(t,{c:function(){return C},n:function(){return I}});var a=s(57437),n=s(7237),r=s(56873),i=s(82176),l=s(74751),o=s(32165),c=s(2265),d=s(55721),u=s(78276),m=s(57346),p=s(56922),h=s(22876);let x=e=>{let{onProjectSelect:t,triggerComponent:s,supabaseOrganizations:n,handleConnect:r,isConnectLoading:i,isWorkspaceAdmin:l,align:o="start"}=e,[x,g]=(0,c.useState)(!1);return(0,a.jsx)(p.D,{setSelectedProject:t,setOpen:g,children:(0,a.jsxs)(d.h_,{open:x,onOpenChange:g,children:[s,(0,a.jsxs)(d.AW,{className:"w-48",align:o,children:[(0,a.jsx)(d.Ju,{className:"text-xs font-medium text-muted-foreground",children:"Supabase organizations"}),n.map(e=>(0,a.jsx)(h.K,{organization:e},e.id)),(0,a.jsx)(d.VD,{}),(0,a.jsx)(u.b,{showTooltip:!l,tooltipContent:"You are not an admin of this workspace",children:(0,a.jsxs)(d.Xi,{onClick:r,className:"text-sm",disabled:i||!l,children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),"Add organization"]})})]})]})})};var g=s(27559),f=s(35974),j=s(62869),v=s(53647),b=s(27132),y=s(65666),w=s(10531),N=s(22853),_=s(94508),k=s(37675),S=s(93459);let C=e=>{let{supabaseOrganizations:t,connectedSupabaseProject:s,setShowConnectDialog:n,isWorkspaceAdmin:r}=e,l=(0,y.D)(),c=(0,k.bk)(e=>e.isSendChatMessageMutationPending),{handleProjectSelect:d,isConnecting:u}=(0,S._)(l),m=null==s?void 0:s.status,p=null!==s&&!t.some(e=>e.id===(null==s?void 0:s.organization_id)),h=(0,i.dl)(w.P.SupabaseOnCreation);return(0,a.jsx)(o.P,{label:"Project",description:"Choose the Supabase project to sync with.",justify:"end",customBadge:(0,a.jsx)(I,{status:m||"not-connected"}),children:h?(0,a.jsx)(E,{connectedProjectIsInUnconnectedOrganization:p,supabaseOrganizations:t,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:r,setShowConnectDialog:n,handleProjectSelect:d,connectedSupabaseProject:s}):(0,a.jsx)(z,{connectedProjectIsInUnconnectedOrganization:p,supabaseOrganizations:t,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:r,setShowConnectDialog:n,handleProjectSelect:d,connectedSupabaseProject:s})})},E=e=>{let{connectedProjectIsInUnconnectedOrganization:t,supabaseOrganizations:s,isConnecting:r,isSendChatMessageMutationPending:i,isWorkspaceAdmin:l,setShowConnectDialog:o,handleProjectSelect:c,connectedSupabaseProject:d}=e;return(0,a.jsx)(x,{align:"end",onProjectSelect:e=>{e&&c(e)},triggerComponent:(0,a.jsx)(u.b,{showTooltip:!d&&i,tooltipContent:"Edits ongoing...",children:(0,a.jsx)(n.$F,{asChild:!0,children:(0,a.jsx)(j.z,{disabled:!!d||r||i,size:"sm",variant:"outline",loading:r,children:d?d.name:t?"Project not found":"Connect a project"})})}),supabaseOrganizations:s,handleConnect:()=>o(!0),isConnectLoading:r,isWorkspaceAdmin:l})},z=e=>{let{connectedSupabaseProject:t,connectedProjectIsInUnconnectedOrganization:s,supabaseOrganizations:n,isConnecting:i,isSendChatMessageMutationPending:o,isWorkspaceAdmin:c,setShowConnectDialog:d,handleProjectSelect:p}=e,h=(0,b.Z)("md");return(0,a.jsxs)(v.Ph,{value:s?void 0:(null==t?void 0:t.id)||void 0,onValueChange:e=>{let t=n.flatMap(e=>e.projects).find(t=>t.id===e);t&&p(t)},disabled:i||o||s,children:[(0,a.jsx)(u.b,{showTooltip:i||o,tooltipContent:i?"Connecting to Supabase...":"Edits ongoing...",children:(0,a.jsx)(v.i4,{className:"group relative h-7 w-auto gap-2 bg-muted px-3 py-2 font-medium text-foreground data-[placeholder]:text-foreground","data-state":t&&!(0,g.u)(t)?"checked":"",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{name:"progress_activity",className:"animate-spin",size:"small"}),(0,a.jsx)("span",{children:"Connecting..."})]}):(0,a.jsx)(v.ki,{placeholder:s?"Project not found":"Connect a project"})})}),(0,a.jsxs)(v.Bw,{align:h?"start":"end",children:[n.map(e=>{let t=[...e.projects].sort((e,t)=>(0,g.u)(e)&&!(0,g.u)(t)?-1:(0,g.u)(t)&&!(0,g.u)(e)?1:0);return(0,a.jsxs)(v.DI,{className:"w-full",children:[(0,a.jsx)(v.n5,{className:"text-xs text-muted-foreground",children:e.name}),t.map(e=>{let t=(0,g.u)(e);return(0,a.jsx)(u.b,{showTooltip:!t,tooltipContent:"Check project status in Supabase.",side:"left",instant:!0,children:(0,a.jsxs)(v.Ql,{value:e.id,disabled:!t,className:"group flex w-full items-center",children:[(0,a.jsx)("span",{className:"group-data-[state=checked]:mr-3",children:e.name}),!t&&(0,a.jsx)(m.Z,{name:"warning_fill",className:"pointer-events-auto absolute right-2 top-1/2 h-4 w-4 -translate-y-1/2 text-destructive-primary group-data-[state=checked]:right-7"})]})},e.id)}),(0,a.jsx)(j.z,{variant:"ghost",className:"flex w-full items-center justify-between gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",asChild:!0,children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",rel:"noreferrer",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Create project"})]}),(0,a.jsx)(m.Z,{name:"arrow_outward",size:"small"})]})}),(0,a.jsx)(r.Z0,{className:"my-1"})]},e.id)}),(0,a.jsx)(u.b,{showTooltip:!c,tooltipContent:"You need to be an admin to add an organization.",side:"left",instant:!0,children:(0,a.jsxs)(j.z,{variant:"ghost",className:"flex w-full items-center justify-start gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",onClick:()=>d(!0),disabled:!c,children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Add organization"}),!c&&(0,a.jsx)(l.p,{badge:"admin",className:"flex md:hidden"})]})})]})]},(null==t?void 0:t.id)||"disconnected")},A={[N.k.ACTIVE_HEALTHY]:{label:"Connected",className:"bg-success-primary"},[N.k.ACTIVE_UNHEALTHY]:{label:"Issues detected",className:"bg-warning-primary"},[N.k.COMING_UP]:{label:"Starting up",className:"bg-affirmative-primary"},[N.k.GOING_DOWN]:{label:"Shutting down",className:"bg-destructive-primary"},[N.k.INACTIVE]:{label:"Inactive",className:"bg-destructive-primary"},[N.k.INIT_FAILED]:{label:"Setup failed",className:"bg-destructive-primary"},[N.k.REMOVED]:{label:"Removed",className:"bg-destructive-primary"},[N.k.RESTARTING]:{label:"Restarting",className:"bg-warning-primary"},[N.k.UNKNOWN]:{label:"Unknown",className:"bg-destructive-primary"},[N.k.UPGRADING]:{label:"Upgrading",className:"bg-warning-primary"},[N.k.PAUSING]:{label:"Pausing",className:"bg-warning-primary"},[N.k.RESTORING]:{label:"Restoring",className:"bg-warning-primary"},[N.k.RESTORE_FAILED]:{label:"Restore failed",className:"bg-destructive-primary"},[N.k.PAUSE_FAILED]:{label:"Pause failed",className:"bg-destructive-primary"},"not-connected":{label:"Not connected",className:"bg-warning-primary"}},I=e=>{let{status:t}=e,s=A[t];return(0,a.jsxs)(f.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,_.cn)("h-1.5 w-1.5 rounded-full",s.className)}),s.label]})}},75403:function(e,t,s){s.d(t,{Z:function(){return a}});function a(e,t){if(e.isLoading||!t||!e.supabaseOrganizations)return!1;if(e.noOrganizations)return!0;let s=e.supabaseOrganizations.find(e=>e.id===t.supabase_organization_id);return!s||"failed"===s.status}},90360:function(e,t,s){s.d(t,{default:function(){return r7}});var a,n,r,i,l=s(57437),o=s(2265),c=s(44481),d=s(52558),u=s(61922),m=s(82176),p=s(66870),h=s(95565),x=s(92850),g=s(49131);let f=e=>{let{projectId:t,start:s,end:a,enabled:n=!0}=e;return(0,x.a)({queryKey:["projects",t,"integrations","ai_gateway","usage",{start:s,end:a}],queryFn:async()=>{let e=(0,g.SJ)(),n=new URLSearchParams;s&&n.append("start",s),a&&n.append("end",a);let r=n.toString(),i="/projects/".concat(t,"/integrations/ai_gateway/usage").concat(r?"?".concat(r):"");return e.get(i)},enabled:n&&!!t})};var j=s(62869),v=s(55721),b=s(57346),y=s(27132);let w=()=>{let e=new Date,t=[];return t.push({label:"Last 24 hours",value:"24h",start:new Date(e.getTime()-864e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 7 days",value:"7d",start:new Date(e.getTime()-6048e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 30 days",value:"30d",start:new Date(e.getTime()-2592e6).toISOString(),end:e.toISOString()}),t},N=e=>{let{selectedPeriod:t,onPeriodChange:s}=e,a=(0,y.Z)("md"),n=w();return(0,l.jsxs)(v.h_,{children:[(0,l.jsx)(v.$F,{asChild:!0,children:(0,l.jsxs)(j.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:a?"sm":"default",children:[t.label,(0,l.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,l.jsx)(v.AW,{align:"end",className:"min-w-32",children:n.map(e=>(0,l.jsx)(v.Xi,{onClick:()=>s(e),children:e.label},e.value))})]})};var _=s(60936),k=s(72470),S=s(84927),C=s(56942),E=s(53306),z=s(94773),A=s(54886),I=s(66491),D=s(47625),O=s(77031),P=s(56940),T=s(97059),L=s(62994),R=s(22190),F=s(83046),Z=s(22287),M=s(8147),U=s(94508);let q={light:"",dark:".dark"},W=o.createContext(null);function K(e){let{id:t,className:s,children:a,config:n,...r}=e,i=o.useId(),c="chart-".concat(t||i.replace(/:/g,""));return(0,l.jsx)(W.Provider,{value:{config:n},children:(0,l.jsxs)("div",{"data-slot":"chart","data-chart":c,className:(0,U.cn)("[&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-surface]:outline-hidden flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent",s),...r,children:[(0,l.jsx)(J,{id:c,config:n}),(0,l.jsx)(D.h,{children:a})]})})}let J=e=>{let{id:t,config:s}=e,a=Object.entries(s).filter(e=>{let[,t]=e;return t.theme||t.color});return a.length?(0,l.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(q).map(e=>{let[s,n]=e;return"\n".concat(n," [data-chart=").concat(t,"] {\n").concat(a.map(e=>{var t;let[a,n]=e,r=(null===(t=n.theme)||void 0===t?void 0:t[s])||n.color;return r?"  --color-".concat(a,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},G=M.u;function V(e){let{active:t,payload:s,className:a,indicator:n="dot",hideLabel:r=!1,hideIndicator:i=!1,label:c,labelFormatter:d,labelClassName:u,formatter:m,color:p,nameKey:h,labelKey:x}=e,{config:g}=function(){let e=o.useContext(W);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),f=o.useMemo(()=>{var e;if(r||!(null==s?void 0:s.length))return null;let[t]=s,a="".concat(x||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),n=B(g,t,a),i=x||"string"!=typeof c?null==n?void 0:n.label:(null===(e=g[c])||void 0===e?void 0:e.label)||c;return d?(0,l.jsx)("div",{className:(0,U.cn)("font-medium",u),children:d(i,s)}):i?(0,l.jsx)("div",{className:(0,U.cn)("font-medium",u),children:i}):null},[c,d,s,r,u,g,x]);if(!t||!(null==s?void 0:s.length))return null;let j=1===s.length&&"dot"!==n;return(0,l.jsxs)("div",{className:(0,U.cn)("grid min-w-32 items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[j?null:f,(0,l.jsx)("div",{className:"grid gap-1.5",children:s.map((e,t)=>{let s="".concat(h||e.name||e.dataKey||"value"),a=B(g,e,s),r=p||e.payload.fill||e.color;return(0,l.jsx)("div",{className:(0,U.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:m&&(null==e?void 0:e.value)!==void 0&&e.name?m(e.value,e.name,e,t,e.payload):(0,l.jsxs)(l.Fragment,{children:[(null==a?void 0:a.icon)?(0,l.jsx)(a.icon,{}):!i&&(0,l.jsx)("div",{className:(0,U.cn)("border-(--color-border) bg-(--color-bg) shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":j&&"dashed"===n}),style:{"--color-bg":r,"--color-border":r}}),(0,l.jsxs)("div",{className:(0,U.cn)("flex flex-1 justify-between leading-none",j?"items-end":"items-center"),children:[(0,l.jsxs)("div",{className:"grid gap-1.5",children:[j?f:null,(0,l.jsx)("span",{className:"text-muted-foreground",children:(null==a?void 0:a.label)||e.name})]}),e.value&&(0,l.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function B(e,t,s){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,n=s;return t&&s in t&&"string"==typeof t[s]?n=t[s]:a&&s in a&&"string"==typeof a[s]&&(n=a[s]),n in e?e[n]:e[s]}R.D;let H=e=>{let t=e=>"hsl(".concat(120+137.508*e%360/360*200,", ").concat(70+e%3*10,"%, ").concat(50+e%4*5,"%)"),s={};return e.forEach((e,a)=>{s[e]={label:e,color:t(a)}}),s},Y=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,l.jsxs)("div",{className:"rounded-lg border bg-background p-3 shadow-md",children:[(0,l.jsx)("p",{className:"mb-2 font-medium text-foreground",children:a}),(0,l.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-3 w-3 rounded-sm",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:e.dataKey})]}),(0,l.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.value})]},t))})]}):null},Q=e=>{let{data:t,isLoading:s,granularity:a="day"}=e,{chartData:n,chartConfig:r}=(0,o.useMemo)(()=>{if(!t||0===t.length)return{chartData:[],chartConfig:{}};let e=new Set,s=null,n=null,r={};return(t.forEach(t=>{try{var i;let l=null===(i=t.timestamp)||void 0===i?void 0:i.trim();if(!l)return;let o=(0,_.D)(l);if(isNaN(o.getTime()))return;(!s||o<s)&&(s=o),(!n||o>n)&&(n=o);let c=("minute"===a?(0,k.F)(o):"hour"===a?(0,S.o)(o):(0,C.b)(o)).toISOString(),d=t.model||"Unknown";e.add(d),r[c]||(r[c]={}),r[c][d]=(r[c][d]||0)+(t.count||1)}catch(e){}}),s&&n)?{chartData:("minute"===a?(0,E.z)({start:(0,k.F)(s),end:(0,k.F)(n)}):"hour"===a?(0,z.e)({start:(0,S.o)(s),end:(0,S.o)(n)}):(0,A.D)({start:(0,C.b)(s),end:(0,C.b)(n)})).map(t=>{let s=t.toISOString(),n={timeKey:"minute"===a?(0,I.WU)(t,"HH:mm"):"hour"===a?(0,I.WU)(t,"MMM dd, HH:mm"):(0,I.WU)(t,"MMM dd")};return e.forEach(e=>{n[e]=0}),r[s]&&Object.entries(r[s]).forEach(e=>{let[t,s]=e;n[t]=s}),n}),chartConfig:H(Array.from(e))}:{chartData:[],chartConfig:{}}},[t,a]);if(s)return(0,l.jsx)("div",{className:"flex h-80 w-full items-center justify-center",children:(0,l.jsx)(Z.$,{})});if(0===n.length)return(0,l.jsx)("div",{className:"flex h-80 w-full items-center justify-center rounded-lg border border-dashed",children:(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"No AI Gateway usage data available for the selected period."})});let i=Object.keys(r);return(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(K,{config:r,className:"h-80 w-full",children:(0,l.jsx)(D.h,{width:"100%",height:"100%",children:(0,l.jsxs)(O.v,{data:n,width:void 0,height:void 0,margin:{top:20,right:5,left:0,bottom:20},children:[(0,l.jsx)(P.q,{strokeDasharray:"3 3"}),(0,l.jsx)(T.K,{dataKey:"timeKey",tick:!1,axisLine:!1,tickLine:!1}),(0,l.jsx)(L.B,{axisLine:!1,tickLine:!1,tick:{fontSize:12},width:30}),(0,l.jsx)(G,{content:(0,l.jsx)(Y,{})}),(0,l.jsx)(R.D,{}),i.map(e=>(0,l.jsx)(F.$,{dataKey:e,stackId:"models",fill:r[e].color,radius:[0,0,0,0]},e))]})})})})};var X=s(93022);let $=e=>{let{data:t,isLoading:s}=e,a=t.reduce((e,t)=>e+t.count,0);return(0,l.jsx)("div",{className:"rounded-lg border p-4",children:(0,l.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),s?(0,l.jsx)(X.O,{className:"h-8 w-20"}):(0,l.jsx)("p",{className:"font-bold text-3xl",children:a.toLocaleString()})]})})},ee=e=>{let{project:t}=e,[s,a]=(0,o.useState)(w()[1]),n="24h"===s.value?"minute":"day",{data:r}=(0,h.W)({projectId:t.id}),{data:i,isLoading:c}=f({projectId:t.id,start:s.start,end:s.end});return(0,l.jsx)(p.tM,{title:"AI Gateway",value:"ai_gateway",description:"Monitor your project's AI Gateway usage and performance.",docsLink:"https://docs.lovable.dev/features/ai-gateway",children:(0,l.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,l.jsx)("p",{className:"font-medium",children:"AI Gateway Status"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border border-border p-4",children:[(0,l.jsx)("div",{className:"h-3 w-3 rounded-full ".concat((null==r?void 0:r.is_used)?"bg-green-500":"bg-gray-400")}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-sm font-medium",children:["Status: ",(null==r?void 0:r.is_used)?"Active":"Not in use"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==r?void 0:r.is_used)?"Your project is using Lovable's AI Gateway for secure API communication.":"Your project is not currently using the AI Gateway. Lovable will automatically activate it when you implement a feature that uses AI."})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("p",{className:"font-medium",children:"Usage Statistics"}),(0,l.jsx)(N,{selectedPeriod:s,onPeriodChange:a})]}),(0,l.jsx)($,{data:i||[],isLoading:c})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 gap-5",children:(0,l.jsx)(Q,{data:i||[],isLoading:c,granularity:n})})]})})};var et=s(33187),es=s(14376),ea=s(5481),en=s(23263);let er={totalVisits:{title:"Visitors",valueType:"number",timeSeriesKey:"visitors",description:"Total number of visitors to your app."},totalPageviews:{title:"Pageviews",valueType:"number",timeSeriesKey:"pageviews",description:"Total number of pages viewed by all visitors."},pageviewsPerVisit:{title:"Views Per Visit",valueType:"number",timeSeriesKey:"pageviewsPerVisit",description:"How many pages the average visitor viewed."},sessionDuration:{title:"Visit Duration",valueType:"time",timeSeriesKey:"sessionDuration",description:"How long the average visit to your app lasted."},bounceRate:{title:"Bounce Rate",valueType:"percentage",timeSeriesKey:"bounceRate",description:"Percentage of visitors who left after viewing only one page."}};function ei(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60),a="";return t>0&&(a+="".concat(t,"h ")),(s>0||t>0)&&(a+="".concat(s,"m ")),(a+="".concat(Math.floor(e%60),"s")).trim()}let el=e=>e<1e3?e.toString():e<1e6?"".concat((e/1e3).toFixed(1).replace(/\.0$/,""),"k"):"".concat((e/1e6).toFixed(1).replace(/\.0$/,""),"m"),eo=e=>{let{value:t,valueType:s,roundNumber:a=!0}=e;switch(s){case"number":return a?el(t):t.toString();case"percentage":return"".concat(t,"%");case"time":return ei(t)}};var ec=s(7641),ed=s(64975),eu=s(63070);let em=e=>{if(e)try{return Intl.DateTimeFormat(void 0,{timeZone:e}),e}catch(t){console.error("Invalid timezone: ".concat(e,", falling back to local timezone"))}return Intl.DateTimeFormat().resolvedOptions().timeZone},ep=(e,t)=>(0,es.Nm)(e,t).toISOString(),eh=(e,t)=>{let s=(0,es.zW)(e,t),a=(0,C.b)(s);return(0,es.Nm)(a,t)},ex=(e,t)=>{let s=(0,es.zW)(e,t),a=(0,ec.i)(s);return(0,es.Nm)(a,t)},eg=e=>{let t=em(e),s=new Date;return{startDate:ep(new Date(s.getTime()-6048e5),t),endDate:ep(s,t),granularity:"daily",preset:"7d"}},ef={today:{label:"Today",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep(eh(s,t),t),endDate:ep(ex(s,t),t),granularity:"hourly",preset:"today"}}},yesterday:{label:"Yesterday",getTimePeriod:e=>{let t=em(e),s=(0,ed.k)(new Date,1);return{startDate:ep(eh(s,t),t),endDate:ep(ex(s,t),t),granularity:"hourly",preset:"yesterday"}}},"24h":{label:"Last 24 hours",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,ed.k)(s,1),t),endDate:ep(s,t),granularity:"hourly",preset:"24h"}}},"7d":{label:"Last 7 days",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,ed.k)(s,7),t),endDate:ep(s,t),granularity:"daily",preset:"7d"}}},"14d":{label:"Last 14 days",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,ed.k)(s,14),t),endDate:ep(s,t),granularity:"daily",preset:"14d"}}},"30d":{label:"Last 30 days",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,ed.k)(s,30),t),endDate:ep(s,t),granularity:"daily",preset:"30d"}}},"90d":{label:"Last 90 days",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,ed.k)(s,90),t),endDate:ep(s,t),granularity:"daily",preset:"90d"}}},month:{label:"This month",getTimePeriod:e=>{let t=em(e),s=new Date;return{startDate:ep((0,eu.N)(s),t),endDate:ep(s,t),granularity:"daily",preset:"month"}}}};var ej=s(53974),ev=s(81103);let eb=()=>{let[e,t]=(0,ej._)("temporary-analytics-banner",!0);return e?(0,l.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,l.jsx)("span",{className:"font-medium",children:"Note: "}),"We started tracking analytics between the 4th and 7th of July. Data before this period is not available."]}),(0,l.jsxs)(ev.u,{instant:!0,children:[(0,l.jsx)(ev.aJ,{children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>t(!1),children:(0,l.jsx)(b.Z,{name:"close",size:"small"})})}),(0,l.jsx)(ev._v,{children:(0,l.jsx)("p",{children:"Don't show this message again"})})]})]}):null},ey={value:{label:"Views"}},ew=e=>{let{data:t,valueType:s="number",granularity:a,selectedMetric:n,isLoading:r,userTimezone:i}=e,c=(0,o.useCallback)((e,t)=>{let s=(0,_.D)(e+(e.includes(" ")?"":"T00:00:00")+"Z"),a=(0,es.zW)(s,em(i));return(0,I.WU)(a,t)},[i]);return(0,l.jsxs)("div",{className:"w-full rounded-xl border bg-muted p-4",children:[(0,l.jsx)(eb,{}),r?(0,l.jsx)("div",{className:"flex h-[200px] w-full items-center justify-center md:h-[400px]",children:(0,l.jsx)(Z.$,{})}):(0,l.jsx)(K,{config:ey,className:"h-[200px] w-full max-w-full md:h-[400px]",children:(0,l.jsxs)(ea.T,{data:t,margin:{left:"time"===s?0:-15,right:10,top:20,bottom:5},children:[(0,l.jsx)("defs",{children:(0,l.jsxs)("linearGradient",{id:"fillGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,l.jsx)("stop",{offset:"5%",stopColor:"var(--chart-1)",stopOpacity:.2}),(0,l.jsx)("stop",{offset:"95%",stopColor:"var(--chart-1)",stopOpacity:.02})]})}),(0,l.jsx)(P.q,{horizontal:!0,vertical:!1,stroke:"hsl(var(--muted-border))"}),(0,l.jsx)(T.K,{dataKey:"date",tickLine:!1,tickMargin:10,interval:"equidistantPreserveStart",tickFormatter:e=>{switch(a){case"hourly":return c(e,"HH:mm");case"daily":return c(e,"d MMM")}}}),(0,l.jsx)(L.B,{dataKey:"value",tickLine:!1,axisLine:!1,tickMargin:10,tickCount:5,tickFormatter:e=>{switch(s){case"number":return el(e);case"percentage":return"".concat(e,"%");case"time":return ei(e)}}}),(0,l.jsx)(en.u,{dataKey:"value",strokeWidth:2,stroke:"var(--chart-1)",dot:!1,fill:"url(#fillGradient)",animationDuration:500,animationEasing:"ease-in-out"}),(0,l.jsx)(G,{cursor:!1,content:(0,l.jsx)(V,{formatter:e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,l.jsx)("span",{className:"mr-1 h-3 w-3 rounded-full bg-chart-1"})," ",(0,l.jsx)("span",{className:"font-medium",children:eo({value:e,valueType:s})})," ",(0,l.jsx)("span",{className:"",children:er[n].title})]}),labelFormatter:e=>{let t="";return t="hourly"===a?c(e,"d MMM, HH:mm"):c(e,"d MMM"),(0,l.jsx)("p",{className:"text-sm",children:t})}})})]})})]})},eN=/./g,e_=e=>e.toUpperCase().replace(eN,e=>String.fromCodePoint(127397+e.charCodeAt(0))),ek=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{return new Intl.DisplayNames([t],{type:"region"}).of(e.toUpperCase())||e}catch(t){return e}},eS=e=>{let{type:t,label:s}=e;switch(t){case"country":return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"origin-left scale-[1.35] transform",children:e_(s)}),(0,l.jsx)("span",{children:ek(s)})]});case"device":if("mobile-ios"===s)return"Mobile - iOS";if("mobile-android"===s)return"Mobile - Android";return s.charAt(0).toUpperCase()+s.slice(1);default:return s}},eC=e=>{switch(e){case"country":return"The top countries your visitors are from.";case"device":return"The most used devices by your visitors.";case"source":return"The most common sources of traffic to your app.";case"page":return"The most viewed pages in your app."}},eE=e=>{let{type:t,value:s,total:a}=e;if("device"===t){let e=s/a*100;return"".concat(e.toFixed(1),"%")}return el(s)},ez=e=>{let{data:t,type:s,metric:a,color:n,isLoading:r}=e,i=Math.max(...t.map(e=>e.value)),o=t.sort((e,t)=>t.value-e.value),c=t.reduce((e,t)=>e+t.value,0);return(0,l.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl border border-border bg-muted p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm font-medium",children:[(0,l.jsxs)(ev.u,{instant:!0,children:[(0,l.jsx)(ev.aJ,{children:(0,l.jsx)("p",{className:"capitalize",children:s})}),(0,l.jsx)(ev._v,{children:eC(s)})]}),(0,l.jsx)("p",{children:a})]}),!r&&o.length>0&&o.map(e=>{let t=e.value/i*100,r=eS({type:s,label:e.label}),o=eE({type:s,value:e.value,total:c});return"Unknown"===e.label?null:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,l.jsxs)("div",{className:"relative flex-1 px-2 py-1",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-md bg-accent",style:{width:"".concat(t,"%"),minWidth:"10px",backgroundColor:n}}),(0,l.jsx)("p",{className:"relative z-10 flex items-center gap-3 break-all",children:r})]}),(0,l.jsxs)(ev.u,{delayDuration:0,children:[(0,l.jsx)(ev.aJ,{children:(0,l.jsx)("p",{children:o})}),(0,l.jsx)(ev._v,{children:(0,l.jsxs)("p",{children:[e.value," ",a]})})]})]},e.label)}),!r&&0===o.length&&(0,l.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"No data found for this time period."}),r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsx)(X.O,{className:"h-6 flex-1"}),(0,l.jsx)(X.O,{className:"h-6 w-8"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsx)(X.O,{className:"h-6 w-1/2"}),(0,l.jsx)(X.O,{className:"h-6 w-8"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsx)(X.O,{className:"h-6 w-1/4"}),(0,l.jsx)(X.O,{className:"h-6 w-8"})]})]})]})},eA=e=>{let{title:t,value:s,valueType:a="number",changePercentage:n,onClick:r,isSelected:i,isLoading:o,description:c}=e,d=n&&n>0,u=n&&0===n;return(0,l.jsxs)(ev.u,{delayDuration:0,children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsxs)("div",{className:(0,U.cn)("group flex cursor-pointer flex-col gap-2 rounded-xl border bg-muted p-4",i&&"border-accent-primary/50"),onClick:r,children:[(0,l.jsx)("p",{className:(0,U.cn)("text-sm font-medium group-hover:text-accent-primary",i&&"text-accent-primary"),children:t}),(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("p",{className:"h-5 font-medium",children:o?(0,l.jsx)(X.O,{className:"h-full w-8"}):eo({value:s,valueType:a})}),n&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:(0,U.cn)("flex items-center gap-1",d?"text-success-primary":u?"text-warning-primary":"text-destructive-primary"),children:[(0,l.jsx)(b.Z,{name:d?"trending_up":u?"trending_flat":"trending_down",size:"small"}),(0,l.jsxs)("p",{className:"text-sm",children:[n,"%"]})]})})]})]})}),(0,l.jsxs)(ev._v,{className:"max-w-[35ch]",children:[(0,l.jsxs)("p",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:eo({value:s,valueType:a,roundNumber:!1})})," ",(0,l.jsx)("span",{className:"",children:t.toLowerCase()})]}),c&&(0,l.jsx)("p",{className:"text-xs opacity-80",children:c})]})]})};var eI=s(87488);let eD=e=>{let{projectId:t}=e,{data:s,dataUpdatedAt:a,isLoading:n}=(0,x.a)(et.W.analyticsTrend({projectId:t})),r=(null==s?void 0:s.currentVisitors)&&s.currentVisitors>0,i=r?s.currentVisitors:0;return n?(0,l.jsx)(X.O,{className:"h-full w-8"}):(0,l.jsxs)(ev.u,{instant:!0,children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsxs)("div",{className:"hidden cursor-pointer items-center gap-1 text-foreground md:flex",children:[(0,l.jsx)("div",{className:(0,U.cn)("mr-1 size-2 shrink-0 rounded-full",r?"animate-pulse bg-success-primary":"bg-muted-foreground")}),(0,l.jsx)("p",{className:"text-sm",children:i}),(0,l.jsxs)("p",{className:"whitespace-nowrap text-sm",children:["current ",1===i?"visitor":"visitors"]})]})}),(0,l.jsx)(ev._v,{children:(0,l.jsx)(eO,{timestamp:a})})]})},eO=e=>{let{timestamp:t}=e,[s,a]=(0,o.useState)(new Date);return(0,o.useEffect)(()=>{let e=setInterval(()=>{a(new Date)},1e3);return()=>clearInterval(e)},[]),(0,l.jsxs)("p",{children:["Last updated ",(0,eI.c)(s,new Date(t))," seconds ago"]})},eP=e=>{let{selectedTimePeriod:t,setSelectedTimePeriod:s,userTimezone:a}=e,n=(0,y.Z)("md"),r=(0,o.useMemo)(()=>Object.entries(ef).map(e=>{let[t,s]=e,n=s.getTimePeriod(a);return{key:t,label:s.label,timePeriod:n}}),[a]),i=ef[t.preset].label;return(0,l.jsxs)(v.h_,{children:[(0,l.jsx)(v.$F,{asChild:!0,children:(0,l.jsxs)(j.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:n?"sm":"default",children:[i,(0,l.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,l.jsx)(v.AW,{align:"end",className:"min-w-32",children:r.map(e=>(0,l.jsx)(v.Xi,{onClick:()=>s(e.timePeriod),children:e.label},e.key))})]})},eT=e=>{var t,s,a,n,r;let{project:i}=e,[c,d]=(0,o.useState)("totalVisits"),[u,m]=(0,o.useState)(eg),{data:h,isLoading:g}=(0,x.a)(et.W.analytics({projectId:i.id,timePeriod:u}));return i.url?(0,l.jsxs)(p.tM,{title:"Analytics",value:"analytics",description:(0,l.jsxs)("p",{children:["Measure how your"," ",(0,l.jsx)("a",{href:null!==(t=i.url)&&void 0!==t?t:"".concat(i.name,".lovable.app"),target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",children:"published project"})," ","is performing."]}),descriptionAction:(0,l.jsxs)("div",{className:"flex items-center gap-5 md:-mt-1.5",children:[(0,l.jsx)(eD,{projectId:i.id}),(0,l.jsx)(eP,{selectedTimePeriod:u,setSelectedTimePeriod:m})]}),children:[(0,l.jsx)("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-5",children:Object.entries(er).map(e=>{var t,s;let[a,n]=e,{title:r,valueType:i,timeSeriesKey:o,description:u}=n,m=null!==(s=null==h?void 0:null===(t=h.timeSeries[o])||void 0===t?void 0:t.total)&&void 0!==s?s:0;return(0,l.jsx)(eA,{title:r,value:m,onClick:()=>d(a),isSelected:c===a,isLoading:g,valueType:i,description:u},a)})}),(0,l.jsx)(ew,{data:(()=>{if(!h)return[];switch(c){case"totalVisits":default:return h.timeSeries.visitors.data;case"totalPageviews":return h.timeSeries.pageviews.data;case"pageviewsPerVisit":return h.timeSeries.pageviewsPerVisit.data;case"sessionDuration":return h.timeSeries.sessionDuration.data;case"bounceRate":return h.timeSeries.bounceRate.data}})(),valueType:er[c].valueType,granularity:u.granularity,selectedMetric:c,isLoading:g}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,l.jsx)(ez,{data:null!==(s=null==h?void 0:h.lists.source.data)&&void 0!==s?s:[],type:"source",metric:"Visitors",isLoading:g}),(0,l.jsx)(ez,{data:null!==(a=null==h?void 0:h.lists.page.data)&&void 0!==a?a:[],type:"page",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:g}),(0,l.jsx)(ez,{data:null!==(n=null==h?void 0:h.lists.country.data)&&void 0!==n?n:[],type:"country",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:g}),(0,l.jsx)(ez,{data:null!==(r=null==h?void 0:h.lists.device.data)&&void 0!==r?r:[],type:"device",metric:"Visitors",isLoading:g})]})]}):(0,l.jsx)(p.tM,{title:"Analytics",value:"analytics",description:"Measure how your published project is performing.",children:(0,l.jsx)("div",{className:"flex w-full justify-center",children:(0,l.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"To view analytics, you first need to publish your project."})})})};var eL=s(22048),eR=s(58912),eF=s.n(eR),eZ=s(27648),eM=s(46214),eU=s(14438),eq=s(76678),eW=s(60256),eK=s(93261),eJ=s(88391),eG=s(32165);let eV=e=>{let t="development"===e?"185.158.133.10":"185.158.133.1";return{domain:[{type:"A",host:"@",value:t,ttl:300},{type:"A",host:"www",value:t,ttl:300}],subDomain:[{type:"A",host:"{SUBDOMAIN}",value:t,ttl:300}]}};var eB=s(21288),eH=s(10531),eY=s(10441),eQ=s(74225),eX=s(5460),e$=s(71759),e0=e=>{let{project:t}=e,{userData:s}=(0,eW.SE)(),{data:a,refetch:n}=(0,x.a)(eY.c.domains({projectId:t.id})),r=(0,e$.hO)(e=>e.projectWorkspace),[i,c]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{let e=(0,g.SJ)();c(await e.get("/entri/token"))})(),eF().load()},[]);let d=(0,eJ.z)(eq.g),u=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("free"===(null==r?void 0:r.plan)){d({childProps:{dialogDescription:"You need to be on a pro plan to connect a domain."}});return}if(!(null==t?void 0:t.url)){(0,g.SJ)().post("/projects/".concat(null==t?void 0:t.id,"/deployments"),{}).catch(e=>{eB.logging.error("Error publishing project",e),eU.Am.error("Error when publishing your project",{description:e.message}),eL.Tb(e)});try{await (0,eX.G)({projectId:null==t?void 0:t.id})}catch(e){eB.logging.error("Error updating last deployment ID",e),eU.Am.error("Error when updating deployment cache. Please report this.",{description:e.message}),eL.Tb(e)}}if(null===i)return;let a={...i,dnsRecords:eV("production"),userId:null==t?void 0:t.id,monitor:!0,sellVersion:"v3",whiteLabel:{customCopy:{initialScreen:{title:{en:"Use your domain with Lovable"}}},theme:{primary:"#000000",secondary:"#000000",onSecondary:"#FFFFFF",headerBackground:"#000000"},logo:"https://lovable.dev/apple-icon.png",sell:{partnerName:"Lovable",partnerLogo:"https://lovable.dev/img/lovable-logo-text-nav.png",partnerUrl:"https://lovable.dev",overlayScreenHeight:"75%",flowTarget:"_blank"}}};try{"buy"===e?(a.prefilledDomain=(null==t?void 0:t.name)+".com",eF().purchaseDomain(a)):eF().showEntri(a)}catch(t){if(!s){let t=(0,g.SJ)();c(await t.get("/entri/token")),u(e,!0)}}eM.ZP.capture("domain_connecting_attempt",{mode:e})},p=async e=>{if(e.detail.success){let s=eU.Am.success("Connecting domain...",{description:"Hold on while we were mapping ".concat(e.detail.domain," to your project.")});try{let s=(0,g.SJ)();await s.post("/projects/".concat(null==t?void 0:t.id,"/domains"),{domain:e.detail.domain}),n(),eU.Am.success("Domain connected!",{description:"The domain ".concat(e.detail.domain," is now mapped to your project. It might take a few minutes to propagate.")}),eM.ZP.capture("domain_connected",{mode:"purchase"===e.detail.setupType?"buy":"connect"})}catch(e){eU.Am.info("Domain not connected",{description:"There was an error while connecting your domain. Please try again."}),eL.Tb(e)}eU.Am.dismiss(s)}};(0,o.useEffect)(()=>(window.addEventListener("onEntriClose",p,!1),()=>{window.removeEventListener("onEntriClose",p)}),[]);let h=(0,m.dl)(eH.P.CustomDomainsBuy)||!1;return(0,l.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,l.jsx)(eG.P,{label:"Connected Domains",description:"View or remove domains linked to your project.",justify:"end",children:(0,l.jsxs)("ul",{className:"flex flex-col gap-2",children:[(null==t?void 0:t.url)?(0,l.jsx)(eK.Z,{showRemove:!1,showIcon:!0,domain:{domain:(0,eQ.P)(null==t?void 0:t.url),status:"active"}}):(0,l.jsx)("li",{className:"flex items-center",children:(0,l.jsxs)("span",{className:"flex-grow text-sm text-muted-foreground",title:"You have to publish your project for this domain to work",children:[null==t?void 0:t.name,".lovable.app"]})}),null==a?void 0:a.map((e,t)=>(0,l.jsx)(eK.Z,{domain:e,showRemove:!0,showIcon:!0,refetchDomains:n},t))]})}),(0,l.jsx)(eG.P,{label:"Add Existing Domain",description:"Connect a domain you already own.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("connect"),className:"whitespace-nowrap",children:a&&0===a.length?"Connect Domain":"Connect Another Domain"})}),h&&(0,l.jsx)(eG.P,{label:"Purchase New Domain",description:"Buy a new domain through Ionos.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("buy"),className:"whitespace-nowrap",children:"Buy Domain"})}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,l.jsxs)(eZ.default,{href:"https://docs.lovable.dev/tips-tricks/custom-domain",target:"_blank",children:["How Domains Work ",(0,l.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})})})]})},e1=s(76818),e2=s(49284),e4=s(77113),e5=()=>{let[e,t]=(0,o.useState)(""),s=(0,e4.iZ)(e=>e.project);(0,o.useEffect)(()=>{(null==s?void 0:s.custom_instructions)&&t(s.custom_instructions)},[s]);let{updateProject:a}=(0,e4.d2)(),n=async()=>{try{a({custom_instructions:e},{onSuccess:()=>{eM.ZP.capture(e2.SL.KNOWLEDGE.SAVED),eU.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),i(!1)}catch(e){eU.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}},[r,i]=(0,o.useState)(!1),c=e.length,d=c>1e5;return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"mb-2 flex flex-col gap-2",children:[(0,l.jsx)("p",{className:"text-base font-medium",children:"Instructions & Guidelines"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide guidelines and context to improve your project’s edits. Use this space to:"}),(0,l.jsxs)("ul",{className:"list-disc pl-6 text-sm text-muted-foreground",children:[(0,l.jsx)("li",{children:"Set project-specific rules or best practices."}),(0,l.jsx)("li",{children:"Set coding style preferences (e.g. indentation, naming conventions)."}),(0,l.jsx)("li",{children:"Include external documentation or style guides."})]})]}),(0,l.jsx)(e1.g,{value:e,onChange:e=>{t(e.target.value),e.target.value!==(null==s?void 0:s.custom_instructions)?i(!0):i(!1)},placeholder:"Enter your instructions here...",className:(0,U.cn)("resize-none"),rows:14}),(0,l.jsx)("div",{className:(0,U.cn)("flex justify-end",r&&"mb-12"),children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,l.jsxs)(eZ.default,{href:"https://docs.lovable.dev/features/knowledge",target:"_blank",children:["Get Inspiration ",(0,l.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})})}),r&&(0,l.jsxs)(eG.j,{className:"justify-end gap-3",children:[d&&(0,l.jsxs)("div",{className:"mr-auto text-sm text-destructive-foreground",children:["Message is too long. Exceeded by ",c-1e5," ","characters."]}),(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{t((null==s?void 0:s.custom_instructions)||""),i(!1)},children:"Cancel"}),(0,l.jsx)(j.z,{onClick:n,variant:"affirmative",disabled:d,children:"Save"})]})]})},e6=s(29827),e3=s(53647);let e8=e=>{let{project:t,onCategoryChange:s,disabled:a=!1}=e;return(0,l.jsx)(eG.P,{label:"Project Category",description:"Categorize your project to help others find it.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsxs)(e3.Ph,{defaultValue:(null==t?void 0:t.category)||"",onValueChange:e=>{s(e)},disabled:a,children:[(0,l.jsx)(e3.i4,{className:"w-[180px]",children:(0,l.jsx)(e3.ki,{placeholder:"Select category"})}),(0,l.jsxs)(e3.Bw,{children:[(0,l.jsx)(e3.Ql,{value:"internal_tools",children:"Internal Tools"}),(0,l.jsx)(e3.Ql,{value:"website",children:"Website"}),(0,l.jsx)(e3.Ql,{value:"personal",children:"Personal"}),(0,l.jsx)(e3.Ql,{value:"consumer_app",children:"Consumer App"}),(0,l.jsx)(e3.Ql,{value:"b2b_app",children:"B2B App"}),(0,l.jsx)(e3.Ql,{value:"prototype",children:"Prototype"})]})]})})};var e7=s(6812),e9=s(6512);let te={Title:e=>{let{title:t,description:s,className:a,...n}=e;return(0,l.jsxs)("div",{className:(0,U.cn)("flex flex-col",a),...n,children:[(0,l.jsx)("h2",{children:t}),s&&(0,l.jsx)("p",{className:"text-muted-foreground",children:s})]})},Entry:e=>{let{label:t,value:s}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,l.jsx)("p",{className:"font-medium",children:t}),"string"==typeof s?(0,l.jsx)("p",{className:"text-muted-foreground",children:s}):s]})},Separator:e9.Separator};var tt=s(12285),ts=s(59702),ta=s(79117),tn=s(1828),tr=s(2043),ti=s(97318),tl=s(46170),to=s(3813),tc=s(55157),td=s(78276);let tu=e=>{let{visibility:t,setVisibility:s,redirectToSubscription:a=!1,workspacePlan:n,className:r,disabled:i,disabledTooltipContent:o}=e,c=(0,to.sp)(n),d=(0,eW.dF)({workspacePlan:n}),{openSettings:u}=(0,tc.r)(),m=(0,eJ.z)(eq.g);return(0,l.jsx)(td.b,{showTooltip:!!(i&&o),tooltipContent:(0,l.jsx)("p",{children:o}),children:(0,l.jsxs)(e3.Ph,{value:t,onValueChange:e=>{"private"!==e||d?s(e):a?u("billing"):m({childProps:{dialogDescription:"You need to be on a pro plan to make your project private."}})},disabled:i,children:[(0,l.jsx)(e3.i4,{className:(0,U.cn)("w-[180px]",r),children:(0,l.jsx)(e3.ki,{placeholder:"Select visibility"})}),(0,l.jsxs)(e3.Bw,{children:[(0,l.jsx)(e3.Ql,{value:"public",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.Z,{name:"globe",size:"small"}),(0,l.jsx)("span",{children:"Public"})]})}),(0,l.jsx)(e3.Ql,{value:"private",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.Z,{name:"workspaces",size:"small"}),(0,l.jsx)("span",{children:"Workspace"})]})}),!!c&&(0,l.jsx)(e3.Ql,{value:"draft",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.Z,{name:"draft",size:"small"}),(0,l.jsx)("span",{children:"Personal"})]})})]})]})})},tm=e=>{let{className:t,isAdmin:s}=e,a=(0,e$.hO)(e=>{var t;return(null===(t=e.projectWorkspace)||void 0===t?void 0:t.plan)||null}),n=(0,e4.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.visibility}),[r,i]=(0,o.useState)(void 0),{setVisibilityMutation:c}=(0,e4.d2)(),{disableChangeVisibility:d,disabledTooltipContent:u}=(0,o.useMemo)(()=>s?{disableChangeVisibility:!1,disabledTooltipContent:void 0}:{disableChangeVisibility:!0,disabledTooltipContent:"You need to be an admin to change the visibility of your project."},[s]);return(0,o.useEffect)(()=>{n&&i(n)},[n]),(0,l.jsx)(tu,{disabled:d||c.isPending,disabledTooltipContent:u,workspacePlan:a,visibility:r||n||void 0,setVisibility:e=>{i(e),c.mutateAsync(e)},className:t})},tp=e=>{var t;let{isPaidUser:s,className:a}=e,{setBadgeVisibility:n}=(0,e4.d2)(),r=(0,e4.iZ)(e=>e.project),i=(0,eJ.z)(eq.g),[c,d]=(0,o.useState)(null!==(t=null==r?void 0:r.hide_badge)&&void 0!==t&&t);return(0,l.jsx)(tn.r,{checked:c,onCheckedChange:e=>{if(!s){i({childProps:{dialogDescription:'You need to be on a pro plan to hide the "Edit with Lovable" badge.'}});return}n(e),d(e)},disabled:!1,className:(0,U.cn)("",a)})};var th=s(21770),tx=s(64040);let tg=e=>{let{projectId:t,initialFeatured:s,className:a}=e,[n,r]=(0,o.useState)(s),i=(0,th.D)({mutationFn:e=>{let{featured:s}=e;return(0,g.SJ)().put("/projects/".concat(t,"/featured"),{featured:s})},onSuccess:(e,t)=>{let{featured:s}=t;r(s),eU.Am.success("Featured status updated",{description:"Project is now ".concat(s?"featured":"not featured",".")})},onError:e=>{(0,tx.Eo)(e)}});return(0,l.jsx)(tn.r,{disabled:i.isPending,checked:n,onCheckedChange:e=>{i.mutate({featured:e})},className:(0,U.cn)("",a)})},tf=e=>(null==e?void 0:e.seconds)?(0,I.WU)(new Date(1e3*e.seconds),"yyyy-MM-dd HH:mm:ss"):void 0;var tj=e=>{var t,s,a,n;let{projectId:r}=e,{isProjectAdmin:i,canEdit:c}=(0,tr.t)(),[d,u]=(0,o.useState)(!1),[p,h]=(0,o.useState)(!1),x=(0,e$.hO)(e=>e.projectWorkspace),g=(0,e$.hO)(e=>{var t;return(null===(t=e.projectWorkspace)||void 0===t?void 0:t.plan)||null}),f=(0,m.dl)(eH.P.Templates)||!1,v=(0,e4.iZ)(e=>e.project),{userData:b}=(0,eW.SE)(),y=!!(null==v?void 0:v.is_supabase_enabled)||!!(null==v?void 0:v.supabase_project_config),w=c||!y,{updateProject:N,setIsRemixDialogOpen:_}=(0,e4.d2)(),k=(0,e6.NL)(),S=async()=>{N({is_template:!(null==v?void 0:v.is_template)},{onSuccess:()=>{k.invalidateQueries({queryKey:ti.E.templates((null==x?void 0:x.id)||"")})}})},C=(0,eJ.z)(eq.g),E=(0,e7.Q)(e=>e.workspaces).length>1,z=(0,tl.XB)(null!=g?g:void 0),A=(0,o.useMemo)(()=>(0,l.jsx)("span",{onClick:()=>{C({childProps:{dialogDescription:"Upgrade to Pro to unlock this feature."}})},className:"cursor-pointer text-sm text-muted-foreground underline transition-opacity duration-150 ease-in-out hover:opacity-75",children:"Upgrade your plan"}),[C]);return(0,l.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,l.jsx)("p",{className:"col-span-full font-medium",children:"Overview"}),(0,l.jsx)(te.Entry,{label:"Project name",value:null==v?void 0:v.name}),(0,l.jsx)(te.Entry,{label:"Owner",value:(null==v?void 0:v.created_by)&&(0,l.jsxs)(eZ.default,{className:"break-words text-sm text-muted-foreground underline",target:"_blank",href:"/@".concat(v.created_by),children:["@",v.created_by]})}),(0,l.jsx)(te.Entry,{label:"Created at",value:tf(null==v?void 0:v.created_at)}),(null==v?void 0:null===(t=v.creation_options)||void 0===t?void 0:t.tech_stack)&&(0,l.jsx)(te.Entry,{label:"Tech stack",value:null==v?void 0:null===(s=v.creation_options)||void 0===s?void 0:s.tech_stack}),(0,l.jsx)(te.Entry,{label:"Messages count",value:(null==v?void 0:null===(a=v.user_message_count)||void 0===a?void 0:a.toString())||"0"}),(0,l.jsx)(te.Entry,{label:"AI Edits count",value:(null==v?void 0:null===(n=v.edit_count)||void 0===n?void 0:n.toString())||"0"})]}),(0,l.jsx)(te.Separator,{}),(0,l.jsx)(eG.P,{label:"Project Visibility",description:z?"Keep your project hidden and prevent others from remixing it.":(0,l.jsxs)("p",{children:[A," to keep your project hidden and prevent others from remixing it."]}),mobileLayout:"vertical",justify:"end",badges:["pro"],children:(0,l.jsx)(tm,{isAdmin:i})}),v&&(0,l.jsx)(e8,{project:v,onCategoryChange:e=>N({category:e}),disabled:!c}),(0,l.jsx)(eG.P,{label:'Hide "Lovable" Badge',description:z?'Remove the "Edit with Lovable" badge from your published work.':(0,l.jsxs)("p",{children:[A,' to remove the \'"Edit with Lovable" badge from your published work.']}),mobileLayout:"horizontal",justify:"end",badges:["pro"],children:(0,l.jsx)(tp,{isPaidUser:z})}),v&&(null==b?void 0:b.is_admin)&&(0,l.jsx)(eG.P,{label:"Feature Project",description:"Highlight this project on the homepage.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(tg,{projectId:r,initialFeatured:!!v.featured})}),f&&(0,l.jsx)(eG.P,{label:"Use as a Template",description:(0,l.jsxs)("p",{children:["Use this project as a template in"," ",(0,l.jsx)("span",{className:"font-medium",children:(null==x?void 0:x.name)?x.name:"your workspace"})," ","to reference when starting new projects."]}),mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(tn.r,{defaultChecked:(null==v?void 0:v.is_template)||!1,onCheckedChange:S})}),v&&c&&(0,l.jsx)(eG.P,{label:"Rename Project",description:"Update your project's title.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(j.z,{onClick:()=>u(!0),children:"Rename"})}),v&&(0,l.jsx)(eG.P,{label:"Remix Project",description:"Duplicate this app in a new project.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsxs)(j.z,{onClick:()=>_(!0),disabled:!w,children:["Remix",!w&&(0,l.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"Unavailable for projects connected to Supabase"})]})}),i&&E&&(0,l.jsx)(eG.P,{label:"Transfer",description:"Move this project to a different workspace.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(tt.O,{projectId:r,currentWorkspaceId:null==v?void 0:v.workspace_id})}),v&&i&&(0,l.jsx)(eG.P,{label:"Delete Project",description:"Permanently delete this project.",mobileLayout:"horizontal",justify:"end",children:(0,l.jsx)(j.z,{variant:"destructive",onClick:()=>h(!0),children:"Delete"})}),v&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ta.i,{project:v,isOpen:d,onClose:()=>u(!1)}),(0,l.jsx)(ts.p,{project:v,isOpen:p,onClose:()=>h(!1)})]})]})},tv=s(49027),tb=s(95098),ty=s(26110),tw=s(4216);let tN=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,l.jsx)(tw.dy.Root,{shouldScaleBackground:t,...s})};tN.displayName="Drawer",tw.dy.Trigger;let t_=tw.dy.Portal;tw.dy.Close;let tk=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(tw.dy.Overlay,{ref:t,className:(0,U.cn)("fixed inset-0 z-[10000] bg-black/80",s),...a})});tk.displayName=tw.dy.Overlay.displayName;let tS=o.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,l.jsxs)(t_,{children:[(0,l.jsx)(tk,{}),(0,l.jsxs)(tw.dy.Content,{ref:t,className:(0,U.cn)("fixed inset-x-0 bottom-0 z-[10000] mt-24 flex h-auto flex-col rounded-t-[24px] border bg-background",s),...n,children:[(0,l.jsx)("div",{className:"mx-auto mt-4 h-1.5 w-[60px] rounded-full bg-muted"}),a]})]})});tS.displayName="DrawerContent";let tC=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(tw.dy.Title,{ref:t,className:(0,U.cn)("text-lg font-medium leading-none tracking-tight",s),...a})});tC.displayName=tw.dy.Title.displayName;let tE=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(tw.dy.Description,{ref:t,className:(0,U.cn)("text-sm text-muted-foreground",s),...a})});tE.displayName=tw.dy.Description.displayName;let tz=e=>{let{children:t,open:s,onOpenChange:a}=e;return(0,y.Z)("md")?(0,l.jsx)(tN,{open:s,onOpenChange:a,children:(0,l.jsx)(tI,{children:t})}):(0,l.jsx)(ty.Vq,{open:s,onOpenChange:a,children:(0,l.jsx)(tA,{children:t})})},tA=e=>{let{children:t,className:s,...a}=e;return(0,l.jsxs)(ty.cZ,{hideCloseButton:!0,className:(0,U.cn)("flex h-[90dvh] max-h-[640px] w-[95dvw] flex-1 flex-col items-start px-0 py-0",s),size:"xl",...a,"aria-describedby":"Settings dialog",children:[(0,l.jsxs)(tb.TX,{children:[(0,l.jsx)(ty.Be,{children:"Settings dialog"}),(0,l.jsx)(tv.$N,{children:"Settings dialog"})]}),(0,l.jsx)(tv.GG,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",className:"absolute right-2 top-2 z-10 hover:bg-transparent hover:opacity-75",children:(0,l.jsx)(b.Z,{name:"close",size:"small"})})}),t]})},tI=e=>{let{children:t,className:s,...a}=e;return(0,l.jsxs)(tS,{className:(0,U.cn)("flex h-[90dvh] flex-col items-start px-0 py-0",s),...a,children:[(0,l.jsxs)(tb.TX,{children:[(0,l.jsx)(tE,{children:"Settings drawer"}),(0,l.jsx)(tC,{children:"Settings drawer"})]}),t]})};var tD=s(5103),tO=s(67817),tP=s(69084),tT=s(41135),tL=s(32429),tR=s(23664),tF=s(51408);function tZ(e){let{title:t,description:s,featureKey:a,checked:n}=e,{authUser:r}=(0,d.Eu)(),i=(0,tR.U0)(),o=(0,e6.NL)(),{mutate:c}=(0,th.D)({mutationFn:async e=>{let t=(0,g.SJ)();return await t.patch("/users/".concat(null==r?void 0:r.uid,"/experimental-features"),{feature:a,enabled:e})},onMutate:e=>{o.cancelQueries({queryKey:tF.V.experimentalFeatures({user:r}).queryKey});let t=o.getQueryData(tF.V.experimentalFeatures({user:r}).queryKey);return o.setQueryData(tF.V.experimentalFeatures({user:r}).queryKey,t=>t?{...t,[a]:e}:null),{previousFeatures:t}},onSuccess:(e,t)=>{i.capture("lab-feature-toggled",{feature:a,checked:n})},onError:(e,t,s)=>{o.setQueryData(tF.V.experimentalFeatures({user:r}).queryKey,e=>{var t;return e?{...e,[a]:null==s?void 0:null===(t=s.previousFeatures)||void 0===t?void 0:t[a]}:null}),(0,tx.Eo)(e)}});return(0,l.jsx)(eG.P,{label:t,description:s,mobileLayout:"horizontal",children:(0,l.jsx)(tn.r,{checked:n,onCheckedChange:c,disabled:!r,className:"ml-auto"})})}let tM=()=>{let{isLoading:e,features:t}=(0,tL.G)(),s=(0,u.aS)(e=>{var t;return null===(t=e.currentWorkspace)||void 0===t?void 0:t.plan}),a=(0,tl.XB)(s),n=(0,m.dl)(eH.P.CodeEditorWrite);return(0,l.jsx)(p.tM,{value:"labs",title:"Labs",description:"These are experimental features, that might be modified or removed.",docsLink:"https://docs.lovable.dev/features/labs",children:e?(0,l.jsx)(X.O,{className:"h-10 w-full"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tZ,{title:"GitHub Branch Switching",description:"Select the branch to make edits to in your GitHub repository.",featureKey:"git_branch_switching",checked:!!(null==t?void 0:t.git_branch_switching)}),a&&!n&&(0,l.jsx)(tZ,{title:"Code Editing in Code Mode",description:(0,l.jsx)(l.Fragment,{children:"Enable code edits in Code Mode."}),featureKey:"code_editor",checked:!!(null==t?void 0:t.code_editor)})]})})};var tU=s(92825),tq=s(79858);let tW=e=>{var t;let{isInteractive:s=!1,className:a,authUser:n,userData:r,...i}=e,o=(0,tq.Q)(null==r?void 0:r.id),c=(null==r?void 0:null===(t=r.attributes)||void 0===t?void 0:t.display_name)||(null==n?void 0:n.email)||r.username;return(0,l.jsx)(tU.N,{name:c,isInteractive:s,photoSrc:void 0,userColor:o,className:a,...i})},tK=e=>{let{userData:t,authUser:s}=e;return(0,l.jsx)(eG.P,{label:"Your Avatar",description:"Your avatar is automatically generated based on your account.",mobileLayout:"horizontal",children:(0,l.jsx)(tW,{className:"ml-auto h-10 w-10 md:ml-0",userData:t,authUser:s})})};var tJ=s(2124);let tG=e=>{var t;let{isLast:s}=e,{userData:a}=(0,eW.SE)(),n=null!==(t=null==a?void 0:a.default_project_visibility)&&void 0!==t?t:void 0,[r,i]=(0,o.useState)(n);(0,o.useEffect)(()=>{i(n)},[n]);let c=(0,th.D)({mutationFn:async e=>(0,g.SJ)().put("/user/".concat(a.id),{default_project_visibility:e}),onSuccess:(e,t)=>{i(t),eU.Am.success("Default project visibility updated",{description:"Default project visibility is now ".concat(t)})},onError:e=>{(0,tx.Eo)(e),i(n)}});return(0,l.jsx)(eG.P,{label:"Default Project Visibility",description:"Set whether new projects are publicly accessible by default. You can always change visibility settings later per project.",isLast:s,children:a?(0,l.jsx)(tJ.F,{workspacePlan:null,visibility:r,setVisibility:e=>{i(e),c.mutate(e)},disabled:c.isPending,redirectToSubscription:!0}):(0,l.jsx)(X.O,{className:"h-10 w-full"})})};var tV=s(95186);let tB=e=>{var t;let{authUser:s}=e;return(0,l.jsx)(eG.P,{label:"Email",description:"Your email address associated with your account.",children:(0,l.jsx)(tV.I,{value:null!==(t=null==s?void 0:s.email)&&void 0!==t?t:"",disabled:!0,className:"w-full",placeholder:"No email available"})})};var tH=s(13590),tY=s(29501),tQ=s(91115),tX=s(19060),t$=s(15681);let t0=tQ.z.object({display_name:tQ.z.string().optional(),bio:tQ.z.string().optional(),location:tQ.z.string().optional(),link:tQ.z.string().optional(),hide_profile_pictures:tQ.z.boolean().optional()}),t1=e=>{var t,s,a,n,r,i,o,c,d,u;let{userData:m,avatarExists:p}=e,h=(0,tY.cI)({defaultValues:{display_name:null!==(i=null===(t=m.attributes)||void 0===t?void 0:t.display_name)&&void 0!==i?i:"",bio:null!==(o=null===(s=m.attributes)||void 0===s?void 0:s.bio)&&void 0!==o?o:"",location:null!==(c=null===(a=m.attributes)||void 0===a?void 0:a.location)&&void 0!==c?c:"",link:null!==(d=null===(n=m.attributes)||void 0===n?void 0:n.link)&&void 0!==d?d:"",hide_profile_pictures:null!==(u=null===(r=m.attributes)||void 0===r?void 0:r.hide_profile_pictures)&&void 0!==u&&u},resolver:(0,tH.F)(t0)}),x=(0,e6.NL)(),{mutate:f,isPending:v}=(0,th.D)({mutationFn:async e=>(0,g.SJ)().put("/user/".concat(m.id),{attributes:e}),onSuccess:(e,t)=>{eU.Am.success("Success",{description:"Account settings updated successfully"}),h.reset(t),x.invalidateQueries({queryKey:ti.E.all})},onError:e=>{(0,tx.Eo)(e)}});return(0,l.jsx)(t$.l0,{...h,children:(0,l.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:h.handleSubmit(e=>{let t=h.formState.defaultValues,s=Object.keys(e).filter(s=>e[s]!==(null==t?void 0:t[s]));eM.ZP.capture(e2.gg.SETTINGS_UPDATED,{changedFields:s,fieldsCount:s.length,hasDisplayName:!!e.display_name,hasBio:!!e.bio,hasLocation:!!e.location,hasLink:!!e.link,hideProfilePictures:!!e.hide_profile_pictures}),f(e)}),children:[(0,l.jsx)(eG.P,{label:"Name",description:"Your full name, as visible to others.",children:(0,l.jsx)(t$.Wi,{control:h.control,name:"display_name",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"w-full",children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{...t})}),(0,l.jsx)(t$.zG,{})]})}})}),(0,l.jsx)(eG.P,{label:"Description",description:"A short description of yourself or your work.",children:(0,l.jsx)(t$.Wi,{control:h.control,name:"bio",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"w-full",children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(e1.g,{className:"resize-none border bg-background",rows:3,...t})}),(0,l.jsx)(t$.zG,{})]})}})}),(0,l.jsx)(eG.P,{label:"Location",description:"Where you're based.",children:(0,l.jsx)(t$.Wi,{control:h.control,name:"location",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"w-full",children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{...t})}),(0,l.jsx)(t$.zG,{})]})}})}),(0,l.jsx)(eG.P,{label:"Link",description:"Add a link to your personal website or portfolio.",children:(0,l.jsx)(t$.Wi,{control:h.control,name:"link",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"w-full",children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{...t})}),(0,l.jsx)(t$.zG,{})]})}})}),p&&(0,l.jsx)(eG.P,{label:"Hide Profile Picture",mobileLayout:"horizontal",className:"last:border-b",children:(0,l.jsx)(t$.Wi,{control:h.control,name:"hide_profile_pictures",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"ml-auto flex flex-row items-center space-x-2 space-y-0",children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tX.X,{checked:t.value,onCheckedChange:t.onChange})}),(0,l.jsx)(t$.zG,{})]})}})}),h.formState.isDirty&&(0,l.jsxs)(eG.j,{className:"justify-end gap-2",children:[(0,l.jsx)(j.z,{type:"button",variant:"secondary",onClick:()=>{eM.ZP.capture(e2.gg.SETTINGS_CANCELLED),h.reset()},children:"Cancel"}),(0,l.jsx)(j.z,{type:"submit",loading:v,variant:"affirmative",children:"Update"})]})]})})},t2=tQ.z.object({username:tQ.z.string().min(3,{message:"Username must be at least 3 characters"}).max(16,{message:"Username must be at most 16 characters"}).regex(/^[a-z]/,{message:"Username must start with a letter"}).regex(/^[a-z0-9_]+$/,{message:"Username can only contain lowercase letters, numbers, and underscores"})}),t4=e=>{let t=(0,tY.cI)({resolver:(0,tH.F)(t2)}),s=(0,th.D)({mutationFn:async e=>{let{username:t}=e;return(0,g.SJ)().put("/user/username",{username:t})},onSuccess:()=>{var t;eU.Am.success("Success",{description:"Username updated successfully"}),null===(t=e.onOpenChange)||void 0===t||t.call(e,!1)},onError:e=>{(0,tx.Eo)(e)}});return(0,l.jsx)(ty.Vq,{...e,children:(0,l.jsxs)(ty.cZ,{children:[(0,l.jsx)(ty.$N,{children:"Set Username"}),(0,l.jsx)(ty.Be,{children:"Please enter your desired username. You can not change your username once you have set it."}),(0,l.jsx)("form",{onSubmit:t.handleSubmit(e=>{s.mutate(e)}),children:(0,l.jsxs)(t$.l0,{...t,children:[(0,l.jsx)(t$.Wi,{control:t.control,name:"username",render:e=>{let{field:t}=e;return(0,l.jsxs)(t$.xJ,{className:"w-full",children:[(0,l.jsx)(t$.lX,{children:"Username"}),(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{...t})}),(0,l.jsx)(t$.zG,{})]})}}),(0,l.jsx)(ty.cN,{className:"mt-4",children:(0,l.jsx)(j.z,{loading:s.isPending,type:"submit",children:"Save"})})]})})]})})},t5=e=>{let{username:t,userId:s}=e,[a,n]=(0,o.useState)(!1),r=!!s&&t===s;return(0,l.jsxs)(eG.P,{label:"Username",description:"Your public identifier and profile URL.",children:[(0,l.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-start gap-2",children:(0,l.jsx)(tV.I,{placeholder:"Username",className:"w-full",value:null!=t?t:"",disabled:!r,onClick:()=>{t&&n(!0)}})}),(0,l.jsxs)("p",{className:"flex items-center gap-1 break-all text-sm text-muted-foreground underline transition-colors duration-150 ease-in-out hover:text-muted-foreground/80",children:[t?(0,l.jsxs)(eZ.default,{className:"",href:"".concat(window.location.origin,"/@").concat(t),target:"_blank",rel:"noreferrer",children:["lovable.dev/@",t]}):"lovable.dev/@<username>",(0,l.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})]}),(0,l.jsx)(t4,{open:a,onOpenChange:n})]})};var t6=s(61312);let t3=e=>{let{data:t={}}=(0,x.a)({...tF.V.contributions({userData:e}),enabled:!!(null==e?void 0:e.username)});return new Map(Object.entries(t))},t8=Math.ceil(365/7),t7=e=>{let{}=e,{userData:t}=(0,eW.SE)(),s=t3(t),a=(0,o.useMemo)(()=>{let e=new Date,t=[];for(let a=0;a<t8;a++){let n=[];for(let t=0;t<7;t++){let r=(0,ed.k)(e,(t8-a-1)*7+(7-t-1)),i=(0,I.WU)(r,"yyyy-MM-dd"),l=s.get(i)||0;n.push({date:r,count:l})}t.push(n)}return t},[s]),n=(0,o.useRef)(null),[r,i]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=()=>{let e=n.current;e&&(i(e.scrollLeft>0),d(e.scrollLeft+e.clientWidth<e.scrollWidth-1))},t=n.current;if(t)return t.scrollLeft=t.scrollWidth,i(t.scrollLeft>0),d(t.scrollWidth>t.clientWidth&&t.scrollLeft+t.clientWidth<t.scrollWidth-1),t.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{t.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let u=(0,o.useMemo)(()=>Math.max(...Array.from(s.values()),0),[s]),m=(0,o.useMemo)(()=>e=>{if(0===e||0===u)return"bg-muted";let t=e/u;return t<=.25?"bg-muted-hover":t<=.5?"bg-muted-active":t<=.75?"bg-muted-foreground":"bg-foreground"},[u]);return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("p",{className:"text-base font-medium",children:"Your Activity"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{ref:n,className:"overflow-x-auto pb-2 scrollbar-thin scrollbar-track-background scrollbar-thumb-background",children:(0,l.jsx)("div",{className:"inline-block min-w-[600px] max-w-[760px] rounded-xl border border-input bg-card p-2",children:(0,l.jsx)("div",{className:"flex gap-[2px]",children:a.map((e,t)=>(0,l.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((e,t)=>(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)("div",{className:(0,U.cn)("size-2.5 rounded-[2px] transition-colors duration-200",m(e.count))})}),(0,l.jsxs)(ev._v,{side:"top",align:"center",children:["".concat((0,I.WU)(e.date,"MMM d, yyyy"),": ").concat(e.count>0?e.count:"No"," activity"),(0,l.jsx)(t6.Eh,{className:"fill-primary"})]})]},t))},t))})})}),r&&(0,l.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-6 bg-gradient-to-r from-background via-background/80 to-transparent"}),c&&(0,l.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-6 bg-gradient-to-l from-background via-background/80 to-transparent"})]})]})},t9=()=>{let{userData:e}=(0,eW.SE)();return(0,th.D)({mutationFn:async t=>{let s=(0,g.SJ)();return await s.put("/user/".concat(e.id),{sound_effect_active:t})},onSuccess:(e,t)=>{eU.Am.success("Sound effect settings updated",{description:"Sound effects will now play ".concat("firstgen"===t?"on first generation":"always"===t?"on all generations":"never")})},onError:e=>{(0,tx.Eo)(e)}})};var se=s(26815),st=s(74991);let ss=e=>{let{active:t,setActive:s,onClick:a,disabled:n}=e;return(0,l.jsxs)(st.E,{className:"flex w-full flex-col gap-4",disabled:n,defaultValue:t,onValueChange:e=>{s(e)},children:[(0,l.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,l.jsx)(st.m,{value:"firstgen",id:"firstgen",onClick:()=>{null==a||a()}}),(0,l.jsx)(se.Label,{htmlFor:"firstgen",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,l.jsx)(b.Z,{size:"small",name:"stacked_line_chart",className:"text-muted-foreground"}),"First Generation"]})})]}),(0,l.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,l.jsx)(st.m,{value:"always",id:"always",onClick:()=>{null==a||a()}}),(0,l.jsx)(se.Label,{htmlFor:"always",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,l.jsx)(b.Z,{size:"small",name:"volume_up",className:"text-muted-foreground"}),"Always"]})})]}),(0,l.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,l.jsx)(st.m,{value:"never",id:"never",onClick:()=>{null==a||a()}}),(0,l.jsx)(se.Label,{htmlFor:"never",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,l.jsx)(b.Z,{size:"small",name:"volume_off",className:"text-muted-foreground"}),"Never"]})})]})]})},sa=()=>{var e;let{userData:t}=(0,eW.SE)(),s=t9(),a=null!==(e=null==t?void 0:t.sound_effect_active)&&void 0!==e?e:"firstgen";return(0,l.jsx)(eG.P,{label:"Generation complete sound",description:"Plays a satisfying sound notification when a generation is finished.",isLast:!0,children:t?(0,l.jsx)(ss,{active:a,setActive:e=>{s.mutate(e)}}):(0,l.jsx)(X.O,{className:"h-10 w-full"})})},sn=()=>{let{userData:e}=(0,eW.SE)();return(0,th.D)({mutationFn:async t=>(0,g.SJ)().put("/user/".concat(e.id),{suggestions_enabled:t}),onSuccess:(e,t)=>{eU.Am.success("Suggestions settings updated",{description:"Suggestions are now ".concat(t?"enabled":"disabled")})},onError:e=>{(0,tx.Eo)(e)}})},sr=()=>{let{userData:e}=(0,eW.SE)(),t=sn(),s=(null==e?void 0:e.suggestions_enabled)===!0;return(0,l.jsx)(eG.P,{label:"Chat Suggestions",description:"Show helpful suggestions in the chat interface to enhance your experience.",mobileLayout:"horizontal",isLast:!1,children:e?(0,l.jsx)(tn.r,{checked:s,onCheckedChange:e=>{t.mutate(e)},className:"ml-auto"}):(0,l.jsx)(X.O,{className:"h-5 w-9"})})};var si=()=>{var e;let{authUser:t}=(0,d.Eu)(),{userData:s}=(0,eW.SE)(),a=(0,u.aS)(e=>{var t;return!!(null===(t=e.currentWorkspace)||void 0===t?void 0:t.id)}),n=null!==(e=(0,m.dl)(eH.P.GithubContribution))&&void 0!==e&&e,r=(0,to.aI)();return s?(0,l.jsxs)(p.tM,{value:"account",title:"Account Settings",description:"Personalize how others see and interact with you on Lovable.",children:[n&&(0,l.jsx)(t7,{}),(0,l.jsx)(tK,{userData:s,authUser:t}),(0,l.jsx)(t5,{userId:s.id,username:s.username}),(0,l.jsx)(tB,{authUser:t}),(0,l.jsx)(t1,{userData:s,avatarExists:!!(null==t?void 0:t.photoURL)}),!a&&(0,l.jsx)(tG,{isLast:!1}),r&&(0,l.jsx)(sr,{}),(0,l.jsx)(sa,{}),(0,l.jsx)("div",{className:"mb-12"})]}):null},sl=s(4310),so=s(33910),sc=s(89668);let sd=e=>{var t,s,a;let{userData:n}=(0,eW.SE)(),r=null==n?void 0:null===(t=n.github)||void 0===t?void 0:t.encrypted_access_token,i=(0,o.useRef)(r),l=(0,x.a)(sc.t.workspaceGithubInstallations({workspaceId:e}));return(0,o.useEffect)(()=>{i.current!==r&&(l.refetch().catch(()=>{}),i.current=r)},[r,l]),{installations:null===(s=l.data)||void 0===s?void 0:s.installations,requiredAction:null===(a=l.data)||void 0===a?void 0:a.required_action}};var su=s(20653),sm=s(81677);let sp=e=>{let{isLoading:t,hasAccessToken:s,hasValidAccessToken:a,githubUsername:n,onGithubConnected:r,isWorkspaceAdmin:i}=e;return(0,o.useEffect)(()=>{let e=e=>{"githubAppAuthenticated"===e.data&&r()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[r]),(0,l.jsx)(eG.P,{label:"Connected Account",description:"Add your GitHub account to manage connected organizations.",justify:"end",badges:["admin"],children:t?(0,l.jsx)(X.O,{className:"h-7 w-32"}):s&&a?(0,l.jsxs)(j.z,{disabled:!0,variant:"outline",size:"sm",children:[(0,l.jsx)(tT.xR.GitHub,{className:"h-4 w-4"}),null!=n?n:"Connected"]}):(0,l.jsx)(sh,{isWorkspaceAdmin:i})})},sh=e=>{let{isWorkspaceAdmin:t}=e;return(0,l.jsxs)(j.z,{variant:"default",size:"sm",onClick:sm.Hp,disabled:!t,children:[(0,l.jsx)(su.wGg,{className:"size-4"}),"Connect GitHub"]})};var sx=s(57054),sg=s(39484);function sf(e){let{projectId:t,main_branch:s,searchTerm:a,setSearchTerm:n,switchBranchMutation:r}=e,{data:i,isPending:c,error:d}=(0,x.a)({queryKey:ti.iZ.branches(t),queryFn:async()=>(0,g.SJ)().get("/projects/".concat(t,"/github/branches"))}),u=(0,o.useMemo)(()=>null==i?void 0:i.some(e=>e.name===s),[i,s]),{branchesWithCurrentFirst:m,filteredBranches:p}=(0,o.useMemo)(()=>{if(!i)return{branchesWithCurrentFirst:[],filteredBranches:[]};let e=i.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())),t=e.find(e=>e.name===s);return t?{branchesWithCurrentFirst:[t,...e.filter(e=>e.name!==s)],filteredBranches:e}:{branchesWithCurrentFirst:e,filteredBranches:e}},[i,s,a]);return(0,l.jsxs)("div",{className:"relative flex flex-col gap-3 p-4",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,l.jsx)("h4",{children:"Switch or create branch"}),(0,l.jsx)(sx.xp,{className:"absolute right-2 top-2",asChild:!0,children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",children:(0,l.jsx)(b.Z,{name:"close",size:"small"})})})]}),(0,l.jsx)("div",{children:c?(0,l.jsx)(sg.T,{text:"Loading branches from GitHub..."}):d?(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive-primary",children:[(0,l.jsx)(b.Z,{name:"warning_fill",size:"small"}),d.message]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(tV.I,{type:"text",placeholder:"Find or create a branch...",value:a,onChange:e=>n(e.target.value)})}),(0,l.jsxs)("div",{className:"branches-list flex max-h-[40vh] flex-col gap-2 overflow-y-auto pt-2",children:[m.map(e=>(0,l.jsxs)(j.z,{className:"branch-item flex w-full items-center justify-between px-3 text-left",onClick:()=>r.mutate(e.name),variant:e.name===s?"default":"ghost",disabled:r.isPending||e.name===s,loading:r.isPending&&r.variables===e.name,children:[(0,l.jsx)("span",{children:r.isPending&&r.variables===e.name?"Switching to "+e.name:e.name}),e.name===s&&(0,l.jsx)(b.Z,{name:"check"})]},e.name)),a&&!p.some(e=>e.name===a)&&(0,l.jsx)(td.b,{showTooltip:!u,tooltipContent:"Your current branch does not exist on GitHub. Please switch to an existing branch first, then create your new branch.",children:(0,l.jsxs)(j.z,{className:(0,U.cn)("h-auto w-full items-center justify-start"),onClick:()=>r.mutate(a),variant:"outline",disabled:r.isPending||!u,loading:r.isPending,children:[(0,l.jsx)(b.Z,{name:"add",className:"text-muted-foreground",size:"small"}),(0,l.jsxs)("p",{className:"text-wrap text-left",children:["Create branch ",(0,l.jsx)("strong",{children:a})," from"," ",(0,l.jsx)("strong",{children:s})]})]})})]})]})})]})}let sj=e=>{let{mainBranch:t,projectId:s}=e,[a,n]=(0,o.useState)(""),[r,i]=(0,o.useState)(!1),c=(0,e4.iZ)(e=>{var t;return(null===(t=e.project)||void 0===t?void 0:t.main_branch)||"main"}),d=(0,y.Z)("md"),u=(0,e6.NL)(),m=(0,th.D)({mutationFn:async e=>{await (0,g.SJ)().post("/projects/".concat(s,"/github/branches"),{branch_name:e})},onSuccess:(e,t)=>{u.invalidateQueries({queryKey:ti.iZ.branches(s)}),eU.Am.success("Lovable is now using branch: ".concat(t)),n(""),i(!1)},onError:e=>{(0,tx.Eo)(e)}});return(0,l.jsx)(eG.P,{label:"Branch",description:"Choose the GitHub branch you want to work on inside Lovable.",justify:"end",badges:["labs"],children:(0,l.jsxs)(sx.J2,{open:r,onOpenChange:i,children:[(0,l.jsx)(sx.xo,{asChild:!0,children:(0,l.jsxs)(j.z,{variant:"outline",size:"sm",loading:m.isPending,children:[(0,l.jsx)(b.Z,{name:"graph_1",className:"h-4 w-4"}),t,(0,l.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,l.jsx)(sx.yk,{className:"p-0",align:d?"start":"end",children:(0,l.jsx)(sf,{projectId:s,main_branch:c,searchTerm:a,setSearchTerm:n,switchBranchMutation:m})})]})})};var sv=s(12339),sb=s(6478);let sy=e=>{let{label:t,value:s}=e;return(0,l.jsx)(sv.SP,{className:"rounded-none border-b border-transparent px-0 py-0.5 text-xs data-[state=active]:border-b-border data-[state=active]:font-medium data-[state=active]:shadow-none",value:s,children:t})},sw=e=>{let{url:t}=e,s=(0,o.forwardRef)((e,t)=>(0,l.jsx)(j.z,{ref:t,...e,variant:"ghost",className:"-mr-2 h-8 hover:text-primary",size:"icon-sm",children:(0,l.jsx)(b.Z,{name:"content_copy",className:"h-4 w-4"})}));s.displayName="TriggerComponent";let a=(0,sb.F)()({TriggerComponent:s,textToCopy:t});return(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(tV.I,{className:"h-8 flex-1 p-2 font-mono text-muted-foreground focus:text-primary md:text-xs",value:t,onFocus:e=>e.target.select(),readOnly:!0}),(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{children:a}),(0,l.jsx)(ev._v,{children:"Copy to clipboard"})]})]})},sN=e=>{var t,s;let{project:a}=e,n=(null==a?void 0:a.github_repo_name)?(0,sl.c_)(a.github_repo_name,null==a?void 0:null===(t=a.github_owner)||void 0===t?void 0:t.name):"#",r=(null==a?void 0:null===(s=a.github_owner)||void 0===s?void 0:s.name)+"/"+(null==a?void 0:a.github_repo_name);return(0,l.jsx)(eG.P,{label:"Clone",description:"Copy this repository to your local environment.",justify:"end",children:(0,l.jsxs)(sv.mQ,{defaultValue:"https",className:"w-full pb-2",children:[(0,l.jsxs)(sv.dr,{className:"gap-2 px-0 pb-0 pt-0",children:[(0,l.jsx)(sy,{value:"https",label:"HTTPS"}),(0,l.jsx)(sy,{value:"ssh",label:"SSH"}),(null==a?void 0:a.is_github)&&(0,l.jsx)(sy,{value:"githubcli",label:"GitHub CLI"})]}),(0,l.jsx)(sv.nU,{value:"https",className:"mt-0",children:(0,l.jsx)(sw,{url:"".concat(n,".git")})}),(0,l.jsx)(sv.nU,{value:"ssh",className:"mt-0",children:(0,l.jsx)(sw,{url:"git@github.com:".concat(r,".git")})}),(0,l.jsx)(sv.nU,{value:"githubcli",className:"mt-0",children:(0,l.jsx)(sw,{url:"gh repo clone ".concat(r)})})]})})};var s_=s(74751);let sk=e=>{let{children:t}=e;return(0,l.jsx)(ty.cZ,{className:"max-h-[80vh] gap-0 overflow-y-auto p-0",size:"lg",children:t})},sS=e=>{let{title:t,description:s,badge:a}=e;return(0,l.jsxs)(ty.fK,{className:"px-6 py-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(ty.$N,{className:"font-medium",children:t}),a&&(0,l.jsx)(s_.p,{badge:a})]}),(0,l.jsx)(ty.Be,{className:"text-sm text-muted-foreground",children:s})]})},sC=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"flex gap-4 px-6 py-4",children:t})},sE=e=>{let{workspace:t}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Workspace"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(tP.z,{workspace:t,className:"h-7 w-7"}),(0,l.jsx)("p",{className:"font-medium",children:t.name})]})]})};var sz=s(16831);let sA=e=>{let t=(0,e6.NL)(),{mutate:s,isPending:a}=(0,th.D)({mutationFn:async t=>{let{githubInstallation:s}=t,a=(0,g.SJ)();return await a.post("/workspaces/".concat(e,"/github-installations"),{github_installation_id:s.id})},onSuccess:async(s,a)=>{let n=ti.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:[...r.installations,a.githubInstallation]}),eU.Am.success("Added GitHub Organization",{description:"You can now transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,tx.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:ti.E.workspaceGithubInstallations(e)})}});return{addGithubTarget:s,isAddGithubTargetLoading:a}},sI=e=>{let t=(0,e6.NL)(),{mutate:s,isPending:a}=(0,th.D)({mutationFn:async t=>{let{githubInstallation:s}=t;return(0,g.SJ)().delete("/workspaces/".concat(e,"/github-installations/").concat(s.id))},onSuccess:async(s,a)=>{let n=ti.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:r.installations.filter(e=>e.id!==a.githubInstallation.id)}),eU.Am.success("Removed GitHub Organization",{description:"You can no longer transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,tx.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:ti.E.workspaceGithubInstallations(e)})}});return{deleteGithubTarget:s,isDeleteGithubTargetLoading:a}},sD=e=>{let{setStep:t,installations:s,workspaceInstallations:a,workspace:n}=e,r=a.filter(e=>!s.some(t=>t.id===e.id)),{addGithubTarget:i,isAddGithubTargetLoading:o}=sA(n.id),c=e=>{i({githubInstallation:e})},{deleteGithubTarget:d,isDeleteGithubTargetLoading:u}=sI(n.id),m=e=>{d({githubInstallation:e})},p=a.length>0;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sS,{title:"Link your workspace to GitHub",description:"Anyone in your Lovable workspace can add Lovable projects to GitHub organizations.",badge:"admin"}),(0,l.jsx)(e9.Separator,{}),(0,l.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,l.jsx)(sE,{workspace:n}),(0,l.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>{let t=a.find(t=>t.id===e.id);return(0,l.jsx)(sO,{installation:e,workspaceInstallation:t,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id)}),r.length>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Other users have added the following organizations:"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"If unlinked, you can not add them back."}),(0,l.jsx)("div",{className:"flex flex-col gap-2",children:r.map(e=>(0,l.jsx)(sO,{installation:e,workspaceInstallation:e,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id))})]})}),(0,l.jsx)(j.z,{variant:s.length>0?"outline":"default",size:"sm",onClick:()=>(0,sm.Mn)({githubOwner:null,workspaceId:n.id}),className:"mt-auto",children:"Add Organizations"})]})]}),(0,l.jsx)(e9.Separator,{}),(0,l.jsx)(sC,{children:(0,l.jsx)(td.b,{tooltipContent:"Please add and enable at least one organization to continue.",showTooltip:!p,className:"ml-auto",children:(0,l.jsx)(j.z,{disabled:!p,onClick:()=>t("transfer"),size:"sm",className:"ml-auto",children:"Continue"})})})]})},sO=e=>{let{installation:t,workspaceInstallation:s,addWorkspaceInstallation:a,disabled:n,deleteGithubTarget:r}=e,i=(null==s?void 0:s.id)===t.id;return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(sz.qE,{className:"h-7 w-7 border",children:(0,l.jsx)(sz.F$,{src:t.account.avatar_url})}),(0,l.jsx)("span",{className:"font-medium",children:t.account.login})]}),(0,l.jsx)(tn.r,{disabled:n,onCheckedChange:e=>{e?a(t):r(t)},checked:i})]})};var sP=s(35974);let sT=e=>{let{setStep:t,installations:s,isTransferProjectLoading:a,isWorkspaceAdmin:n,onTransfer:r}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sS,{title:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync."}),(0,l.jsx)(e9.Separator,{}),(0,l.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>(0,l.jsx)(sL,{installation:e,disabled:a||!n&&!!e.suspended_at,onTransfer:r,isWorkspaceAdmin:n,isLoading:a},e.account.login))]}),(0,l.jsx)(e9.Separator,{}),(0,l.jsx)(sC,{children:(0,l.jsx)(j.z,{disabled:a,variant:"secondary",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},sL=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n,isLoading:r}=e,[i,c]=(0,o.useState)(!1),d=r&&i;return(0,l.jsxs)("div",{className:"flex w-full items-center justify-start gap-2",children:[(0,l.jsx)(sz.qE,{className:"h-7 w-7 border",children:(0,l.jsx)(sz.F$,{src:t.account.avatar_url})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("p",{className:"truncate font-medium",children:t.account.login}),t.suspended_at&&(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)("div",{className:"",children:(0,l.jsx)(sP.C,{className:"inline",variant:"destructive",children:"Suspended"})})}),(0,l.jsx)(ev._v,{children:n?(0,l.jsx)("p",{children:"This account is suspended. Reconnect to continue."}):(0,l.jsx)("p",{children:"This account is suspended. Talk to your workspace owner to reconnect."})})]})]}),(0,l.jsx)(j.z,{onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t),c(!0)},disabled:s,className:"ml-auto",size:"sm",variant:t.suspended_at?"outline":"default",loading:d,children:t.suspended_at?"Reconnect":d?"Connecting":"Connect"})]},t.account.login)},sR=e=>{let{isTransferProjectLoading:t,installations:s,isWorkspaceAdmin:a,onTransfer:n,showConnectDialog:r,setShowConnectDialog:i,workspace:c}=e,{installations:d}=sd(c.id),[u,m]=(0,o.useState)("organizations");return(0,l.jsxs)(ty.Vq,{open:r,onOpenChange:e=>{e||m("organizations"),i(e)},children:[(0,l.jsx)(ty.hg,{asChild:!0,className:"hidden",children:(0,l.jsx)(j.z,{size:"sm",children:"Connect Project"})}),(0,l.jsx)(sk,{children:"organizations"===u?(0,l.jsx)(sD,{setStep:m,installations:null!=s?s:[],workspaceInstallations:null!=d?d:[],workspace:c}):(0,l.jsx)(sT,{setStep:m,installations:null!=d?d:[],isTransferProjectLoading:t,isWorkspaceAdmin:a,onTransfer:n})})]})};var sF=s(26237);let sZ=e=>{let{isTransferProjectLoading:t,workspaceInstallations:s,onTransfer:a,isWorkspaceAdmin:n,setShowConnectDialog:r}=e,i=(0,y.Z)("md"),c=(0,sF.C)(),[d,u]=(0,o.useState)(!1),m=(null==s?void 0:s.length)===0,{disabled:p,disabledReason:h}=(0,o.useMemo)(()=>c?{disabled:!0,disabledReason:"Cannot transfer project while there is an active operation in progress."}:!n&&m?{disabled:!0,disabledReason:"Ask a workspace admin to add GitHub Organizations."}:{disabled:!1,disabledReason:null},[c,n,m]);return(0,l.jsxs)(v.h_,{open:d,onOpenChange:e=>{m?r(!0):u(e)},children:[(0,l.jsx)(td.b,{showTooltip:p,tooltipContent:h,children:(0,l.jsx)(v.$F,{asChild:!0,children:(0,l.jsx)(j.z,{disabled:p,className:"justify-start",size:"sm",loading:t,children:t?"Connecting":(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tT.xR.GitHub,{className:"h-4 w-4"}),"Connect Project"]})})})}),(0,l.jsxs)(v.AW,{className:"min-w-[200px]",align:i?"start":"end",children:[(0,l.jsx)(v.Ju,{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),null==s?void 0:s.map(e=>(0,l.jsx)(sM,{installation:e,disabled:t||!n&&!!e.suspended_at,onTransfer:a,isWorkspaceAdmin:n},e.account.login)),(0,l.jsx)(td.b,{showTooltip:!n,tooltipContent:"Only workspace admins can add organizations.",side:"left",instant:!0,children:(0,l.jsxs)(v.Xi,{disabled:!n,onClick:()=>r(!0),children:[(0,l.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border bg-background",children:(0,l.jsx)(b.Z,{name:"add",size:"small"})}),m?"Add Organization":"Manage Organizations",(0,l.jsx)(s_.p,{badge:"admin",className:"flex md:hidden"})]})})]})]})},sM=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n}=e;return(0,l.jsx)(td.b,{showTooltip:!!t.suspended_at,tooltipContent:n?"This account is suspended. Click to reconnect.":"This account is suspended. Talk to your workspace owner to reconnect.",side:"left",children:(0,l.jsxs)(v.Xi,{className:"flex w-full items-center justify-start gap-2",onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t)},disabled:s,children:[(0,l.jsx)(sz.qE,{className:"h-6 w-6 border",children:(0,l.jsx)(sz.F$,{src:t.account.avatar_url})}),(0,l.jsx)("p",{className:"truncate text-sm font-medium",children:t.account.login}),t.suspended_at&&(0,l.jsx)(sP.C,{className:"inline",variant:"destructive",children:"Suspended"})]},t.account.login)})};var sU=s(65666);let sq=e=>{let t=(0,sU.D)(),{mutate:s,isPending:a}=(0,th.D)({mutationFn:async e=>{let s={new_owner:{id:e.account.id,name:e.account.login,type:e.target_type}},a=(0,g.SJ)();return await a.post("/projects/".concat(t,"/github/transfer"),s)},onSuccess:async(t,s)=>{eU.Am.success("A GitHub Repository is now under your account ".concat(s.account.login),{description:t.new_repo_url,action:(0,l.jsx)(j.z,{size:"sm",asChild:!0,children:(0,l.jsx)("a",{target:"_blank",href:t.new_repo_url,children:"View"})}),duration:2e4}),null==e||e()},onError:e=>{(0,tx.Eo)(e)}});return{transferProject:s,isTransferProjectLoading:a}},sW=e=>{let{isWorkspaceAdmin:t,workspace:s,showConnectDialog:a,setShowConnectDialog:n}=e,{transferProject:r,isTransferProjectLoading:i}=sq(()=>{n(!1)}),o=e=>{r(e)},{installations:c}=(0,so.D)({enabled:null!=t&&t}),{installations:d}=sd(s.id);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sZ,{isTransferProjectLoading:i,workspaceInstallations:null!=d?d:[],onTransfer:o,isWorkspaceAdmin:t,setShowConnectDialog:n}),(0,l.jsx)(sR,{installations:c,isTransferProjectLoading:i,isWorkspaceAdmin:t,onTransfer:o,setShowConnectDialog:n,showConnectDialog:a,workspace:s})]})};var sK=s(27058);let sJ=e=>{let{githubRepoName:t,workspace:s,isWorkspaceAdmin:a,showConnectDialog:n,setShowConnectDialog:r}=e;return t?(0,l.jsx)(eG.P,{label:"Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,l.jsx)(sK.H,{status:"connected"}),children:(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)(j.z,{asChild:!0,variant:"outline",size:"sm",children:(0,l.jsxs)(eZ.default,{href:"https://github.com/".concat(t),target:"_blank",rel:"noopener noreferrer",children:["View on GitHub",(0,l.jsx)(b.Z,{size:"small",name:"arrow_outward",className:"ml-auto"})]})})})}):(0,l.jsx)(eG.P,{label:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,l.jsx)(sK.H,{status:"not-connected"}),children:(0,l.jsx)(sW,{isWorkspaceAdmin:a,workspace:s,showConnectDialog:n,setShowConnectDialog:r})})},sG=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1);return(0,l.jsxs)(p.tM,{value:"github",title:"GitHub",description:"Sync your project 2-way with GitHub to collaborate at source.",docsLink:"https://docs.lovable.dev/integrations/git-integration",children:[s&&(0,l.jsx)(sB,{workspace:t,myWorkspaceRole:a,showConnectDialog:n,setShowConnectDialog:r}),(0,l.jsx)(sV,{myWorkspaceRole:a,setShowConnectDialog:r,isInsideEditor:s})]})},sV=e=>{var t,s;let{myWorkspaceRole:a,setShowConnectDialog:n,isInsideEditor:r}=e,i="admin"===a||"owner"===a,{hasValidAccessToken:o,isLoading:c}=(0,so.D)({enabled:null!=i&&i}),{userData:d}=(0,eW.SE)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(sp,{isLoading:c||!d,hasAccessToken:!!(null==d?void 0:null===(t=d.github)||void 0===t?void 0:t.new_encrypted_access_token),githubUsername:null==d?void 0:null===(s=d.github)||void 0===s?void 0:s.username,hasValidAccessToken:null!=o&&o,onGithubConnected:()=>{r&&n(!0)},isWorkspaceAdmin:i})})};function sB(e){var t,s,a,n,r;let{workspace:i,myWorkspaceRole:o,showConnectDialog:c,setShowConnectDialog:d}=e,u=(0,e4.iZ)(e=>e.project),{installations:m}=sd(i.id),{userData:p}=(0,eW.SE)(),h=null===(t=(0,tL.G)().features)||void 0===t?void 0:t.git_branch_switching;if(!u)return null;let x=(null==u?void 0:null===(s=u.github_owner)||void 0===s?void 0:s.name)!==sl.aR,g=(null==p?void 0:null===(a=p.github)||void 0===a?void 0:a.new_encrypted_access_token)!==null&&(null==p?void 0:null===(n=p.github)||void 0===n?void 0:n.new_encrypted_access_token)!==void 0;return(0,l.jsxs)(l.Fragment,{children:[(g||m&&(null==m?void 0:m.length)>0)&&(0,l.jsx)(sJ,{isWorkspaceAdmin:!!("admin"===o||"owner"===o),workspace:i,githubRepoName:x&&(null==u?void 0:u.github_repo_name)&&(null===(r=u.github_owner)||void 0===r?void 0:r.name)?"".concat(u.github_owner.name,"/").concat(u.github_repo_name):void 0,showConnectDialog:c,setShowConnectDialog:d}),x&&(0,l.jsx)(sN,{project:u}),x&&h&&(0,l.jsx)(sj,{mainBranch:u.main_branch||"main",projectId:u.id})]})}var sH=s(59709),sY=s(65613);let sQ=e=>{var t,s;let{workspace:a,open:n,onOpenChange:r,shouldRefreshAfterOAuth:i,onRefreshComplete:c}=e,[d,u]=(0,o.useState)(""),[m,p]=(0,o.useState)(""),[h,x]=(0,o.useState)(null),[f,v]=(0,o.useState)(!1),[y,w]=(0,o.useState)(!1),[N,_]=(0,o.useState)(""),[k,S]=(0,o.useState)(!1),[C,E]=(0,o.useState)(null),z=(0,e6.NL)(),A=(0,th.D)({mutationFn:async e=>{let t=await (0,g.SJ)();return await t.post("/workspaces/".concat(a.id,"/integrations/mcp/test"),{...(null==e?void 0:e.serverId)?{server_id:e.serverId}:{url:m,...N&&{manual_token:N}}})},onSuccess:e=>{if(x(e),e.success){var t;eU.Am.success("Connected! Found ".concat((null===(t=e.tools)||void 0===t?void 0:t.length)||0," tools"))}else e.requires_oauth?eU.Am.info("This server requires OAuth authentication"):eU.Am.error(e.error||"Connection failed")},onError:e=>{var t,s,a,n;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to test connection"),x({success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.error)||"Failed to test connection"})}}),I=(0,th.D)({mutationFn:async()=>{let e=await (0,g.SJ)();if(k&&C)return console.log("[AddMCPServerDialog] OAuth server already created:",C.server_id),{alreadyCreated:!0};await e.post("/workspaces/".concat(a.id,"/integrations/connect"),{type:"mcp",name:d,url:m,...N&&{manual_token:N}})},onSuccess:()=>{z.invalidateQueries({queryKey:["mcp-servers",a.id]}),eU.Am.success("MCP server added successfully"),r(!1),u(""),p(""),x(null),_(""),w(!1),S(!1),E(null)},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to add MCP server")}}),D=(0,th.D)({mutationFn:async()=>{let e=await (0,g.SJ)();return await e.post("/workspaces/".concat(a.id,"/integrations/mcp/oauth/start"),{name:d,url:m,redirect_uri:"".concat(window.location.origin,"/mcp-callback")})},onSuccess:e=>{let t="".concat(window.location.origin,"/mcp-callback"),s={workspaceId:a.id,serverId:e.server_id,codeVerifier:e.code_verifier,redirectUri:t};E({server_id:e.server_id,name:d,url:m}),console.log("[OAuth Debug] Storing OAuth data in localStorage:",s),localStorage.setItem(sH.G,JSON.stringify(s)),console.log("[OAuth Debug] Verified stored data:",localStorage.getItem(sH.G)),console.log("[OAuth Debug] All localStorage keys:",Object.keys(localStorage)),console.log("[OAuth Debug] Opening OAuth window with URL:",e.authorization_url);let n=window.open(e.authorization_url,"_blank","width=600,height=700,left=200,top=100");n?n.focus():window.location.href=e.authorization_url,n&&setTimeout(()=>{n.closed&&console.error("[OAuth Debug] OAuth window closed within 1 second - possible redirect or error")},1e3)},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to start OAuth flow")}});(0,o.useEffect)(()=>{i&&C&&(console.log("[AddMCPServerDialog] Testing connection after OAuth success"),S(!0),A.mutate({serverId:C.server_id}),null==c||c())},[i,C,A,c]);let O=()=>{r(!1),setTimeout(()=>{u(""),p(""),x(null),v(!1),_(""),w(!1),S(!1),E(null)},200)};return(0,l.jsx)(ty.Vq,{open:n,onOpenChange:O,children:(0,l.jsx)(ty.cZ,{className:"sm:max-w-[525px]",children:(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!m.trim()){eU.Am.error("Please fill in all fields");return}if(!(null==h?void 0:h.success)&&!k){eU.Am.error("Please test the connection first");return}I.mutate()},children:[(0,l.jsxs)(ty.fK,{children:[(0,l.jsx)(ty.$N,{children:"Add MCP Server"}),(0,l.jsx)(ty.Be,{children:"Connect to a remote MCP server to extend the AI's capabilities."})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"grid gap-2",children:[(0,l.jsx)(se.Label,{htmlFor:"name",children:"Server Name"}),(0,l.jsx)(tV.I,{id:"name",placeholder:"My MCP Server",value:d,onChange:e=>u(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:"grid gap-2",children:[(0,l.jsx)(se.Label,{htmlFor:"url",children:"Server URL"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(tV.I,{id:"url",type:"url",placeholder:"https://mcp.example.com",value:m,onChange:e=>{p(e.target.value),x(null)},required:!0,className:"flex-1"}),(0,l.jsx)(j.z,{type:"button",variant:"secondary",onClick:()=>{if(!m.trim()){eU.Am.error("Please enter a URL");return}x(null),A.mutate(void 0)},disabled:A.isPending||!m.trim(),children:A.isPending?"Testing...":"Test"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)(j.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>w(!y),className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground",children:[(0,l.jsx)(b.Z,{name:y?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"}),"Advanced Settings"]}),y&&(0,l.jsx)("div",{className:"grid gap-2 pl-6",children:(0,l.jsxs)("div",{className:"grid gap-2",children:[(0,l.jsx)(se.Label,{htmlFor:"manual-token",children:"Bearer Token (Optional)"}),(0,l.jsx)(tV.I,{id:"manual-token",type:"password",placeholder:"Enter Bearer token or API key",value:N,onChange:e=>{_(e.target.value),x(null)}}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Some MCP servers use API keys as Bearer tokens instead of OAuth. If your server requires a token, enter it here."})]})})]}),A.isPending&&(0,l.jsx)("div",{className:"rounded-lg border p-4",children:(0,l.jsx)(sg.T,{text:"Testing connection..."})}),h&&!A.isPending&&(0,l.jsxs)(sY.bZ,{className:(0,U.cn)("transition-all",h.success||k?"border-green-600/20 bg-green-50/50 dark:bg-green-950/20":h.requires_oauth?"border-blue-600/20 bg-blue-50/50 dark:bg-blue-950/20":"border-destructive/20 bg-destructive/5"),children:[(0,l.jsx)(b.Z,{name:h.success||k?"check_circle":h.requires_oauth?"lock":"error",className:(0,U.cn)("h-4 w-4",h.success||k?"text-green-600":h.requires_oauth?"text-blue-600":"text-destructive")}),(0,l.jsxs)(sY.X,{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"flex-1",children:h.success?k?"OAuth authenticated successfully! Found ".concat((null===(t=h.tools)||void 0===t?void 0:t.length)||0," tools"):"Connection successful! Found ".concat((null===(s=h.tools)||void 0===s?void 0:s.length)||0," tools"):h.requires_oauth?"This server requires OAuth authentication":h.error||"Connection failed"}),h.success&&h.tools&&h.tools.length>0&&!k&&(0,l.jsx)(j.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>v(!f),children:(0,l.jsx)(b.Z,{name:f?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),h.requires_oauth&&(0,l.jsx)(j.z,{type:"button",size:"sm",onClick:()=>{if(!d.trim()||!m.trim()){eU.Am.error("Please fill in server name and URL first");return}D.mutate()},disabled:D.isPending,children:D.isPending?"Starting...":"Authorize"})]})]}),(null==h?void 0:h.success)&&h.tools&&f&&!k&&(0,l.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded-lg border p-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("h4",{className:"mb-2 text-sm font-medium",children:["Available Tools (",h.tools.length,")"]}),h.tools.map((e,t)=>(0,l.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))]})})]}),(0,l.jsxs)(ty.cN,{children:[(0,l.jsx)(j.z,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),(0,l.jsx)(j.z,{type:"submit",disabled:I.isPending||!(null==h?void 0:h.success)&&!k,children:I.isPending?"Adding...":"Add Server"})]})]})})})},sX=e=>{let{workspace:t,isWorkspaceAdmin:s,shouldRefresh:a,onRefreshComplete:n}=e,r=(0,e6.NL)(),[i,c]=(0,o.useState)(new Set);(0,o.useEffect)(()=>{a&&(r.invalidateQueries({queryKey:["mcp-servers",t.id]}),null==n||n())},[a,t.id,r,n]);let d=e=>{let t=new Set(i);t.has(e)?t.delete(e):t.add(e),c(t)},{data:u,isLoading:m}=(0,x.a)({queryKey:["mcp-servers",t.id],queryFn:async()=>{let e=await (0,g.SJ)();return(await e.get("/workspaces/".concat(t.id,"/integrations/mcp"))).servers||[]}}),p=(0,th.D)({mutationFn:async e=>{let s=await (0,g.SJ)();await s.delete("/workspaces/".concat(t.id,"/integrations/mcp/").concat(e))},onSuccess:()=>{r.invalidateQueries({queryKey:["mcp-servers",t.id]}),eU.Am.success("MCP server removed successfully")},onError:()=>{eU.Am.error("Failed to remove MCP server")}});return m?(0,l.jsx)("div",{className:"flex justify-center py-8",children:(0,l.jsx)(sg.T,{text:"Loading MCP servers..."})}):u&&0!==u.length?(0,l.jsx)("div",{className:"space-y-4",children:u.map(e=>{let t=i.has(e.id),a=e.tools&&e.tools.length>0;return(0,l.jsxs)("div",{className:"overflow-hidden rounded-lg border",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,l.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,l.jsx)(b.Z,{name:"cloud",className:"h-5 w-5 flex-shrink-0 text-muted-foreground"}),(0,l.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,l.jsx)("p",{className:"font-medium",children:e.name}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)("span",{className:"truncate",children:e.url}),a&&(0,l.jsxs)("span",{className:"flex-shrink-0",children:["• ",e.tools.length," tools"]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,l.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>d(e.id),children:(0,l.jsx)(b.Z,{name:t?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),s&&(0,l.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>p.mutate(e.id),disabled:p.isPending,children:(0,l.jsx)(b.Z,{name:"delete"})})]})]}),t&&a&&(0,l.jsx)("div",{className:"border-t bg-muted/30 px-4 py-3",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h5",{className:"mb-2 text-sm font-medium",children:"Available Tools"}),(0,l.jsx)("div",{className:"space-y-1",children:e.tools.map((e,t)=>(0,l.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,l.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))})]})})]},e.id)})}):(0,l.jsxs)("div",{className:"rounded-lg border border-dashed p-8 text-center",children:[(0,l.jsx)(b.Z,{name:"cloud",className:"mx-auto h-12 w-12 text-muted-foreground/50"}),(0,l.jsx)("h3",{className:"mt-4 text-sm font-medium",children:"No MCP servers connected"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first MCP server connection."})]})},s$=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1),[i,c]=(0,o.useState)(!1),d="admin"===a||"owner"===a,u=(0,o.useCallback)(()=>{console.log("[MCPTab] OAuth success, dialog stays open to show tools"),c(!0)},[]);return(0,sH.d)({workspaceId:t.id,onConnectSuccess:u}),(0,l.jsxs)(p.tM,{value:"mcp",title:"MCP",description:"Connect to Model Context Protocol servers for enhanced AI capabilities.",docsLink:"https://docs.lovable.dev/integrations/mcp",children:[(0,l.jsx)(sQ,{workspace:t,open:n,onOpenChange:r,shouldRefreshAfterOAuth:i,onRefreshComplete:()=>c(!1)}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"rounded-lg border p-6",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:"MCP Servers"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Connect to remote MCP servers to extend the AI's capabilities with custom tools and integrations."})]}),d&&(0,l.jsx)(j.z,{onClick:()=>r(!0),className:"w-full sm:w-auto",children:"Add MCP Server"})]})}),(0,l.jsx)(sX,{workspace:t,isWorkspaceAdmin:d,shouldRefresh:i,onRefreshComplete:()=>c(!1)})]})]})},s0=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a,project:n}=e,[r,i]=(0,o.useState)([]),[c,d]=(0,o.useState)(!1),u=(0,sF.C)(),[m,h]=(0,o.useState)(!1),[x,f]=(0,o.useState)(null),[v,y]=(0,o.useState)({}),[w,N]=(0,o.useState)(""),[_,k]=(0,o.useState)("");(0,o.useEffect)(()=>{(null==n?void 0:n.id)&&S()},[null==n?void 0:n.id]);let S=async()=>{if(null==n?void 0:n.id){d(!0);try{let e=(0,g.SJ)(),t=(await e.get("/projects/".concat(n.id,"/integrations/memory"))||[]).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());i(t)}catch(e){console.error("Failed to load memories:",e),eU.Am.error("Failed to load memories")}finally{d(!1)}}},C=async e=>{if(null==n?void 0:n.id)try{let t=(0,g.SJ)();await t.post("/projects/".concat(n.id,"/integrations/memory"),e);let s=e.sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());i(s),eU.Am.success("Memories updated successfully")}catch(e){throw console.error("Failed to save memories:",e),eU.Am.error("Failed to save memories"),e}},E=async()=>{if(!w||!_){eU.Am.error("Path and content are required");return}if(r.some(e=>e.path===w)){eU.Am.error("A memory with this path already exists");return}let e={path:w,content:_,updated_at:new Date().toISOString()};try{await C([...r,e]),N(""),k("")}catch(e){}},z=e=>{y({[e.path]:{path:e.path,content:e.content,originalPath:e.path,originalContent:e.content}})},A=e=>{let t=v[e];return!!t&&(t.path!==t.originalPath||t.content!==t.originalContent)},I=async e=>{let t=v[e];if(t){if(t.path!==e&&r.some(e=>e.path===t.path)){eU.Am.error("A memory with this path already exists");return}try{let s=r.map(s=>s.path===e?{path:t.path,content:t.content,updated_at:new Date().toISOString()}:s);await C(s);let a={...v};delete a[e],y(a)}catch(e){}}},D=e=>{let t={...v};delete t[e],y(t)},O=async()=>{if(x)try{let e=r.filter(e=>e.path!==x);await C(e),f(null),h(!1)}catch(e){}};return(0,l.jsx)(ev.pn,{children:(0,l.jsx)(p.tM,{value:"memory",title:"Memory",description:"Manage memory files that help Lovable remember important context about your project.",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,l.jsx)(tV.I,{placeholder:"Untitled Memory",value:w,onChange:e=>N(e.target.value),disabled:u,className:"h-10 rounded-b-none font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,l.jsx)(e1.g,{placeholder:"Remember that...",className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0",value:_,onChange:e=>k(e.target.value),disabled:u})]}),(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)("span",{className:"cursor-not-allowed",children:(0,l.jsx)(j.z,{size:"icon-sm",variant:"ghost",disabled:u||!w||!_,onClick:E,children:(0,l.jsx)(b.Z,{name:"add_2",size:"default"})})})}),(0,l.jsx)(ev._v,{children:u?"Wait for Lovable to finish working":"Add a title and content to save the memory"})]})]}),c?(0,l.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,l.jsx)(b.Z,{name:"progress_activity",className:"h-6 w-6 animate-spin"}),(0,l.jsx)("span",{className:"ml-2",children:"Loading memories..."})]}):(0,l.jsx)(l.Fragment,{children:r.map(e=>{var t,s;let a=v[e.path],n=null!==(t=null==a?void 0:a.path)&&void 0!==t?t:e.path,r=null!==(s=null==a?void 0:a.content)&&void 0!==s?s:e.content;return(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,l.jsx)(tV.I,{value:n,onChange:a?t=>y({...v,[e.path]:{...v[e.path],path:t.target.value}}):void 0,className:"h-10 rounded-b-none font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:u,readOnly:!a,onClick:()=>!u&&!a&&z(e)}),(0,l.jsx)(e1.g,{value:r,onChange:a?t=>y({...v,[e.path]:{...v[e.path],content:t.target.value}}):void 0,className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:u,readOnly:!a,onClick:()=>!u&&!a&&z(e)})]}),a&&A(e.path)?(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>I(e.path),disabled:u,children:(0,l.jsx)(b.Z,{name:"check",size:"default"})})}),(0,l.jsx)(ev._v,{children:u?"Wait for Lovable to finish working":"Save changes"})]}),(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>D(e.path),disabled:u,children:(0,l.jsx)(b.Z,{name:"close",size:"default"})})}),(0,l.jsx)(ev._v,{children:u?"Wait for Lovable to finish working":"Discard changes"})]})]}):(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>{f(e.path),h(!0)},disabled:u,children:(0,l.jsx)(b.Z,{name:"delete",size:"default"})})}),(0,l.jsx)(ev._v,{children:u?"Can't delete memories while Lovable is working":"Delete memory"})]})]},e.path)})}),(0,l.jsx)(ty.Vq,{open:m,onOpenChange:h,children:(0,l.jsxs)(ty.cZ,{children:[(0,l.jsxs)(ty.fK,{children:[(0,l.jsx)(ty.$N,{children:"Delete Memory"}),(0,l.jsxs)(ty.Be,{children:['Are you sure you want to delete "',x,'"? This action cannot be undone.']})]}),(0,l.jsxs)(ty.cN,{children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),(0,l.jsx)(j.z,{variant:"destructive",onClick:O,children:"Delete"})]})]})})]})})})};var s1=s(50091),s2=s(84428),s4=s(88906),s5=s(95805),s6=s(26748),s3=s(68920),s8=s(25846),s7=s(75403),s9=s(68959),ae=s(10407);let at=(0,o.createContext)(void 0);function as(e){let{children:t,onStackEmpty:s,initialStack:a=[]}=e,[n,r]=(0,o.useState)(a),i=(0,o.useCallback)(e=>{r(t=>[...t,e])},[]),c=(0,o.useCallback)(()=>{r(e=>{let t=e.slice(0,-1);return 0===t.length&&(null==s||s()),t})},[s]),d=(0,o.useCallback)(e=>{e<0||r(t=>t.slice(0,e+1))},[]),u=(0,o.useCallback)(()=>{r([]),null==s||s()},[s]),m=(0,o.useMemo)(()=>({stack:n,push:i,pop:c,popTo:d,reset:u}),[n,i,c,d,u]);return(0,l.jsx)(at.Provider,{value:m,children:t})}function aa(){let e=(0,o.useContext)(at);if(void 0===e)throw Error("useSheetNavigation must be used within a SheetNavigationProvider");return e}function an(e){let{isMobile:t,children:s,navigationItems:a}=e,{stack:n,push:r,popTo:i,reset:o}=aa(),c=(e,t)=>{(1!==n.length||n[0].title!==e)&&(o(),r({title:e,component:t}))},d=n[n.length-1],u=n.length>0?n[0].title:null;return t?(0,l.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,l.jsx)("div",{className:"grow overflow-y-auto",children:d?d.component:s})}),(0,l.jsx)("div",{className:"border-t bg-background",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsx)("div",{className:"flex min-w-max gap-1 p-2",children:a.map(e=>{let t=e.icon;return(0,l.jsxs)(j.z,{variant:u===e.title?"secondary":"ghost",className:"h-16 w-20 min-w-16 flex-col gap-1 px-2 text-xs",onClick:()=>c(e.title,e.component),children:[(0,l.jsx)(t,{className:"h-5 w-5"}),(0,l.jsx)("span",{className:"text-center text-[10px] leading-tight",children:"Auth"===e.title?"Auth":e.title})]},e.title)})})})})]}):(0,l.jsx)("div",{className:"flex h-full w-full",children:(0,l.jsxs)("div",{className:"flex h-full w-full flex-col",children:[n.length>0&&(0,l.jsxs)("div",{className:"relative flex shrink-0 items-center border-b pb-2",children:[(0,l.jsxs)(j.z,{variant:"ghost",size:"icon",className:"relative z-10 h-8 w-8",onClick:()=>n.length>1?i(n.length-2):o(),children:[(0,l.jsx)(s9.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Back"})]}),(0,l.jsx)("div",{className:"relative z-10 ml-2 flex items-center gap-1.5 text-sm text-muted-foreground",children:n.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[t>0&&(0,l.jsx)(ae.Z,{className:"h-3 w-3"}),t===n.length-1?(0,l.jsx)("span",{className:"text-foreground",children:e.title}):(0,l.jsx)("button",{onClick:()=>i(t),className:"hover:underline",children:e.title})]},"".concat(e.title,"-").concat(t)))})]}),(0,l.jsx)("div",{className:"grow pb-12",children:d?d.component:s})]})})}var ar=s(43246),ai=s(80733),al=s(45008),ao=s(87057);function ac(){let e=(0,al._)(["\n    with\n      tables as (","),\n      columns as (",")\n    select\n      *,\n      ","\n    from tables\n  "]);return ac=function(){return e},e}function ad(){let e=(0,al._)(["\n    COALESCE(\n      (\n        SELECT\n          array_agg(row_to_json(",")) FILTER (WHERE ",")\n        FROM\n          ","\n      ),\n      '{}'\n    ) AS ","\n  "]);return ad=function(){return e},e}let au=["information_schema","pg_catalog","pg_toast","_timescaledb_internal"],am=(e,t)=>(0,ao.Pn)(ad(),e,t,e,e),ap=()=>{let[e,t]=(0,o.useState)(ai.g.serverIdToken),[s,a]=(0,o.useState)(ai.g.isInitialized());return(0,o.useEffect)(()=>{let n=setInterval(()=>{let n=ai.g.serverIdToken,r=ai.g.isInitialized();n!==e&&t(n),r!==s&&a(r)},100);return()=>clearInterval(n)},[e,s]),{token:e,isInitialized:s}},ah=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/config/auth",{params:{path:{ref:e}}});if(a)throw a;return s},ax=e=>{let t=ag();return(0,x.a)({queryKey:["auth-config",e],queryFn:()=>ah(e,t),enabled:!!e&&!!t,retry:!1})},ag=()=>{let e=(0,e4.iZ)(e=>e.projectId),{isAuthenticated:t}=(0,d.Eu)(),{token:s,isInitialized:a}=ap();return(0,o.useMemo)(()=>s&&t&&a?(0,ar.ZP)({baseUrl:"".concat("https://lovable-api.com","/projects/").concat(e,"/db-proxy"),headers:{Authorization:"Bearer ".concat(s)}}):null,[e,t,s,a])},af=async e=>{let{projectRef:t,payload:s,dbClient:a}=e,{data:n,error:r}=await a.PATCH("/v1/projects/{ref}/config/auth",{params:{path:{ref:t}},body:s});if(r)throw r;return n},aj=()=>{let e=(0,e6.NL)(),t=ag();return(0,th.D)({mutationFn:e=>{let{projectRef:s,payload:a}=e;if(!t)throw Error("Database client not available");return af({projectRef:s,payload:a,dbClient:t})},onSuccess:(t,s)=>{eU.Am.success("Auth config updated."),e.invalidateQueries({queryKey:["auth-config",s.projectRef]})},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"There was a problem with your request.")}})},av=async e=>{let{projectRef:t,query:s,readOnly:a,dbClient:n}=e,{data:r,error:i}=await n.POST("/v1/projects/{ref}/database/query",{params:{path:{ref:t}},body:{query:s,read_only:a}});if(i)throw i;return r},ab=()=>{let e=ag();return(0,th.D)({mutationFn:t=>{let{projectRef:s,query:a,readOnly:n}=t;if(!e)throw Error("Database client not available");return av({projectRef:s,query:a,readOnly:n,dbClient:e})},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"There was a problem with your query.")}})},ay=e=>{let{projectRef:t,schemas:s,dbClient:a}=e;return av({projectRef:t,query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,ao.Pn)(ac(),"\nSELECT\n  c.oid :: int8 AS id,\n  nc.nspname AS schema,\n  c.relname AS name,\n  c.relrowsecurity AS rls_enabled,\n  c.relforcerowsecurity AS rls_forced,\n  CASE\n    WHEN c.relreplident = 'd' THEN 'DEFAULT'\n    WHEN c.relreplident = 'i' THEN 'INDEX'\n    WHEN c.relreplident = 'f' THEN 'FULL'\n    ELSE 'NOTHING'\n  END AS replica_identity,\n  pg_total_relation_size(format('%I.%I', nc.nspname, c.relname)) :: int8 AS bytes,\n  pg_size_pretty(\n    pg_total_relation_size(format('%I.%I', nc.nspname, c.relname))\n  ) AS size,\n  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,\n  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,\n  obj_description(c.oid) AS comment,\n  coalesce(pk.primary_keys, '[]') as primary_keys,\n  coalesce(\n    jsonb_agg(relationships) filter (where relationships is not null),\n    '[]'\n  ) as relationships\nFROM\n  pg_namespace nc\n  JOIN pg_class c ON nc.oid = c.relnamespace\n  left join (\n    select\n      table_id,\n      jsonb_agg(_pk.*) as primary_keys\n    from (\n      select\n        n.nspname as schema,\n        c.relname as table_name,\n        a.attname as name,\n        c.oid :: int8 as table_id\n      from\n        pg_index i,\n        pg_class c,\n        pg_attribute a,\n        pg_namespace n\n      where\n        i.indrelid = c.oid\n        and c.relnamespace = n.oid\n        and a.attrelid = c.oid\n        and a.attnum = any (i.indkey)\n        and i.indisprimary\n    ) as _pk\n    group by table_id\n  ) as pk\n  on pk.table_id = c.oid\n  left join (\n    select\n      c.oid :: int8 as id,\n      c.conname as constraint_name,\n      nsa.nspname as source_schema,\n      csa.relname as source_table_name,\n      sa.attname as source_column_name,\n      nta.nspname as target_table_schema,\n      cta.relname as target_table_name,\n      ta.attname as target_column_name\n    from\n      pg_constraint c\n    join (\n      pg_attribute sa\n      join pg_class csa on sa.attrelid = csa.oid\n      join pg_namespace nsa on csa.relnamespace = nsa.oid\n    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)\n    join (\n      pg_attribute ta\n      join pg_class cta on ta.attrelid = cta.oid\n      join pg_namespace nta on cta.relnamespace = nta.oid\n    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)\n    where\n      c.contype = 'f'\n  ) as relationships\n  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)\n  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)\nWHERE\n  c.relkind IN ('r', 'p')\n  AND NOT pg_is_other_temp_schema(nc.oid)\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n    )\n    OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  c.relname,\n  c.relrowsecurity,\n  c.relforcerowsecurity,\n  c.relreplident,\n  nc.nspname,\n  pk.primary_keys\n","\n-- Adapted from information_schema.columns\n\nSELECT\n  c.oid :: int8 AS table_id,\n  nc.nspname AS schema,\n  c.relname AS table,\n  (c.oid || '.' || a.attnum) AS id,\n  a.attnum AS ordinal_position,\n  a.attname AS name,\n  CASE\n    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)\n    ELSE NULL\n  END AS default_value,\n  CASE\n    WHEN t.typtype = 'd' THEN CASE\n      WHEN bt.typelem <> 0 :: oid\n      AND bt.typlen = -1 THEN 'ARRAY'\n      WHEN nbt.nspname = 'pg_catalog' THEN format_type(t.typbasetype, NULL)\n      ELSE 'USER-DEFINED'\n    END\n    ELSE CASE\n      WHEN t.typelem <> 0 :: oid\n      AND t.typlen = -1 THEN 'ARRAY'\n      WHEN nt.nspname = 'pg_catalog' THEN format_type(a.atttypid, NULL)\n      ELSE 'USER-DEFINED'\n    END\n  END AS data_type,\n  COALESCE(bt.typname, t.typname) AS format,\n  a.attidentity IN ('a', 'd') AS is_identity,\n  CASE\n    a.attidentity\n    WHEN 'a' THEN 'ALWAYS'\n    WHEN 'd' THEN 'BY DEFAULT'\n    ELSE NULL\n  END AS identity_generation,\n  a.attgenerated IN ('s') AS is_generated,\n  NOT (\n    a.attnotnull\n    OR t.typtype = 'd' AND t.typnotnull\n  ) AS is_nullable,\n  (\n    c.relkind IN ('r', 'p')\n    OR c.relkind IN ('v', 'f') AND pg_column_is_updatable(c.oid, a.attnum, FALSE)\n  ) AS is_updatable,\n  uniques.table_id IS NOT NULL AS is_unique,\n  check_constraints.definition AS \"check\",\n  array_to_json(\n    array(\n      SELECT\n        enumlabel\n      FROM\n        pg_catalog.pg_enum enums\n      WHERE\n        enums.enumtypid = coalesce(bt.oid, t.oid)\n        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)\n      ORDER BY\n        enums.enumsortorder\n    )\n  ) AS enums,\n  col_description(c.oid, a.attnum) AS comment\nFROM\n  pg_attribute a\n  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid\n  AND a.attnum = ad.adnum\n  JOIN (\n    pg_class c\n    JOIN pg_namespace nc ON c.relnamespace = nc.oid\n  ) ON a.attrelid = c.oid\n  JOIN (\n    pg_type t\n    JOIN pg_namespace nt ON t.typnamespace = nt.oid\n  ) ON a.atttypid = t.oid\n  LEFT JOIN (\n    pg_type bt\n    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid\n  ) ON t.typtype = 'd'\n  AND t.typbasetype = bt.oid\n  LEFT JOIN (\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position\n    FROM pg_catalog.pg_constraint\n    WHERE contype = 'u' AND cardinality(conkey) = 1\n  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum\n  LEFT JOIN (\n    -- We only select the first column check\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position,\n      substring(\n        pg_get_constraintdef(pg_constraint.oid, true),\n        8,\n        length(pg_get_constraintdef(pg_constraint.oid, true)) - 8\n      ) AS \"definition\"\n    FROM pg_constraint\n    WHERE contype = 'c' AND cardinality(conkey) = 1\n    ORDER BY table_id, ordinal_position, oid asc\n  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum\nWHERE\n  NOT pg_is_other_temp_schema(nc.oid)\n  AND a.attnum > 0\n  AND NOT a.attisdropped\n  AND (c.relkind IN ('r', 'v', 'm', 'f', 'p'))\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_column_privilege(\n      c.oid,\n      a.attnum,\n      'SELECT, INSERT, UPDATE, REFERENCES'\n    )\n  )\n",am("columns","columns.table_id = tables.id"));return t+="\n",e.length>0?t+="where schema in (".concat(e.map(e=>"'".concat(e,"'")).join(","),")"):t+="where schema not in (".concat(au.map(e=>"'".concat(e,"'")).join(","),")"),t}(s),readOnly:!0,dbClient:a})},aw=(e,t)=>{let s=ag();return(0,x.a)({queryKey:["tables",e,t],queryFn:()=>ay({projectRef:e,schemas:t,dbClient:s}),enabled:!!e&&!!s})},aN=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/storage/buckets",{params:{path:{ref:e}}});if(a)throw a;return s},a_=e=>{let t=ag();return(0,x.a)({queryKey:["buckets",e],queryFn:()=>aN(e,t),enabled:!!e&&!!t,retry:!1})},ak=async e=>{let{projectRef:t,iso_timestamp_start:s,iso_timestamp_end:a,sql:n,dbClient:r}=e,{data:i,error:l}=await r.GET("/v1/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:t},query:{iso_timestamp_start:s,iso_timestamp_end:a,sql:n}}});if(l)throw l;return i},aS=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=ag(),a=["logs",e,t.sql];return(0,x.a)({queryKey:a,queryFn:()=>{var a,n;let r=new Date,i=new Date(r.getTime()-36e5);return ak({projectRef:e,sql:t.sql,iso_timestamp_start:null!==(a=t.iso_timestamp_start)&&void 0!==a?a:i.toISOString(),iso_timestamp_end:null!==(n=t.iso_timestamp_end)&&void 0!==n?n:r.toISOString(),dbClient:s})},enabled:!!e&&!!s,retry:!1})},aC=e=>{let{projectRef:t,days:s,dbClient:a}=e;return av({projectRef:t,query:"\n    WITH days_series AS (\n      SELECT generate_series(\n        date_trunc('day', now() - interval '".concat(Number(s)-1," days'),\n        date_trunc('day', now()),\n        '1 day'::interval\n      )::date AS date\n    )\n    SELECT\n      d.date,\n      COALESCE(u.users, 0)::int as users\n    FROM\n      days_series d\n    LEFT JOIN (\n      SELECT\n        date_trunc('day', created_at AT TIME ZONE 'UTC')::date as date,\n        count(id) as users\n      FROM\n        auth.users\n      GROUP BY 1\n    ) u ON d.date = u.date\n    ORDER BY\n      d.date ASC;\n  "),readOnly:!0,dbClient:a})},aE=(e,t)=>{let s=ag();return(0,x.a)({queryKey:["user-counts",e,t],queryFn:()=>aC({projectRef:e,days:t,dbClient:s}),enabled:!!e&&!!s,retry:!1})},az=async(e,t)=>{let[{data:s,error:a},{data:n,error:r}]=await Promise.all([t.GET("/v1/projects/{ref}/advisors/performance",{params:{path:{ref:e}}}),t.GET("/v1/projects/{ref}/advisors/security",{params:{path:{ref:e}}})]);if(a)throw a;if(r)throw r;return[...((null==s?void 0:s.lints)||[]).map(e=>({...e,type:"performance"})),...((null==n?void 0:n.lints)||[]).map(e=>({...e,type:"security"}))]},aA=e=>{let t=ag();return(0,x.a)({queryKey:["suggestions",e],queryFn:()=>az(e,t),enabled:!!e&&!!t,retry:!1})},aI=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/secrets",{params:{path:{ref:e}}});if(a)throw a;return console.log("SECRETS-DATA",s),s},aD=e=>{let t=ag();return(0,x.a)({queryKey:["secrets",e],queryFn:()=>aI(e,t),enabled:!!e&&!!t,retry:!1})},aO=async e=>{let{projectRef:t,secrets:s,dbClient:a}=e,{data:n,error:r}=await a.POST("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});if(r)throw r;return n},aP=()=>{let e=(0,e6.NL)(),t=ag();return(0,th.D)({mutationFn:e=>{let{projectRef:s,secrets:a}=e;if(!t)throw Error("Database client not available");return aO({projectRef:s,secrets:a,dbClient:t})},onSuccess:(t,s)=>{eU.Am.success("Secrets created successfully."),e.refetchQueries({queryKey:["secrets",s.projectRef]})},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"There was a problem with your request.")}})},aT=async e=>{let{projectRef:t,secretNames:s,dbClient:a}=e,{data:n,error:r}=await a.DELETE("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});if(r)throw r;return n},aL=()=>{let e=(0,e6.NL)(),t=ag();return(0,th.D)({mutationFn:e=>{let{projectRef:s,secretNames:a}=e;if(!t)throw Error("Database client not available");return aT({projectRef:s,secretNames:a,dbClient:t})},onSuccess:(t,s)=>{eU.Am.success("Secrets deleted successfully."),e.invalidateQueries({queryKey:["secrets",s.projectRef]})},onError:e=>{var t,s;eU.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"There was a problem with your request.")}})},aR={disable_signup:"Disable Signup",external_anonymous_users_enabled:"Allow Anonymous Sign-ins",external_email_enabled:"Enable Email Provider",mailer_autoconfirm:"Confirm Email",mailer_secure_email_change_enabled:"Secure Email Change",security_update_password_require_reauthentication:"Secure Password Change",password_hibp_enabled:"Prevent Leaked Passwords",password_min_length:"Minimum Password Length",password_required_characters:{label:"Password Requirements",options:{NO_REQUIRED_CHARS:"No requirements","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Letters and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Lowercase, uppercase, and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~":"Letters, numbers, and symbols"}},mailer_otp_exp:"Email OTP Expiration (seconds)",mailer_otp_length:"Email OTP Length",external_phone_enabled:"Enable Phone Provider",sms_provider:{label:"SMS Provider",options:{twilio:"Twilio",messagebird:"MessageBird",textlocal:"TextLocal",vonage:"Vonage",twilio_verify:"Twilio Verify"}},sms_twilio_account_sid:"Twilio Account SID",sms_twilio_auth_token:"Twilio Auth Token",sms_twilio_message_service_sid:"Twilio Message Service SID",sms_twilio_content_sid:"Twilio Content SID",sms_twilio_verify_account_sid:"Twilio Verify Account SID",sms_twilio_verify_auth_token:"Twilio Verify Auth Token",sms_twilio_verify_message_service_sid:"Twilio Verify Message Service SID",sms_messagebird_access_key:"MessageBird Access Key",sms_messagebird_originator:"MessageBird Originator",sms_textlocal_api_key:"TextLocal API Key",sms_textlocal_sender:"TextLocal Sender",sms_vonage_api_key:"Vonage API Key",sms_vonage_api_secret:"Vonage API Secret",sms_vonage_from:"Vonage From Number",sms_autoconfirm:"Enable Phone Confirmations",sms_otp_exp:"SMS OTP Expiry (seconds)",sms_otp_length:"SMS OTP Length",sms_template:"SMS Message Template",sms_test_otp:"Test Phone Numbers and OTPs",sms_test_otp_valid_until:"Test OTPs Valid Until",external_google_enabled:"Enable Google Sign-in",external_google_client_id:"Google Client ID(s)",external_google_secret:"Google OAuth Client Secret",external_google_skip_nonce_check:"Skip Nonce Check",name:"Secret Name",value:"Secret Value",secretNames:"Secret Names"},aF=tQ.z.object({disable_signup:tQ.z.boolean().optional().describe("This will prevent new users from signing up."),external_anonymous_users_enabled:tQ.z.boolean().optional().describe("This will enable anonymous users to sign in to your application.")}),aZ="NO_REQUIRED_CHARS",aM=tQ.z.object({external_email_enabled:tQ.z.boolean().optional().describe("This will enable Email based signup and login for your application."),mailer_autoconfirm:tQ.z.boolean().optional().describe("Users will need to confirm their email address before signing in for the first time."),mailer_secure_email_change_enabled:tQ.z.boolean().optional().describe("Users will be required to confirm any email change on both the old email address and new email address. If disabled, only the new email is required to confirm."),security_update_password_require_reauthentication:tQ.z.boolean().optional().describe("Users will need to be recently logged in to change their password without requiring reauthentication. (A user is considered recently logged in if the session was created within the last 24 hours.) If disabled, a user can change their password at any time."),password_hibp_enabled:tQ.z.boolean().optional().describe("Rejects the use of known or easy to guess passwords on sign up or password change. Powered by the HaveIBeenPwned.org Pwned Passwords API."),password_min_length:tQ.z.number().int().min(6,"Must be greater or equal to 6.").describe("Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more."),password_required_characters:tQ.z.preprocess(e=>""===e||null==e?aZ:e,tQ.z.enum([aZ,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~"])).optional().transform(e=>e===aZ?"":e).describe("Passwords that do not have at least one of each will be rejected as weak."),mailer_otp_exp:tQ.z.number().int().min(0,"Must be more than 0").max(86400,"Must be no more than 86400").describe("Duration before an email otp / link expires in seconds."),mailer_otp_length:tQ.z.number().int().min(6,"Must be at least 6").max(10,"Must be no more than 10").optional().describe("Number of digits in the email OTP")}).describe("Email provider settings."),aU=tQ.z.object({external_phone_enabled:tQ.z.boolean().optional().describe("This will enable phone based login for your application"),sms_provider:tQ.z.enum(["twilio","messagebird","textlocal","vonage","twilio_verify"]).optional().describe("External provider that will handle sending SMS messages"),sms_twilio_account_sid:tQ.z.string().optional(),sms_twilio_auth_token:tQ.z.string().optional(),sms_twilio_message_service_sid:tQ.z.string().optional(),sms_twilio_content_sid:tQ.z.string().optional().describe("Twilio Content SID (Optional, For WhatsApp Only)"),sms_twilio_verify_account_sid:tQ.z.string().optional(),sms_twilio_verify_auth_token:tQ.z.string().optional(),sms_twilio_verify_message_service_sid:tQ.z.string().optional(),sms_messagebird_access_key:tQ.z.string().optional(),sms_messagebird_originator:tQ.z.string().optional(),sms_textlocal_api_key:tQ.z.string().optional(),sms_textlocal_sender:tQ.z.string().optional(),sms_vonage_api_key:tQ.z.string().optional(),sms_vonage_api_secret:tQ.z.string().optional(),sms_vonage_from:tQ.z.string().optional(),sms_autoconfirm:tQ.z.boolean().optional().describe("Users will need to confirm their phone number before signing in."),sms_otp_exp:tQ.z.number().int().optional().describe("Duration before an SMS OTP expires in seconds."),sms_otp_length:tQ.z.number().int().optional().describe("Number of digits in OTP."),sms_template:tQ.z.string().optional().describe("To format the OTP code use `{{ .Code }}`"),sms_test_otp:tQ.z.string().optional().describe("Register phone number and OTP combinations for testing as a comma separated list of <phone number>=<otp> pairs. Example: `18005550123=789012`"),sms_test_otp_valid_until:tQ.z.string().datetime({message:"Invalid datetime string."}).optional().describe("Test phone number and OTP combinations won't be active past this date and time (local time zone).")}).describe("Phone provider settings."),aq=tQ.z.object({external_google_enabled:tQ.z.boolean().optional().describe("Enable Sign in with Google"),external_google_client_id:tQ.z.string().regex(/^([a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*(,[a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*)*)$/i,"Google Client IDs should be a comma-separated list of domain-like strings.").optional(),external_google_secret:tQ.z.string().regex(/^[a-z0-9.\/_-]*$/i,"Google OAuth Client Secrets usually contain letters, numbers, dots, dashes, and underscores.").optional(),external_google_skip_nonce_check:tQ.z.boolean().optional().describe("Allows ID tokens with any nonce to be accepted, which is less secure.")}),aW=aq.superRefine((e,t)=>{e.external_google_enabled&&!e.external_google_client_id&&t.addIssue({code:tQ.z.ZodIssueCode.custom,path:["external_google_client_id"],message:"At least one Client ID is required when Google sign-in is enabled."}),e.external_google_client_id&&e.external_google_client_id.includes(" ")&&t.addIssue({code:tQ.z.ZodIssueCode.custom,path:["external_google_client_id"],message:"Client IDs should not contain spaces."})}).describe("Google provider settings.");aF.merge(aM).merge(aU).merge(aq).partial();let aK=tQ.z.object({secrets:tQ.z.array(tQ.z.object({name:tQ.z.string().min(1,"Secret name is required.").regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/,"Must contain letters, numbers, and underscores, starting with a letter or underscore."),value:tQ.z.string().min(1,"Secret value is required.")}))}).describe("Secrets schema for managing environment variables.");tQ.z.object({secretNames:tQ.z.array(tQ.z.string().min(1,"Secret name cannot be empty.")).min(1,"At least one secret name is required.")}).describe("Schema for deleting secrets by name.");let aJ=e=>{if(!e||"object"!=typeof e._def||null===e._def)throw Error("unwrapZodType received an invalid Zod schema object. Check the console for the problematic schema/key.");let t=e;for(;"ZodOptional"===t._def.typeName||"ZodDefault"===t._def.typeName||"ZodNullable"===t._def.typeName||"ZodEffects"===t._def.typeName;)t="ZodEffects"===t._def.typeName?t._def.schema:t._def.innerType;return t};function aG(e){let{schema:t,onSubmit:s,isLoading:a=!1,initialValues:n,labels:r,columnInfo:i}=e,c=(0,o.useRef)(!0),d=Object.keys(t.shape).reduce((e,s)=>{let a=t.shape[s];if(void 0===a)throw Error("Schema error: schema.shape['".concat(s,"'] is undefined. Check schema definition."));if("ZodDefault"===a._def.typeName)return e[s]=a._def.defaultValue(),e;let n=aJ(a);switch(n._def.typeName){case"ZodString":e[s]="";break;case"ZodBoolean":e[s]=!1;break;case"ZodEnum":let r=n._def.values||[];e[s]=r.length>0?r[0]:"";break;case"ZodNumber":e[s]=0;break;case"ZodArray":e[s]=[];break;default:e[s]=void 0}return e},{}),u=(0,tY.cI)({resolver:(0,tH.F)(t),defaultValues:d});(0,o.useEffect)(()=>{if(n){c.current=!0;let e=Object.keys(t.shape).reduce((e,s)=>{let a=t.shape[s];if(void 0===a)throw Error("Schema error in useEffect: schema.shape['".concat(s,"'] is undefined."));let r=n.hasOwnProperty(s)?n[s]:void 0,i=aJ(a);if("ZodBoolean"===i._def.typeName)e[s]=!!r;else if("ZodString"===i._def.typeName)e[s]=null==r?"":String(r);else if("ZodEnum"===i._def.typeName){let t=i._def.values||[];e[s]=null!=r&&t.includes(r)?String(r):t[0]||""}else if("ZodNumber"===i._def.typeName){let t=Number(r);e[s]=isNaN(t)?0:t}else if("ZodArray"===i._def.typeName){if(Array.isArray(r))e[s]=r;else if(null==r)e[s]=[];else if("string"==typeof r&&r.startsWith("{")&&r.endsWith("}"))try{let t=r.slice(1,-1);""===t.trim()?e[s]=[]:e[s]=t.split(",").map(e=>e.trim())}catch(t){e[s]=[]}else e[s]=[]}else e[s]=r;return e},{});u.reset(e),setTimeout(()=>{c.current=!1},0)}else c.current=!1},[n,u,t]);let m=(e,t)=>{let s=aJ(t),a=s._def.typeName,n=t.description;return(0,l.jsx)(t$.Wi,{control:u.control,name:e,render:t=>{var o,d,u,m;let{field:p}=t,h=null==r?void 0:r[e],x="string"==typeof h?h:(null==h?void 0:h.label)||e,g=(null==i?void 0:null===(o=i[e])||void 0===o?void 0:o.data_type)||"";switch(a){case"ZodString":return(0,l.jsx)(t$.xJ,{className:"border-b py-6",children:(0,l.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,l.jsxs)("div",{className:"flex-1 pr-4",children:[(0,l.jsx)(t$.lX,{children:x}),(0,l.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:g}),n&&(0,l.jsx)(t$.pf,{children:n}),(0,l.jsx)(t$.zG,{})]}),(0,l.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{placeholder:"Enter your ".concat(e),...p,value:p.value||""})})})]})});case"ZodNumber":return(0,l.jsx)(t$.xJ,{className:"border-b py-6",children:(0,l.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,l.jsxs)("div",{className:"flex-1 pr-4",children:[(0,l.jsx)(t$.lX,{children:x}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,l.jsx)(t$.pf,{children:n}),(0,l.jsx)(t$.zG,{})]}),(0,l.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{type:"number",placeholder:"Enter value for ".concat(e),...p,value:null!==(d=p.value)&&void 0!==d?d:"",onChange:e=>{let t=parseInt(e.target.value,10);p.onChange(isNaN(t)?void 0:t)}})})})]})});case"ZodBoolean":return(0,l.jsxs)(t$.xJ,{className:"flex flex-row items-center justify-between gap-8 border-b py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(t$.lX,{children:x}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,l.jsx)(t$.pf,{children:n}),(0,l.jsx)(t$.zG,{})]}),(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tn.r,{checked:!!p.value,onCheckedChange:p.onChange})})]});case"ZodEnum":let f=s._def.values,j="object"==typeof h?h.options:void 0;return(0,l.jsx)(t$.xJ,{className:"border-b py-6",children:(0,l.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,l.jsxs)("div",{className:"flex-1 pr-4",children:[(0,l.jsx)(t$.lX,{children:x}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,l.jsx)(t$.pf,{children:n}),(0,l.jsx)(t$.zG,{})]}),(0,l.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,l.jsxs)(e3.Ph,{onValueChange:e=>{c.current||p.onChange(e)},value:p.value,children:[(0,l.jsx)(t$.NI,{children:(0,l.jsx)(e3.i4,{children:(0,l.jsx)(e3.ki,{placeholder:"Select a ".concat(e)})})}),(0,l.jsx)(e3.Bw,{children:f.map(e=>(0,l.jsx)(e3.Ql,{value:e,children:(null==j?void 0:j[e])||e},e))})]})})]})});case"ZodArray":return(0,l.jsx)(t$.xJ,{className:"border-b py-6",children:(0,l.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-8",children:[(0,l.jsxs)("div",{className:"flex-1 pr-4",children:[(0,l.jsx)(t$.lX,{children:x}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:['Enter as JSON array: ["item1", "item2"]',(null==i?void 0:null===(u=i[e])||void 0===u?void 0:u.is_nullable)&&" (leave empty for null)"]}),n&&(0,l.jsx)(t$.pf,{children:n}),(0,l.jsx)(t$.zG,{})]}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{placeholder:(null==i?void 0:null===(m=i[e])||void 0===m?void 0:m.is_nullable)?'["item1", "item2"] or leave empty for null':'["item1", "item2"]',...p,value:null===p.value||void 0===p.value?"":Array.isArray(p.value)?JSON.stringify(p.value):p.value||"",onChange:e=>{let t=e.target.value;if(""===t.trim())p.onChange(null);else try{let e=JSON.parse(t);Array.isArray(e)?p.onChange(e):p.onChange(t)}catch(e){p.onChange(t)}}})})})]})});default:return(0,l.jsx)(l.Fragment,{})}}},e)};return(0,l.jsx)(t$.l0,{...u,children:(0,l.jsxs)("form",{onSubmit:u.handleSubmit(s),children:[Object.keys(t.shape).map(e=>m(e,t.shape[e])),(0,l.jsx)("div",{className:"pt-6",children:(0,l.jsx)(j.z,{type:"submit",disabled:a,children:a?"Saving...":"Save"})})]})})}function aV(e){let{projectRef:t,schema:s,title:a,initialValues:n,onSuccess:r}=e,{mutate:i,isPending:c}=aj(),d="shape"in s?s:s._def.schema,u=(0,o.useMemo)(()=>{if(n)return Object.keys(d.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]),e),{})},[n,d]);return(0,l.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,l.jsx)("h2",{className:"font-semibold mb-2 lg:mb-4 lg:text-xl",children:a}),(0,l.jsx)(aG,{schema:d,onSubmit:e=>{let s=Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}));if(0===Object.keys(s).length){alert("No changes to submit. Please modify a field to update.");return}i({projectRef:t,payload:s},{onSuccess:r})},isLoading:c,initialValues:u,labels:aR})]})}function aB(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n}=ax(t),{mutate:r,isPending:i}=aj(),{push:c,pop:d}=aa(),u=[{icon:(0,l.jsx)(b.Z,{name:"menu",className:"h-4 w-4 text-muted-foreground"}),name:"Email",description:"Sign in with email and password",schema:aM},{icon:(0,l.jsx)(b.Z,{name:"phone_iphone",className:"h-4 w-4 text-muted-foreground"}),name:"Phone",description:"Sign in with phone number",schema:aU},{icon:(0,l.jsx)(b.Z,{name:"person",className:"h-4 w-4 text-muted-foreground"}),name:"Google",description:"Sign in with Google",schema:aW}],m=(0,o.useCallback)(e=>{c({title:"".concat(e.name," Provider Settings"),component:(0,l.jsx)(aV,{projectRef:t,schema:e.schema,title:"".concat(e.name," Provider Settings"),initialValues:s,onSuccess:()=>d()})})},[t,s,c,d]),p=(0,o.useMemo)(()=>{if(s)return Object.keys(aF.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]),e),{})},[s]);return n?(0,l.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error loading auth settings"}),(0,l.jsx)(sY.X,{children:"There was a problem loading your authentication configuration."})]})}):a?(0,l.jsxs)("div",{className:"mx-auto w-full max-w-3xl space-y-2 p-12",children:[(0,l.jsx)(X.O,{className:"mb-8 h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"})]}):(0,l.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,l.jsxs)("div",{className:"mb-12",children:[(0,l.jsx)("h2",{className:"font-semibold text-base lg:text-xl",children:"General Settings"}),(0,l.jsx)("p",{className:"mb-2 mt-1 text-sm text-muted-foreground lg:text-base",children:"Allow people to sign up to your app"}),(0,l.jsx)(aG,{schema:aF,onSubmit:e=>{let s=Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}));if(0===Object.keys(s).length){alert("No changes to submit. Please modify a field to update.");return}r({projectRef:t,payload:s})},isLoading:i,initialValues:p,labels:aR})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-semibold lg:text-lg",children:"Sign in methods"}),(0,l.jsx)("p",{className:"mb-6 mt-1 text-sm text-muted-foreground lg:text-base",children:"Configure how people sign in and up to your app."}),(0,l.jsx)("div",{className:"overflow-hidden rounded-md border bg-background",children:u.map(e=>(0,l.jsxs)(j.z,{variant:"ghost",size:"lg",onClick:()=>m(e),className:"h-auto w-full flex-row justify-start gap-4 rounded-none border-b px-8 py-4 text-left last:border-b-0",children:[e.icon,(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"font-bold",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,l.jsx)(b.Z,{name:"chevron_right",className:"h-4 w-4 text-muted-foreground"})]},e.name))})]})]})}var aH=s(76865),aY=s(82029),aQ=s(76003),aX=s(48736),a$=s(20464),a0=s(79001),a1=s(51817),a2=s(20265),a4=s(78298),a5=s(90962),a6=s(61563);let a3=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:t,className:(0,U.cn)("w-full caption-bottom text-sm",s),...a})})});a3.displayName="Table";let a8=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("thead",{ref:t,className:(0,U.cn)("[&_tr]:border-b",s),...a})});a8.displayName="TableHeader";let a7=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("tbody",{ref:t,className:(0,U.cn)("[&_tr:last-child]:border-0",s),...a})});a7.displayName="TableBody",o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("tfoot",{ref:t,className:(0,U.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let a9=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("tr",{ref:t,className:(0,U.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",s),...a})});a9.displayName="TableRow";let ne=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("th",{ref:t,className:(0,U.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});ne.displayName="TableHead";let nt=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("td",{ref:t,className:(0,U.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});function ns(e){let{data:t,onRowClick:s}=e;if(!t||0===t.length)return(0,l.jsx)("p",{className:"p-4 text-center",children:"The query returned no results."});let a=Object.keys(t[0]);return(0,l.jsx)("div",{className:"overflow-auto",children:(0,l.jsxs)(a3,{children:[(0,l.jsx)(a8,{children:(0,l.jsx)(a9,{className:"hover:bg-transparent",children:a.map(e=>(0,l.jsx)(ne,{className:"first:pl-6 last:pr-6 lg:first:pl-8 lg:last:pr-8",children:e},e))})}),(0,l.jsx)(a7,{children:t.map((e,t)=>(0,l.jsx)(a9,{onClick:()=>null==s?void 0:s(e),className:(0,U.cn)(s&&"group cursor-pointer hover:bg-muted/50"),children:a.map(s=>(0,l.jsx)(nt,{className:"min-w-[8rem] text-xs text-muted-foreground first:pl-6 last:pr-6 group-hover:text-foreground lg:first:pl-8 lg:last:pr-8",children:(0,l.jsx)("div",{className:"w-fit max-w-96 truncate font-mono text-xs",children:JSON.stringify(e[s]).replace(/^"|"$/g,"")})},"".concat(t,"-").concat(s)))},t))})]})})}function na(e){var t,s;let{projectRef:a,initialSql:n,queryKey:r,onResults:i,onRowClick:c,label:d="Query your data",hideSql:u=!1,readOnly:m=!1,runAutomatically:p=!1,refetch:h,initialNaturalLanguageMode:x=!1,hideChartOption:g=!1}=e,[f,v]=(0,o.useState)(n||""),[b,y]=(0,o.useState)(!u),[w,N]=(0,o.useState)(x),[_,k]=(0,o.useState)(""),{mutate:S,data:C,isPending:E,error:z}=ab(),[A,I]=(0,o.useState)(!1),[D,O]=(0,o.useState)(null),[P,T]=(0,o.useState)(!1),[L,R]=(0,o.useState)(null),[F,Z]=(0,o.useState)(null),M=(0,o.useMemo)(()=>C&&0!==C.length&&C[0]?Object.keys(C[0]):[],[C]);(0,o.useEffect)(()=>{n&&v(n)},[n]);let U=async()=>{if(_){I(!0),O(null);try{let e=await fetch("/api/ai/sql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:_,projectRef:a})});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to generate SQL")}let{sql:t}=await e.json();v(t),S({projectRef:a,query:t,readOnly:!0})}catch(e){console.error(e),O(e.message)}finally{I(!1)}}},q=(0,o.useCallback)(()=>{f&&S({projectRef:a,query:f,readOnly:!0})},[f,a,S]);(0,o.useEffect)(()=>{y(!u)},[u]),(0,o.useEffect)(()=>{p&&n&&S({projectRef:a,query:n,readOnly:!0})},[p,n,a,S]),(0,o.useEffect)(()=>{h&&h>0&&q()},[h,q]),(0,o.useEffect)(()=>{i&&i(C)},[C,i]),(0,o.useEffect)(()=>{!(!C||Array.isArray(C)&&0===C.length)||b||w||m||E||y(!0)},[C,b,w]);let W=(null==z?void 0:null===(s=z.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"",K=W.includes("permission denied")||W.includes("42501"),J=(0,o.useMemo)(()=>{let e=[];return w&&e.push("chat"),b&&e.push("sql"),!g&&P&&e.push("chart"),e},[w,b,P,g]),{resolvedTheme:G}=(0,a4.F)(),V="dark"===G?a5.Lm:a5.C0;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"pt-4 lg:px-8 lg:pt-8",children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center gap-4",children:[(0,l.jsx)("h2",{className:"font-semibold flex-1",children:d}),(0,l.jsxs)(a6.t,{type:"multiple",size:"sm",value:J,onValueChange:e=>{N(e.includes("chat")),y(e.includes("sql")),g||T(e.includes("chart"))},className:"gap-1",children:[(0,l.jsx)(a6.G,{value:"sql","aria-label":"SQL",children:(0,l.jsx)(aX.Z,{className:"h-4 w-4"})}),!g&&(0,l.jsxs)(sx.J2,{children:[(0,l.jsx)(sx.xo,{asChild:!0,children:(0,l.jsx)(a6.G,{value:"chart","aria-label":"Chart",children:(0,l.jsx)(a$.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(sx.yk,{className:"w-80",children:(0,l.jsx)("div",{className:"grid gap-4",children:(0,l.jsxs)("div",{className:"grid gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)(se.Label,{className:"mb-2 block flex-1",children:"Show Chart"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Visualize your data with a chart."})]}),(0,l.jsx)(tn.r,{id:"show-chart",className:"mb-0",checked:P,onCheckedChange:T})]}),P&&(0,l.jsxs)("div",{className:"mt-2",children:[(0,l.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,l.jsx)(se.Label,{htmlFor:"x-axis",children:"X-Axis"}),(0,l.jsxs)(e3.Ph,{onValueChange:R,defaultValue:L||void 0,children:[(0,l.jsx)(e3.i4,{className:"col-span-2 h-8",children:(0,l.jsx)(e3.ki,{placeholder:"Select column"})}),(0,l.jsx)(e3.Bw,{children:M.map(e=>(0,l.jsx)(e3.Ql,{value:e,children:e},e))})]})]}),(0,l.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,l.jsx)(se.Label,{htmlFor:"y-axis",children:"Y-Axis"}),(0,l.jsxs)(e3.Ph,{onValueChange:Z,defaultValue:F||void 0,children:[(0,l.jsx)(e3.i4,{className:"col-span-2 h-8",children:(0,l.jsx)(e3.ki,{placeholder:"Select column"})}),(0,l.jsx)(e3.Bw,{children:M.map(e=>(0,l.jsx)(e3.Ql,{value:e,children:e},e))})]})]})]})]})})})]})]})]}),(0,l.jsxs)("div",{children:[w&&(0,l.jsxs)("div",{className:"mb-4 flex items-center gap-4 rounded-md border bg-muted/50 pl-4 pr-1 shadow",children:[(0,l.jsx)(a0.Z,{strokeWidth:1.5,size:16}),(0,l.jsx)(tV.I,{placeholder:"e.g. Show me all users who signed up in the last 7 days",value:_,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),U())},className:"rounded-none border-none bg-transparent px-0 py-4 text-sm shadow-none focus-visible:ring-0 focus-visible:ring-offset-0 lg:text-base"}),(0,l.jsx)(j.z,{onClick:U,disabled:A||E,className:"h-7 w-7 shrink-0 rounded-full p-0",children:A?(0,l.jsx)(a1.Z,{size:16,className:"animate-spin"}):E?(0,l.jsx)(a1.Z,{size:16,className:"animate-spin"}):(0,l.jsx)(a2.Z,{size:16})})]}),b&&(0,l.jsxs)("div",{className:"relative -mx-6 mt-4 h-[200px] overflow-hidden border-b border-t bg-muted lg:-mx-8",children:[(0,l.jsx)(aQ.ZP,{height:"100%",value:f,onChange:e=>v(e||""),theme:V,className:"h-full bg-transparent text-xs",extensions:a5.A4}),(0,l.jsx)(j.z,{size:"sm",onClick:q,disabled:E,className:"absolute bottom-4 right-4",children:E?"Running...":"Run Query"})]})]})]}),E&&(0,l.jsxs)("div",{className:"space-y-2 p-4 px-6 lg:px-8",children:[(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"})]}),D&&(0,l.jsx)("div",{className:"px-6 py-4 lg:px-8",children:(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(aH.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error generating SQL"}),(0,l.jsx)(sY.X,{children:D})]})}),z&&(0,l.jsx)("div",{className:"px-6 py-4 lg:px-8",children:(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(aH.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Query Error"}),(0,l.jsx)(sY.X,{children:K?"You can't directly alter your database schema, use chat instead":W||(null==z?void 0:z.message)||"An unexpected error occurred"})]})}),!g&&C&&P&&L&&F&&(0,l.jsx)("div",{className:"mb-4 mt-8 px-8",children:(0,l.jsx)(nn,{data:C,xAxis:L,yAxis:F})}),C&&(0,l.jsx)("div",{children:(0,l.jsx)(ns,{data:C,onRowClick:e=>null==c?void 0:c(e,r)})})]})}function nn(e){let{data:t,xAxis:s,yAxis:a}=e;return(0,l.jsx)(K,{config:{[a]:{label:a,color:"var(--chart-1)"}},className:"aspect-auto h-[250px] w-full",children:(0,l.jsxs)(O.v,{accessibilityLayer:!0,data:t,margin:{left:-24,right:12},children:[(0,l.jsx)(P.q,{vertical:!1}),(0,l.jsx)(T.K,{dataKey:s,tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32}),(0,l.jsx)(L.B,{dataKey:a,tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,l.jsx)(G,{content:(0,l.jsx)(V,{className:"w-[150px]",indicator:"dot"})}),(0,l.jsx)(F.$,{dataKey:a,fill:"var(--color-".concat(a,")")})]})})}nt.displayName="TableCell",o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("caption",{ref:t,className:(0,U.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";let nr=e=>e&&e.primary_keys?e.primary_keys.map(e=>e.name):[];function ni(e){let{projectRef:t,table:s,row:a,onSuccess:n}=e,{mutate:r,isPending:i}=ab(),c=(0,o.useMemo)(()=>(function(e){if(!e||!e.columns)return tQ.z.object({});let t={};for(let s of e.columns){let e;if(!s.is_updatable||s.is_generated)continue;let a=s.data_type.toLowerCase();e=a.includes("array")?tQ.z.array(tQ.z.any()):a.includes("int")||a.includes("numeric")?tQ.z.number():a.includes("bool")?tQ.z.boolean():"user-defined"===a&&s.enums&&Array.isArray(s.enums)&&s.enums.length>0?tQ.z.enum(s.enums):tQ.z.string(),s.is_nullable&&(e=e.nullish()),t[s.name]=e}return tQ.z.object(t)})(s),[s]),d=(0,o.useMemo)(()=>{if(!s||!s.columns)return{};let e={};for(let t of s.columns){if(!t.is_updatable||t.is_generated)continue;let s=t.data_type.toLowerCase(),a="user-defined"===s&&t.enums&&Array.isArray(t.enums)&&t.enums.length>0?"enum":s;e[t.name]={data_type:a,is_nullable:t.is_nullable}}return e},[s]),u=(0,o.useCallback)(e=>{let i=nr(s);if(0===i.length){eU.Am.error("Cannot update row. This table does not have a primary key.");return}let l=Object.entries(e).map(e=>{var t;let n,[r,i]=e;if(JSON.stringify(a[r])===JSON.stringify(i))return null;let l=s.columns.find(e=>e.name===r),o=(null==l?void 0:null===(t=l.data_type)||void 0===t?void 0:t.toLowerCase())||"",c=(null==l?void 0:l.is_nullable)||!1;if(null==i||"string"==typeof i&&""===i.trim()){if(c)n="NULL";else if(o.includes("array")){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="''"}else if(Array.isArray(i)&&0===i.length){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else if(o.includes("array")){let e=JSON.stringify({[r]:i});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="user-defined"===o&&(null==l?void 0:l.enums)?"'".concat(String(i).replace(/'/g,"''"),"'"):"string"==typeof i?"'".concat(i.replace(/'/g,"''"),"'"):i;return'"'.concat(r,'" = ').concat(n)}).filter(Boolean).join(", ");if(!l){eU.Am.error("No changes to save"),n();return}let o=i.map(e=>{let t=a[e],s="string"==typeof t?"'".concat(t.replace(/'/g,"''"),"'"):t;return'"'.concat(e,'" = ').concat(s)}).join(" AND ");r({projectRef:t,query:'UPDATE public."'.concat(s.name,'" SET ').concat(l," WHERE ").concat(o,";"),readOnly:!1},{onSuccess:n})},[t,s,a,r,n]);return(0,l.jsxs)("div",{className:"px-6 pb-10 pt-4 lg:px-12 lg:pt-10",children:[(0,l.jsxs)("h2",{className:"font-semibold mb-4 text-base lg:text-xl",children:["Editing row in ",s.name]}),(0,l.jsx)(aG,{schema:c,initialValues:a,onSubmit:u,isLoading:i,columnInfo:d})]})}function nl(e){let{projectRef:t,table:s}=e,{push:a,pop:n}=aa(),[r,i]=(0,o.useState)(0),c=(0,o.useCallback)(e=>{a({title:"Editing row",component:(0,l.jsx)(ni,{projectRef:t,table:s,row:e,onSuccess:()=>{n(),i(e=>e+1)}})})},[a,n,t,s]);return(0,l.jsx)(na,{hideChartOption:!0,projectRef:t,label:"View records in ".concat(s.name),initialSql:'SELECT * FROM public."'.concat(s.name,'" LIMIT 100;'),queryKey:s.id,onRowClick:c,hideSql:!0,runAutomatically:!0,refetch:r,readOnly:!0})}function no(e){let{projectRef:t}=e,{push:s}=aa(),{data:a,isLoading:n,isError:r}=aw(t,["public"]),i=(0,o.useCallback)(e=>{s({title:e.name,component:(0,l.jsx)(nl,{projectRef:t,table:e})})},[s,t]);return(0,o.useCallback)(()=>{s({title:"Talk to your database",component:(0,l.jsx)(na,{projectRef:t,initialNaturalLanguageMode:!0,hideSql:!0})})},[s,t]),(0,l.jsxs)("div",{className:"pt-4 lg:pt-8",children:[(0,l.jsx)("div",{className:"mb-6 flex items-center justify-between gap-6",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Database"}),(0,l.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View and manage the data stored in your app."})]})}),r&&(0,l.jsxs)(sY.bZ,{variant:"destructive",className:"mt-8",children:[(0,l.jsx)(aH.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error loading tables"}),(0,l.jsx)(sY.X,{children:"There was a problem loading your database tables."})]}),n&&(0,l.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"})]}),a&&a.length>0?(0,l.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,l.jsxs)(j.z,{variant:"outline",size:"lg",className:"flex-row justify-between text-left",onClick:()=>i(e),children:[(0,l.jsx)(aY.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("h2",{className:"flex-1 truncate font-mono text-sm font-medium",children:e.name}),(0,l.jsxs)("div",{className:"shrink-0 font-mono text-sm text-muted-foreground",children:[e.live_rows_estimate," rows"]})]},e.id))}):n||a&&0!==a.length?null:(0,l.jsxs)(sY.bZ,{className:"mt-8",children:[(0,l.jsx)(aY.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"No database tables"}),(0,l.jsx)(sY.X,{children:"Create tables to store and organize your data."})]})]})}var nc=s(24156),nd=s(30401),nu=s(80221),nm=s(23231),np=s(23518),nh=s(5073);(a=r||(r={})).FN_EDGE="function_edge_logs",a.AUTH="auth_logs",a.POSTGRES="postgres_logs",a.REALTIME="realtime_logs",a.STORAGE="storage_logs",a.PG_CRON="pg_cron_logs",a.EDGE="edge_logs",a.FUNCTIONS="function_logs",a.POSTGREST="postgrest_logs",a.SUPAVISOR="supavisor_logs",a.PGBOUNCER="pgbouncer_logs",a.WAREHOUSE="warehouse_logs",a.PG_UPGRADE="pg_upgrade_logs";let nx=e=>{switch(e){case"edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.request) as request\n  cross join unnest(m.response) as response";case"postgres_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as parsed";case"function_logs":case"auth_logs":return"cross join unnest(metadata) as metadata";case"function_edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.response) as response\n  cross join unnest(m.request) as request";case"supavisor_logs":return"cross join unnest(metadata) as m";default:return""}},ng=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=nx(e),a="order by timestamp desc";switch(e){case"edge_logs":return"select id, ".concat(e,".timestamp, event_message, request.method, request.path, request.search, response.status_code\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"postgres_logs":return"select ".concat(e,".timestamp, id, event_message, parsed.error_severity, parsed.detail, parsed.hint\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level, metadata.status, metadata.path, metadata.msg as msg, metadata.error\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"supavisor_logs":case"pg_upgrade_logs":default:return"select id, ".concat(e,".timestamp, event_message\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"pg_cron_logs":return"select postgres_logs.timestamp, id, event_message, parsed.error_severity, parsed.query\nfrom postgres_logs\ncross join unnest(metadata) as m\ncross join unnest(m.parsed) as parsed\nwhere (parsed.application_name = 'pg_cron' OR event_message LIKE '%cron job%')\n".concat(a,"\nlimit ").concat(t)}},nf=[{value:r.FN_EDGE,label:"Function Edge Logs",description:"Edge function execution logs with request/response data"},{value:r.AUTH,label:"Authentication Logs",description:"User authentication events and security logs"},{value:r.POSTGRES,label:"PostgreSQL Logs",description:"Database queries, errors, and performance metrics"},{value:r.REALTIME,label:"Realtime Logs",description:"WebSocket connections and realtime subscriptions"},{value:r.STORAGE,label:"Storage Logs",description:"File uploads, downloads, and storage operations"},{value:r.PG_CRON,label:"Cron Job Logs",description:"Scheduled job executions and cron task logs"},{value:r.EDGE,label:"Edge Logs",description:"HTTP requests and responses from Edge Functions"},{value:r.FUNCTIONS,label:"Function Logs",description:"Serverless function execution logs and events"},{value:r.POSTGREST,label:"PostgREST Logs",description:"API requests to your database through PostgREST"},{value:r.SUPAVISOR,label:"Supavisor Logs",description:"Connection pooling and database proxy logs"},{value:r.PGBOUNCER,label:"PgBouncer Logs",description:"Legacy connection pooling logs"},{value:r.WAREHOUSE,label:"Warehouse Logs",description:"Data warehouse operations and analytics"},{value:r.PG_UPGRADE,label:"PostgreSQL Upgrade Logs",description:"Database upgrade processes and migration logs"}];function nj(e){var t;let{projectRef:s}=e,[a,n]=(0,o.useState)(r.FN_EDGE),[i,c]=(0,o.useState)(!1),{data:d,isLoading:u,error:m}=aS(s,{sql:(0,o.useMemo)(()=>ng(a),[a])}),p=nf.find(e=>e.value===a);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"sticky top-0 z-10 mb-6 flex items-center justify-between border-b bg-background pt-4 lg:pt-8",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Logs"}),(0,l.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"Debug errors and track activity in your app"})]}),(0,l.jsxs)(sx.J2,{open:i,onOpenChange:c,children:[(0,l.jsx)(sx.xo,{asChild:!0,children:(0,l.jsxs)(j.z,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-64 justify-between",children:[p?p.label:"Select log type...",(0,l.jsx)(nc.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,l.jsx)(sx.yk,{className:"w-80 p-0",align:"end",children:(0,l.jsxs)(np.mY,{children:[(0,l.jsx)(np.sZ,{placeholder:"Search log types...",className:"h-9"}),(0,l.jsxs)(np.e8,{className:"max-h-60 overflow-y-auto",onWheel:e=>{e.stopPropagation()},style:{overscrollBehavior:"contain"},children:[(0,l.jsx)(np.rb,{children:"No log type found."}),(0,l.jsx)(np.fu,{children:nf.map(e=>(0,l.jsxs)(np.di,{value:e.value,onSelect:e=>{n(e),c(!1)},className:"flex items-center gap-2 p-3",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"mb-1 text-xs font-medium leading-none",children:e.label}),(0,l.jsx)("div",{className:"text-xs leading-snug text-muted-foreground",children:e.description})]}),(0,l.jsx)(nd.Z,{className:(0,U.cn)("mt-0.5 h-4 w-4",a===e.value?"opacity-100":"opacity-0")})]},e.value))})]})]})})]})]}),u&&(0,l.jsxs)("div",{className:"mx-8 mt-8 space-y-2",children:[(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"})]}),(m||d&&d.error)&&(0,l.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(nu.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error fetching logs"}),(0,l.jsx)(sY.X,{children:(null==m?void 0:m.message)||"object"==typeof(null==d?void 0:d.error)&&(null===(t=d.error)||void 0===t?void 0:t.message)||"An unexpected error occurred. Please try again."})]})}),d&&d.result&&d.result.length>0&&(0,l.jsx)("div",{className:"mt-4 w-full overflow-auto",children:(0,l.jsxs)(a3,{children:[(0,l.jsx)(a8,{children:(0,l.jsx)(a9,{className:"hover:bg-transparent",children:Object.keys(d.result[0]).map((e,t,s)=>(0,l.jsx)(ne,{className:(0===t?"first:pl-6 lg:first:pl-8 ":"")+(t===s.length-1?"last:pr-6 lg:last:pr-8":""),children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})}),(0,l.jsx)(a7,{children:d.result.map((e,t)=>{var s,a;return(0,l.jsx)(a9,{className:"group relative hover:bg-muted/50",children:Object.keys(null!==(a=null===(s=d.result)||void 0===s?void 0:s[0])&&void 0!==a?a:[]).map((t,s,a)=>{let n=e[t],r="timestamp"===t&&"number"==typeof n?new Date(n/1e3).toLocaleString():null===n?"NULL":"object"==typeof n?JSON.stringify(n,null,2):String(n);return(0,l.jsx)(nt,{className:"min-w-32 text-xs text-muted-foreground first:pl-6 last:pr-6 group-hover:text-foreground lg:first:pl-8 lg:last:pr-8",children:(0,l.jsxs)(nh.zs,{children:[(0,l.jsx)(nh.Yi,{asChild:!0,children:(0,l.jsx)("div",{className:"w-fit max-w-96 cursor-default truncate font-mono text-xs",children:r})}),(0,l.jsx)(nh.bZ,{className:"max-h-96 w-96 overflow-auto p-3",children:(0,l.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:r})})]})},t)})},e.id||t)})})]})}),d&&d.result&&0===d.result.length&&(0,l.jsx)("div",{className:"mx-8 mt-8",children:(0,l.jsxs)(sY.bZ,{children:[(0,l.jsx)(nm.Z,{className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"No logs found"}),(0,l.jsx)(sY.X,{children:"Logs will appear here when your application generates activity."})]})})]})}function nv(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n}=aD(t),{mutate:r,isPending:i}=aP(),{mutate:o,isPending:c}=aL(),d=(0,tY.cI)({resolver:(0,tH.F)(aK),defaultValues:{secrets:[{name:"",value:""}]}}),{fields:u,append:m,remove:p}=(0,tY.Dq)({control:d.control,name:"secrets"}),h=e=>{window.confirm('Are you sure you want to delete the secret "'.concat(e,'"?'))&&o({projectRef:t,secretNames:[e]})};return a?(0,l.jsxs)("div",{className:"mx-auto w-full max-w-4xl space-y-4 p-12",children:[(0,l.jsx)(X.O,{className:"h-48 w-full"}),(0,l.jsx)(X.O,{className:"h-16 w-full"}),(0,l.jsx)(X.O,{className:"h-16 w-full"})]}):n?(0,l.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error loading secrets"}),(0,l.jsx)(sY.X,{children:"There was a problem loading your secrets configuration."})]})}):(0,l.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,l.jsxs)("div",{className:"mb-16",children:[(0,l.jsx)("h2",{className:"font-semibold mb-1 text-base lg:text-xl",children:"Add New Secret"}),(0,l.jsx)("p",{className:"mb-6 text-sm text-muted-foreground lg:text-base",children:"Add sensitive information like API keys that your app needs to work securely."}),(0,l.jsx)(t$.l0,{...d,children:(0,l.jsxs)("form",{onSubmit:d.handleSubmit(e=>{r({projectRef:t,secrets:e.secrets},{onSuccess:()=>{d.reset({secrets:[{name:"",value:""}]})}})}),className:"space-y-2",children:[u.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,l.jsx)(t$.Wi,{control:d.control,name:"secrets.".concat(t,".name"),render:e=>{let{field:s}=e;return(0,l.jsxs)(t$.xJ,{className:"flex-1",children:[0===t&&(0,l.jsx)(t$.lX,{className:"mb-4",children:"Name"}),(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{placeholder:"SECRET_NAME",...s})}),(0,l.jsx)(t$.zG,{})]})}}),(0,l.jsx)(t$.Wi,{control:d.control,name:"secrets.".concat(t,".value"),render:e=>{let{field:s}=e;return(0,l.jsxs)(t$.xJ,{className:"flex-1",children:[0===t&&(0,l.jsx)(t$.lX,{className:"mb-4",children:"Value"}),(0,l.jsx)(t$.NI,{children:(0,l.jsx)(tV.I,{type:"password",placeholder:"••••••••",...s})}),(0,l.jsx)(t$.zG,{})]})}}),(0,l.jsxs)("div",{className:"w-8",children:[0===t&&(0,l.jsx)(t$.lX,{className:"mb-4 opacity-0",children:"Remove"}),(0,l.jsx)(j.z,{type:"button",variant:"outline",size:"icon",onClick:()=>p(t),disabled:u.length<=1,children:(0,l.jsx)(b.Z,{name:"remove",className:"h-4 w-4"})})]})]},e.id)),(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)(j.z,{type:"button",variant:"outline",size:"sm",onClick:()=>m({name:"",value:""}),children:[(0,l.jsx)(b.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add Secret"]})}),(0,l.jsx)(j.z,{type:"submit",disabled:i,className:"mt-6",children:i?"Creating...":"Create Secrets"})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-semibold mb-4 lg:text-lg",children:"Existing secrets"}),s&&s.length>0?s.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between border-b py-4 last:border-b-0",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-mono text-sm tracking-wider",children:e.name}),e.updated_at&&(0,l.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})]}),(0,l.jsx)(j.z,{variant:"outline",size:"sm",onClick:()=>h(e.name),disabled:c,children:"Delete"})]},e.name)):(0,l.jsxs)(sY.bZ,{children:[(0,l.jsx)(b.Z,{name:"key",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"No secrets found"}),(0,l.jsx)(sY.X,{children:"No secrets found for this project."})]})]})]})}function nb(e){let{projectRef:t}=e,{data:s,isLoading:a,isError:n}=a_(t);return(0,l.jsxs)("div",{className:"pt-4 lg:pt-8",children:[(0,l.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Storage"}),(0,l.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View and manage the files stored in your app."}),a&&(0,l.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"}),(0,l.jsx)(X.O,{className:"h-12 w-full"})]}),n&&(0,l.jsxs)(sY.bZ,{variant:"destructive",className:"mt-8",children:[(0,l.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error loading buckets"}),(0,l.jsx)(sY.X,{children:"There was a problem loading your storage buckets."})]}),s&&s.length>0?(0,l.jsx)("div",{className:"mt-6 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(e=>(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{asChild:!0,children:(0,l.jsxs)(j.z,{variant:"outline",className:"h-auto flex-row justify-start gap-4 p-4 text-left",children:[(0,l.jsx)(b.Z,{name:"folder",className:"h-4 w-4 text-muted-foreground"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h2",{className:"font-semibold mb-1",children:e.name}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Updated ",new Date(e.updated_at).toLocaleDateString()]})]}),(0,l.jsx)(sP.C,{variant:e.public?"default":"secondary",children:e.public?"Public":"Private"})]},e.id)}),(0,l.jsx)(ev._v,{children:(0,l.jsx)("p",{children:"Viewing files is coming soon"})})]},e.id))}):s&&0===s.length?(0,l.jsxs)(sY.bZ,{className:"mt-8",children:[(0,l.jsx)(b.Z,{name:"folder",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"No storage buckets"}),(0,l.jsx)(sY.X,{children:"A bucket is a container used to store and protect files in your app."})]}):null]})}var ny=s(40236);function nw(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n}=aA(t),r=(0,o.useMemo)(()=>{if(!s)return[];let e={ERROR:1,WARN:2,INFO:3};return[...s].sort((t,s)=>(e[t.level]||99)-(e[s.level]||99))},[s]),i=e=>{switch(e){case"ERROR":return"destructive";case"WARN":return"secondary";default:return"outline"}};return(0,l.jsxs)("div",{className:"mx-auto max-w-3xl p-6 pt-4 lg:p-12 lg:pt-12",children:[(0,l.jsx)("h2",{className:"font-semibold mb-1 text-base lg:text-xl",children:"Suggestions"}),(0,l.jsx)("p",{className:"mb-4 text-sm text-muted-foreground lg:mb-8 lg:text-base",children:"Improve your project's security and performance."}),a&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"}),(0,l.jsx)(X.O,{className:"h-6 w-full"})]}),n&&(0,l.jsxs)(sY.bZ,{variant:"destructive",className:"mt-8",children:[(0,l.jsx)(b.Z,{name:"code",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error fetching suggestions"}),(0,l.jsx)(sY.X,{children:(null==n?void 0:n.message)||"An unexpected error occurred. Please try again."})]}),s&&(0,l.jsx)("div",{children:r.length>0?(0,l.jsx)("div",{children:r.map(e=>(0,l.jsx)("div",{className:"group relative border-b py-4 last:border-b-0",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-start justify-start gap-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-sm",children:e.title}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(sP.C,{variant:i(e.level),className:"shrink-0",children:e.level}),e.type&&(0,l.jsx)(sP.C,{variant:"security"===e.type?"destructive":"secondary",className:"shrink-0",children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})]})]}),(0,l.jsx)("div",{className:"prose prose-sm mt-2 max-w-none text-sm text-muted-foreground",children:(0,l.jsx)(ny.UG,{components:{code(e){let{inline:t,children:s,...a}=e;return t?(0,l.jsx)("code",{className:"rounded bg-muted px-1",...a,children:s}):(0,l.jsx)("pre",{className:"overflow-x-auto rounded bg-muted p-2",...a,children:(0,l.jsx)("code",{children:s})})}},children:e.detail})})]})},e.cache_key))}):(0,l.jsxs)(sY.bZ,{children:[(0,l.jsx)(b.Z,{name:"lightbulb_2",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"No suggestions found"}),(0,l.jsx)(sY.X,{children:"Your project looks good! No suggestions at this time."})]})})]})}let nN={users:{label:"New Users",color:"var(--chart-1)"}};function n_(e){let{projectRef:t,timeRange:s}=e,{data:a,isLoading:n,isError:r}=aE(t,s);return(0,l.jsxs)("div",{children:[n&&(0,l.jsx)(X.O,{className:"h-[250px] w-full"}),r&&(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,l.jsx)(sY.Cd,{children:"Error loading chart data"}),(0,l.jsx)(sY.X,{children:"There was a problem loading your chart data."})]}),a&&!n&&(0,l.jsx)(K,{config:nN,className:"aspect-auto h-[250px] w-full",children:(0,l.jsxs)(O.v,{accessibilityLayer:!0,data:a,margin:{left:-24,right:12},children:[(0,l.jsx)(P.q,{vertical:!1}),(0,l.jsx)(T.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,l.jsx)(L.B,{tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,l.jsx)(G,{content:(0,l.jsx)(V,{className:"w-[150px]",labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),indicator:"dot"})}),(0,l.jsx)(F.$,{dataKey:"users",fill:"var(--color-users)"})]})})]})}function nk(e){let{projectRef:t}=e,[s,a]=(0,o.useState)(90);return(0,l.jsxs)("div",{className:"pb-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between pt-4 lg:pt-8",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Users"}),(0,l.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View user signups over time"})]}),(0,l.jsxs)(e3.Ph,{value:String(s),onValueChange:e=>a(Number(e)),children:[(0,l.jsx)(e3.i4,{className:"w-[160px] rounded-lg sm:ml-auto","aria-label":"Select a value",children:(0,l.jsx)(e3.ki,{placeholder:"Select time range"})}),(0,l.jsxs)(e3.Bw,{className:"rounded-xl",children:[(0,l.jsx)(e3.Ql,{value:"90",className:"rounded-lg",children:"Last 90 days"}),(0,l.jsx)(e3.Ql,{value:"30",className:"rounded-lg",children:"Last 30 days"}),(0,l.jsx)(e3.Ql,{value:"7",className:"rounded-lg",children:"Last 7 days"})]})]})]}),(0,l.jsx)("div",{className:"px-8",children:(0,l.jsx)(n_,{projectRef:t,timeRange:s})}),(0,l.jsx)(na,{hideChartOption:!0,projectRef:t,initialSql:"SELECT * FROM auth.users ORDER BY created_at DESC LIMIT 100;",initialNaturalLanguageMode:!0,label:"Recent users",hideSql:!0,readOnly:!0,runAutomatically:!0})]})}var nS=s(66070),nC=s(72253),nE=s(37675);let nz=e=>{let{projectId:t,disabled:s}=e,[a,n]=(0,o.useState)(!1),r=()=>n(!1),i=(0,th.D)({mutationFn:()=>(0,g.SJ)().post("/projects/".concat(t,"/supabase/disconnect")),onSuccess:()=>{(0,eU.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."}),r()},onError:e=>{eU.Am.error("Error",{description:e.message})}});return(0,l.jsxs)(ty.Vq,{open:a,onOpenChange:n,children:[(0,l.jsx)(ty.hg,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",disabled:s,children:"Disconnect"})}),(0,l.jsxs)(ty.cZ,{size:"sm",children:[(0,l.jsxs)(ty.fK,{children:[(0,l.jsx)(ty.$N,{children:"Disconnect Supabase"}),(0,l.jsx)(ty.Be,{children:"Are you sure you want to disconnect Supabase?"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"We will stop deploying edge functions and reading your database schema, but no changes will be made to your code. You can reconnect to Supabase later."}),(0,l.jsxs)(ty.cN,{children:[(0,l.jsx)(j.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,l.jsx)(j.z,{variant:"destructive",onClick:()=>{i.mutate()},loading:i.isPending,children:"Disconnect"})]})]})]})},nA=e=>{let{projectId:t}=e,s=(0,nE.bk)(e=>e.isSendChatMessageMutationPending);return(0,l.jsx)(eG.P,{label:"Disconnect Project",description:"Remove the Supabase project from this Lovable project.",justify:"end",children:(0,l.jsx)(nz,{projectId:t,disabled:s})})};var nI=s(78844);let nD=e=>{var t;let{workspace:s,myWorkspaceRole:a,setShowConnectDialog:n}=e,{isLoading:r,noOrganizations:i}=(0,nC.S)({workspaceId:s.id}),{handleConnect:o,isConnecting:c}=(0,nI.hb)(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:""),d="admin"===a||"owner"===a;return(0,l.jsx)(eG.P,{label:"Organizations",description:"Connected Supabase organizations will be accessible to all members in this workspace.",justify:"end",badges:["admin"],children:r?(0,l.jsx)(X.O,{className:"h-7 w-40"}):i?(0,l.jsxs)(j.z,{disabled:c||!d,onClick:o,size:"sm",loading:c,children:[(0,l.jsx)(tT.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}):(0,l.jsx)(j.z,{disabled:c||!d,onClick:()=>n(!0),size:"sm",variant:"outline",children:"Manage Connected Organizations"})})};var nO=s(38343);let nP=e=>{let{setStep:t,workspace:s,supabaseOrganizations:a,handleConnect:n,isConnecting:r,showConnectStep:i}=e,o=0===a.length;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sS,{title:"Linked Supabase Organizations",description:"Anyone in your Lovable workspace can view and link Supabase projects..",badge:"admin"}),(0,l.jsx)(e9.Separator,{}),(0,l.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,l.jsx)(sE,{workspace:s}),(0,l.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Supabase Organizations"}),a.map(e=>{let t="connected"===e.status;return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full border bg-muted",children:(0,l.jsx)(tT.xR.Supabase,{className:"h-4 w-4"})}),(0,l.jsx)("p",{className:"font-medium",children:e.name}),!t&&(0,l.jsx)(j.z,{variant:"default",size:"sm",className:"ml-auto",onClick:n,disabled:r,children:"Reconnect"})]},e.id)}),(0,l.jsx)(j.z,{variant:"outline",className:"mt-auto w-full",onClick:n,size:"sm",children:o?"Add Organization":"Add More Organizations"})]})]}),(0,l.jsx)(e9.Separator,{}),i&&(0,l.jsx)(sC,{children:(0,l.jsx)(j.z,{onClick:()=>t("connect"),className:"ml-auto",size:"sm",disabled:0===a.length,children:"Continue"})})]})};var nT=s(93459),nL=s(27559);let nR=e=>{let{setStep:t,supabaseOrganizations:s,closeDialog:a}=e,n=(0,sU.D)(),r=(0,nE.bk)(e=>e.isSendChatMessageMutationPending),[i,c]=(0,o.useState)(null),{handleProjectSelect:d,isConnecting:u}=(0,nT._)(n,a),m=u||r;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sS,{title:"Connect Project",description:"Select a project of one of your connected Supabase organizations to connect it to your Lovable project."}),(0,l.jsx)(e9.Separator,{}),(0,l.jsx)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:s.map(e=>{let t=[...e.projects].sort((e,t)=>(0,nL.u)(e)&&!(0,nL.u)(t)?-1:(0,nL.u)(t)&&!(0,nL.u)(e)?1:0),s=0===t.length;return(0,l.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.name}),t.map(e=>{let t=(0,nL.u)(e),s=i===e.id;return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("p",{className:"font-medium",children:e.name}),!t&&(0,l.jsx)(td.b,{showTooltip:!t,tooltipContent:"Check project status in Supabase.",instant:!0,children:(0,l.jsx)(b.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"})},e.id)]}),(0,l.jsx)(j.z,{size:"sm",disabled:!t||m,onClick:()=>{c(e.id),d(e)},loading:s&&m,children:s&&m?"Connecting":"Connect"})]},e.id)}),(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[s&&(0,l.jsx)("p",{className:"w-full text-sm text-muted-foreground",children:"No Supabase projects found for this organization."}),(0,l.jsx)(j.z,{size:"sm",variant:s?"default":"secondary",className:"ml-auto w-fit",asChild:!0,children:(0,l.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",children:[(0,l.jsx)(tT.xR.Supabase,{className:"h-3 w-3"}),"Create Project"]})})]})]},e.id)})}),(0,l.jsx)(e9.Separator,{}),(0,l.jsx)(sC,{children:(0,l.jsx)(j.z,{variant:"outline",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},nF=e=>{var t;let{workspace:s,showConnectStep:a,showConnectDialog:n,setShowConnectDialog:r}=e,[i,c]=(0,o.useState)("organizations"),{supabaseOrganizations:d}=(0,nC.S)({workspaceId:s.id}),{handleConnect:u,isConnecting:m}=(0,nI.hb)(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:"");return(0,l.jsxs)(ty.Vq,{open:n,onOpenChange:e=>{r(e),e||c("organizations")},children:[(0,l.jsx)(ty.hg,{asChild:!0,className:"hidden",children:(0,l.jsx)(j.z,{size:"sm",children:"Connect Supabase"})}),(0,l.jsx)(sk,{children:"organizations"===i?(0,l.jsx)(nP,{setStep:c,workspace:s,supabaseOrganizations:null!=d?d:[],handleConnect:u,isConnecting:m,showConnectStep:a}):(0,l.jsx)(nR,{setStep:c,supabaseOrganizations:null!=d?d:[],closeDialog:()=>{r(!1),c("organizations")}})})]})};var nZ=e=>{let t=(0,e4.iZ)(e=>e.project),s=null==t?void 0:t.supabase_project_config,a=!!(null==s?void 0:s.supabase_project_id);return(0,l.jsx)(nF,{...e,showConnectStep:!a})},nM=s(15492);let nU=e=>{let{isConnectedToSupabase:t}=e,[s,a]=(0,nM.B)("supabase-explainer",{defaultValue:!0}),[n,r]=(0,o.useState)(!1);return t||!s?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"rounded-md border border-border/50 bg-muted/20 p-4",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,l.jsx)(b.Z,{name:"info",size:"small",className:"text-muted-foreground"}),(0,l.jsx)("h3",{className:"text-sm font-medium",children:"What is Supabase?"}),(0,l.jsx)(j.z,{variant:"ghost",className:"ml-auto hover:bg-transparent",size:"icon-sm",onClick:()=>a(!1),children:(0,l.jsx)(b.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supabase is a complete platform for building apps with user authentication, data storage, and other backend capabilities. Connecting it to your Lovable project will enable you to build more advanced apps and support things such as AI features and payments."}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 pt-2",children:[(0,l.jsxs)("a",{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,l.jsx)(b.Z,{name:"menu_book",size:"small"}),"See docs"]}),(0,l.jsxs)("button",{onClick:()=>r(!0),className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,l.jsx)(b.Z,{name:"play_circle",size:"small"}),"Watch tutorial"]})]})]})}),(0,l.jsx)(ty.Vq,{open:n,onOpenChange:r,children:(0,l.jsx)(ty.cZ,{className:"max-w-4xl p-0",children:(0,l.jsx)("div",{className:"aspect-video w-full",children:(0,l.jsx)("iframe",{src:"https://www.youtube.com/embed/eVHg4wipRrU",title:"Supabase Tutorial",className:"h-full w-full rounded-lg",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})})]})},nq=e=>{var t,s;let{workspace:a,isInsideEditor:n,myWorkspaceRole:r,project:i}=e,[c,d]=(0,o.useState)(!1),u=(0,o.useCallback)(()=>{n&&d(!0)},[n]);(0,nC.I)({workspaceId:a.id,onConnectSuccess:u});let m=null==i?void 0:null===(t=i.enabled_integrations)||void 0===t?void 0:t.includes("supabase_exp");return(0,l.jsx)(p.tM,{value:"supabase",title:m?"Backend":"Supabase",description:"Integrate user authentication, data storage, and backend capabilities.",docsLink:"https://docs.lovable.dev/integrations/supabase",children:(null==i?void 0:null===(s=i.enabled_integrations)||void 0===s?void 0:s.includes("supabase_exp"))?(0,l.jsx)(nJ,{}):(0,l.jsxs)(l.Fragment,{children:[i?(0,l.jsx)(nZ,{workspace:a,showConnectDialog:c,setShowConnectDialog:d}):(0,l.jsx)(nF,{workspace:a,showConnectDialog:c,setShowConnectDialog:d}),i&&(0,l.jsx)(nK,{workspace:a,myWorkspaceRole:r,setShowConnectDialog:d}),(0,l.jsx)(nW,{workspace:a,myWorkspaceRole:r,isInsideEditor:n,showConnectDialog:c,setShowConnectDialog:d})]})})},nW=e=>{let{workspace:t,myWorkspaceRole:s,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r}=e;return(0,l.jsx)(nD,{workspace:t,myWorkspaceRole:s,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r})},nK=e=>{var t,s,a;let{workspace:n,myWorkspaceRole:r,setShowConnectDialog:i}=e,o=(0,e4.iZ)(e=>e.project),c=null==o?void 0:o.supabase_project_config,d=!!(null==o?void 0:o.is_supabase_enabled),u=(0,nC.S)({workspaceId:n.id}),m=(0,s7.Z)(u,c),p=null==o?void 0:o.creation_options.tech_stack,h=(null==c?void 0:c.supabase_project_id)&&!m,x=null===(t=u.supabaseOrganizations)||void 0===t?void 0:t.flatMap(e=>e.projects||[]),f=null==x?void 0:x.find(e=>e.id===(null==c?void 0:c.supabase_project_id)),v=null==o?void 0:o.id,b=(0,th.D)({mutationFn:()=>(0,g.SJ)().post("/projects/".concat(v,"/supabase/disconnect")),onSuccess:()=>{(0,eU.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."})},onError:e=>{eU.Am.error("Error",{description:e.message})}}),y=null===(s=u.supabaseOrganizations)||void 0===s?void 0:s.find(e=>e.id===(null==c?void 0:c.supabase_organization_id));if(!o)return null;if(d||p&&"vite_react_shadcn_ts"!==p)return(0,l.jsx)("div",{className:"text-sm",children:"Unfortunately, your project is not able to use Supabase."});let w=u.noOrganizations;return u.isLoading?(0,l.jsx)(sg.T,{text:"Loading Supabase..."}):(0,l.jsxs)(l.Fragment,{children:[!y&&!!(null==c?void 0:c.supabase_organization_id)&&(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(sY.Cd,{children:"Problem with your Supabase connection"}),(0,l.jsxs)(sY.X,{children:[(0,l.jsxs)("p",{children:["This project is connected to Supabase organization"," ",(0,l.jsx)("span",{className:"rounded-md bg-muted px-1 py-0.5 font-mono font-medium text-muted-foreground",children:null==c?void 0:c.supabase_organization_id}),", but this workspace is not connected to that organization. Disconnect the project or add the organization again."]}),(0,l.jsx)("div",{className:"mt-4 flex",children:(0,l.jsx)(j.z,{variant:"destructive",onClick:()=>b.mutate(),disabled:b.isPending,size:"sm",children:"Disconnect"})})]})]}),(0,l.jsx)(nU,{isConnectedToSupabase:!u.noOrganizations}),!w&&(0,l.jsx)(nO.c,{supabaseOrganizations:null!==(a=u.supabaseOrganizations)&&void 0!==a?a:[],connectedSupabaseProject:null!=f?f:null,setShowConnectDialog:i,isWorkspaceAdmin:"admin"===r||"owner"===r}),h&&f&&(0,l.jsx)(nA,{projectId:null==o?void 0:o.id})]})},nJ=()=>{let e=(0,e4.iZ)(e=>e.project),t=null==e?void 0:e.id,{data:s,isLoading:a}=(0,x.a)({queryKey:["supabase-integration-data",t],queryFn:()=>(0,g.SJ)().get("/projects/".concat(t,"/integrations/supabase_exp")),enabled:!!t});if(a)return(0,l.jsx)(sg.T,{text:"Loading..."});if(!s)return(0,l.jsx)("div",{children:(0,l.jsxs)(sY.bZ,{variant:"default",children:[(0,l.jsx)(sY.Cd,{children:"Chat with the AI to create a backend"}),(0,l.jsx)(sY.X,{children:(0,l.jsx)("p",{children:"The AI will automatically create a backend for your project when needed."})})]})});let n=s.ProjectID,r=[{title:"Database",icon:s1.Z,component:(0,l.jsx)(no,{projectRef:n})},{title:"Storage",icon:s2.Z,component:(0,l.jsx)(nb,{projectRef:n})},{title:"Auth",icon:s4.Z,component:(0,l.jsx)(aB,{projectRef:n})},{title:"Users",icon:s5.Z,component:(0,l.jsx)(nk,{projectRef:n})},{title:"Secrets",icon:s6.Z,component:(0,l.jsx)(nv,{projectRef:n})},{title:"Logs",icon:s3.Z,component:(0,l.jsx)(nj,{projectRef:n})},{title:"Suggestions",icon:s8.Z,component:(0,l.jsx)(nw,{projectRef:n})}];return(0,l.jsx)(as,{onStackEmpty:()=>{},initialStack:[],children:(0,l.jsx)(nG,{navigationItems:r})})},nG=e=>{let{navigationItems:t}=e,{push:s}=aa();return(0,l.jsx)(an,{navigationItems:t,children:(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4 pb-4 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>{let{title:t,component:a,icon:n}=e;return(0,l.jsx)(nS.Zb,{className:"cursor-pointer border-muted-foreground/10 bg-muted p-4 hover:bg-muted/50",onClick:()=>{s({title:t,component:a})},children:(0,l.jsx)(nS.Ol,{children:(0,l.jsxs)(nS.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(n,{className:"h-4 w-4 flex-shrink-0"}),t]})})},t)})})})};var nV=s(99376),nB=s(44956),nH=s(48581),nY=s(7355),nQ=s(108),nX=s(7309),n$=s(60610);let n0=o.forwardRef((e,t)=>{let{className:s,value:a,...n}=e;return(0,l.jsx)(n$.fC,{ref:t,className:(0,U.cn)("relative h-4 w-full overflow-hidden rounded-full bg-muted-active",s),...n,children:(0,l.jsx)(n$.z$,{className:"h-full w-full flex-1 bg-brand-twilight-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});n0.displayName=n$.fC.displayName;var n1=s(59053),n2=s(79358);let n4=e=>{let{workspace:t,myWorkspaceRole:s}=e,{billingPeriodCreditLimit:a,billingPeriodCreditsUsed:n,dailyCreditLimit:r,dailyCreditsUsed:i,rolloverCredits:o,billingPeriodEndDate:c}=(0,n1.O)({projectWorkspace:t}),d=t.plan,u=(0,tl.fA)(d),m=(0,tl.B9)(d),p="ambassador"===d,h=(u||p)&&0===t.billing_period_credits_limit,x=h?null!=i?i:0:null!=n?n:0,g=h?null!=r?r:0:null!=a?a:0,f=(0,tl.Iw)(d),j=(0,nX.oW)({id:d,type:"monthly"});return m||u||p?(0,l.jsxs)(nS.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"font-medium text-foreground",children:"Credits"}),(0,l.jsx)("span",{className:"text-sm font-medium text-foreground",children:(0,n2.u)(x,g)})]}),(0,l.jsx)(n0,{value:x/g*100,className:"h-[11px] w-full"}),void 0!==o&&o>0&&(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,n2.H)(o)," rollover credits available"]}),("admin"===s||"owner"===s)&&(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[u?(0,l.jsxs)(l.Fragment,{children:["You're currently on a legacy plan:"," ",(0,l.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo. You're welcome to stay on this plan — but if you're curious to explore our new plans, you'll get 20% off for the first 3 months."," ",(0,l.jsx)(n5,{workspace:t,children:"Manage your payment preferences"}),", or change to one of our new plans below."]}):(0,l.jsxs)(l.Fragment,{children:["You're currently subscribed to plan:"," ",(0,l.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo."," ",(0,l.jsx)(n5,{workspace:t,children:"Manage your payment preferences"}),", or change your plan below."]})," ",!h&&(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:c?"Your monthly credits will renew on ".concat((0,I.WU)(c,"MMMM d")," at ").concat((0,I.WU)(c,"HH:mm"),"."):"Your credits will renew each month (at midnight UTC)."})]})]}):"inactive"!==d?(0,l.jsx)(nS.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,l.jsxs)("span",{children:["You're currently on plan:"," ",(0,l.jsx)("span",{className:"font-medium capitalize",children:f}),". "]})," ",(0,l.jsx)(n5,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},n5=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nQ.m)();return(0,l.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},n6=[{value:"too_expensive",label:"Too expensive",description:"The current plan doesn't fit my budget"},{value:"not_using",label:"Not using enough",description:"I'm not using all the features or credits"},{value:"missing_features",label:"Missing features",description:"The features I need aren't available"},{value:"other",label:"Other reason",description:"None of the above reasons apply"}],n3=[{id:"custom-domains",name:"Custom domains",description:"Connect your own domain to your projects"},{id:"team-collab",name:"Team collaboration",description:"Invite team members to work together"},{id:"visual-editor",name:"Visual editor",description:"Edit the frontend of your project instantly"},{id:"code-editor",name:"Code editor",description:"Edit the backend of your project in code"},{id:"chat-mode",name:"Chat mode",description:"Plan your next step with AI"},{id:"security-checks",name:"Security checks",description:"Run checks when publishing with Supabase to find and fix vulnerabilities"}];var n8=s(48351);(n=i||(i={})).FEATURES_TO_TRY="FEATURES_TO_TRY",n.KTLO_OFFER="KTLO_OFFER",n.FEEDBACK="FEEDBACK",n.FINAL_CONFIRMATION="FINAL_CONFIRMATION";let n7=(0,o.createContext)(void 0),n9=e=>{let{children:t,targetPlan:s,onCancel:a,workspace:n}=e,r=(0,to.f7)(),c=n.plan!==n8.It.KTLO&&r&&s===tl.tJ.FREE,[d,u]=(0,o.useState)(i.FEATURES_TO_TRY),[m,p]=(0,o.useState)({reason:""}),[h,x]=(0,o.useState)(!1),g=(0,nH.tS)(),{toCheckout:f}=(0,nQ.m)(),j=async()=>{x(!0),(null==n?void 0:n.id)&&(s===tl.tJ.FREE?await g.createPortalSession():await f({plan:g.selectedProPlan,workspaceId:n.id,grandfatheredDiscount:!1,planType:g.planType,changeType:"downgrade"}))},v=async()=>{x(!0);try{(null==n?void 0:n.id)&&await f({plan:nX.Ds,workspaceId:n.id,grandfatheredDiscount:!1,planType:"monthly",changeType:"upgrade"})}catch(e){console.error("Error switching to KTLO plan:",e),x(!1)}},b={currentStep:d,feedback:m,currentPlan:n.plan,targetPlan:s,shouldShowKtloOffer:c,setCurrentStep:u,setFeedback:p,onCancel:a,onConfirm:j,onSwitchToKtlo:v,isLoading:h,getNextStepAfterFeatures:()=>c?i.KTLO_OFFER:i.FEEDBACK,getNextStepAfterKtlo:()=>i.FEEDBACK,getPreviousStepBeforeFeedback:()=>c?i.KTLO_OFFER:i.FEATURES_TO_TRY,getPreviousStepBeforeFinalConfirmation:()=>i.FEEDBACK};return(0,l.jsx)(n7.Provider,{value:b,children:t})},re=()=>{let e=(0,o.useContext)(n7);if(void 0===e)throw Error("useDowngrade must be used within a DowngradeProvider");return e},rt=()=>{let{onCancel:e,setCurrentStep:t,getNextStepAfterFeatures:s}=re();return(0,l.jsx)(nS.Zb,{className:"bg-muted p-4 md:p-6",children:(0,l.jsxs)("div",{className:"flex flex-col md:gap-6",children:[(0,l.jsx)("div",{className:"flex flex-col gap-3 md:gap-4",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(se.Label,{className:"text-lg md:text-xl",children:"Have you tried these features yet?"}),(0,l.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:n3.map(e=>(0,l.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,l.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:"•"}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,l.jsx)(se.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))})]})}),(0,l.jsxs)("div",{className:"flex flex-col justify-end gap-3 sm:flex-row",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{eM.ZP.capture(e2.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e()},className:"w-full sm:w-auto",children:"Keep Current Plan"}),(0,l.jsx)(j.z,{onClick:()=>{eM.ZP.capture(e2.f8.FEATURE_USAGE.CONTINUE_CLICKED),t(s())},className:"w-full sm:w-auto",children:"Continue Downgrading"})]})]})})},rs=()=>{var e;let{feedback:t,setFeedback:s,setCurrentStep:a,getPreviousStepBeforeFeedback:n}=re();return(0,l.jsx)(nS.Zb,{className:"bg-muted p-6",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,l.jsx)(se.Label,{className:"text-2xl",children:"Why are you downgrading?"}),(0,l.jsx)(st.E,{value:t.reason,onValueChange:e=>s({...t,reason:e}),className:"flex flex-col gap-1",children:n6.map(e=>(0,l.jsxs)("div",{className:(0,U.cn)("flex items-start gap-4 rounded-lg px-3 py-1.5","cursor-pointer transition-colors",t.reason===e.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>s({...t,reason:e.value}),children:[(0,l.jsx)(st.m,{value:e.value,id:e.value,className:"mt-2"}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,l.jsx)(se.Label,{htmlFor:e.value,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.label}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.value))})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,l.jsx)(se.Label,{htmlFor:"additional-feedback",className:"text-base",children:"Additional feedback (optional)"}),(0,l.jsx)(e1.g,{id:"additional-feedback",placeholder:"Tell us more about your decision...",value:t.additionalNotes,onChange:e=>s({...t,additionalNotes:e.target.value}),maxLength:500,className:"min-h-[80px] resize-none border-muted-foreground/20 bg-background placeholder:text-muted-foreground/50 focus:border-primary focus:ring-1 focus:ring-primary"}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null===(e=t.additionalNotes)||void 0===e?void 0:e.length)||0,"/500 characters"]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 pt-1",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{eM.ZP.capture(e2.f8.FEEDBACK.BACK_CLICKED),a(n())},children:"Back"}),(0,l.jsx)(j.z,{variant:"default",onClick:()=>{eM.ZP.capture(e2.f8.FEEDBACK.CONTINUE_CLICKED,{reason:t.reason,has_additional_notes:!!t.additionalNotes,additional_notes:t.additionalNotes||""}),a(i.FINAL_CONFIRMATION)},children:"Continue"})]})]})})},ra=(e,t)=>{var s,a;let n=(0,tl.Ll)(e),r=(0,tl.Ll)(t),i=null!==(s=(0,nX.z_)(e))&&void 0!==s?s:0,l=null!==(a=(0,nX.z_)(t))&&void 0!==a?a:0;if("ktlo"===r)return"pro"===n?["Credits will change from ".concat(i," per month to freemium (5 per day, up to 30 per month)"),"Active AI features will be limited to freemium"]:[];if("pro"===n){if("pro"===r)return["Credits will decrease from ".concat(i," to ").concat(l," per month"),"Same pro features will be maintained at a lower tier"];if("free"===r)return["All new projects will be public","A Lovable badge will be added to all new projects","You will lose team management features","Custom domains will be removed","Credits will reset to 5 per day"]}return[]},rn=tQ.z.object({reason:tQ.z.string().optional(),additional_notes:tQ.z.string().max(500,"Additional notes must be less than 500 characters").optional()}),rr=()=>{let{currentPlan:e,targetPlan:t,onConfirm:s,isLoading:a,setCurrentStep:n,feedback:r,getPreviousStepBeforeFinalConfirmation:i}=re(),o=(0,g.SJ)(),c=(0,th.D)({mutationFn:async()=>{let e=rn.parse({reason:r.reason,additional_notes:r.additionalNotes});await o.post("/user/cancellation",e),await s()},onSuccess:()=>{eM.ZP.capture(e2.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e,to_plan:t})},onError:e=>{if(eB.logging.error("Error submitting feedback:",e),e instanceof tQ.z.ZodError){let t=e.errors[0];eU.Am.error("Validation Error",{description:t.message})}else{var t;eU.Am.error("Error",{description:(null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to submit feedback"})}}}),d=ra(e,t);return(0,l.jsx)(nS.Zb,{className:"bg-muted",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 text-amber-500",children:[(0,l.jsx)(b.Z,{name:"warning_fill",size:"small"}),(0,l.jsx)("h2",{className:"text-lg font-medium",children:"Confirm Plan Downgrade"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"mb-4 text-muted-foreground",children:d.length>0?"By downgrading to the ".concat((0,tl.Ll)(t)," plan, you will lose access to the following features:"):"By downgrading to the ".concat((0,tl.Ll)(t)," plan, you will lose access to some features of your current plan.")}),d.length>0&&(0,l.jsx)("ul",{className:"list-disc space-y-2 pl-6",children:d.map((e,t)=>(0,l.jsx)("li",{className:"text-foreground",children:e},t))})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{eM.ZP.capture(e2.f8.FINAL_CONFIRMATION.BACK_CLICKED),n(i())},children:"Back"}),(0,l.jsx)(j.z,{variant:"destructive",onClick:()=>{c.mutate()},disabled:c.isPending||a,children:c.isPending||a?"Processing...":"Confirm Downgrade"})]})]})})};var ri=s(33145);let rl=()=>{let{setCurrentStep:e,feedback:t,onSwitchToKtlo:s,isLoading:a,getNextStepAfterKtlo:n}=re(),r=async()=>{eM.ZP.capture(e2.f8.KTLO_OFFER.SWITCH_CLICKED,{reason:t.reason}),await s()};return(0,l.jsxs)(nS.Zb,{className:"border-border bg-muted",children:[(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-8 lg:flex-row lg:gap-12",children:[(0,l.jsxs)("div",{className:"flex max-w-md flex-col justify-center",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"mb-3 text-3xl font-medium text-foreground",children:"Switch to Lite"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Try our new Lite plan and retain important features that keep your project going."})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("p",{className:"mb-2 font-medium text-foreground",children:"What's included:"}),(0,l.jsx)("ul",{className:"flex flex-col gap-2",children:["5 daily credits up to a maximum of 30 per month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,t)=>(0,l.jsxs)("li",{className:"flex items-center gap-3",children:[(0,l.jsx)(b.Z,{name:"check",size:"small",className:"flex-shrink-0 text-success-primary"}),(0,l.jsx)("span",{className:"text-foreground",children:e})]},t))})]}),(0,l.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,l.jsx)("span",{className:"text-5xl font-medium text-foreground",children:"$15"}),(0,l.jsx)("span",{className:"text-lg text-muted-foreground",children:"/month"})]})]}),(0,l.jsx)("div",{className:"flex w-full flex-1 items-center justify-center",children:(0,l.jsx)("div",{className:"h-full max-h-80 w-full max-w-lg overflow-hidden rounded-2xl lg:max-h-96",children:(0,l.jsx)(ri.default,{src:"/img/lovable-lite.webp",alt:"Lite Plan",className:"h-full w-full object-cover",width:500,height:400})})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{eM.ZP.capture(e2.f8.KTLO_OFFER.BACK_CLICKED),e(i.FEATURES_TO_TRY)},children:"Back"}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:()=>{eM.ZP.capture(e2.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED,{reason:t.reason}),e(n())},children:"No, thank you"}),(0,l.jsx)(j.z,{onClick:r,disabled:a,className:"bg-foreground text-background hover:bg-foreground/90",children:a?"Switching...":"Switch to Lite"})]})]})]})},ro=()=>{let{currentStep:e}=re();switch(e){case i.FEATURES_TO_TRY:return(0,l.jsx)(rt,{});case i.KTLO_OFFER:return(0,l.jsx)(rl,{});case i.FEEDBACK:return(0,l.jsx)(rs,{});case i.FINAL_CONFIRMATION:return(0,l.jsx)(rr,{});default:return null}};ro.displayName="DowngradeContent";let rc=e=>{let{targetPlan:t,onCancel:s,workspace:a}=e;return(0,l.jsx)(n9,{targetPlan:t,onCancel:s,workspace:a,children:(0,l.jsx)(ro,{})})},rd=e=>{let{workspace:t,myWorkspaceRole:s,open:a,onOpenChange:n}=e,[r,i]=(0,o.useState)(!1),{createPortalSession:c,isCreatePortalSessionLoading:d,setFreePlanAsTarget:u,onDowngradeClick:m}=(0,nH.tS)(),p=async()=>{await c()},h=async()=>{await c()},x=()=>{n(!1),setTimeout(()=>{i(!1)},200)},g="free"===t.plan,f="free"===t.plan_scheduled;return r?(0,l.jsx)(ty.Vq,{open:a,onOpenChange:x,children:(0,l.jsxs)(ty.cZ,{className:"max-h-[90vh] overflow-y-auto md:max-w-4xl",children:[(0,l.jsxs)(ty.fK,{children:[(0,l.jsx)(ty.$N,{children:"Switch Plan"}),(0,l.jsx)(ty.Be,{children:"Choose a plan that fits your needs. You can change or cancel your subscription at any time."})]}),(0,l.jsx)(nB.om,{planCardContext:"billing",workspace:t,myWorkspaceRole:s,children:(0,l.jsx)(nY.SV,{className:"w-full",showEnterprise:!0})}),(0,l.jsx)(ty.cN,{children:(0,l.jsx)(j.z,{type:"button",variant:"outline",onClick:()=>{i(!1)},children:"Back"})})]})}):(0,l.jsx)(ty.Vq,{open:a,onOpenChange:x,children:(0,l.jsxs)(ty.cZ,{className:"sm:max-w-[500px]",children:[(0,l.jsxs)(ty.fK,{children:[(0,l.jsx)(ty.$N,{children:"Manage Plan"}),(0,l.jsx)(ty.Be,{children:"Manage your subscription and billing preferences."})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h4",{className:"font-medium",children:"Payment Preferences"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update payment methods, view invoices, and manage billing information."}),(0,l.jsx)(j.z,{onClick:p,disabled:d,className:"w-full",children:d?"Opening...":"Manage Payment Preferences"})]}),!g&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"h-px bg-border"}),(0,l.jsx)("div",{className:"space-y-2",children:f?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"font-medium",children:"Cancel Downgrade"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"You have a scheduled downgrade to free. Cancel it to keep your current plan."}),(0,l.jsx)(j.z,{onClick:h,disabled:d,variant:"outline",className:"w-full",children:d?"Opening...":"Cancel Downgrade"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"font-medium",children:"Downgrade Plan"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Downgrade to the free plan if you no longer need premium features."}),(0,l.jsx)(j.z,{onClick:()=>{u(),null==m||m(),n(!1)},variant:"outline",className:"w-full",children:"Downgrade to Free"})]})})]})]}),(0,l.jsx)(ty.cN,{children:(0,l.jsx)(j.z,{type:"button",variant:"outline",onClick:x,children:"Cancel"})})]})})};var ru=s(33245);let rm=e=>{let{workspace:t,shouldDisableWorkspaceAdminActions:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nH.tS)();if(!t.plan_scheduled)return null;let r=(0,tl.Iw)(t.plan),i=(0,tl.Iw)(t.plan_scheduled),o=t.billing_period_end_date?(0,I.WU)(t.billing_period_end_date.toDate(),"MMM d, yyyy"):"";return(0,l.jsx)("div",{className:"space-y-3",children:(0,l.jsx)("div",{className:"space-y-3 rounded-md bg-warning p-3",children:(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)(ru.Z,{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-warning-primary"}),(0,l.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-sm font-medium text-warning-primary",children:["Pending changes scheduled for ",o]}),(0,l.jsxs)("p",{className:"text-sm text-warning-primary",children:[r," → ",i]})]}),(0,l.jsx)("div",{children:(0,l.jsx)(j.z,{variant:"warning",size:"default",disabled:n||s,onClick:()=>{a()},children:n?"Opening...":"Cancel changes"})})]})]})})})},rp=e=>{var t;let{workspace:s,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1),{billingPeriodCreditLimit:i,billingPeriodCreditsUsed:c,dailyCreditLimit:d,dailyCreditsUsed:u,rolloverCredits:m}=(0,n1.O)({projectWorkspace:s}),{currentPlan:p,shouldDisableWorkspaceAdminActions:h}=(0,nH.tS)(),x=null!==(t=(0,nX.oW)(p))&&void 0!==t?t:0,g="monthly"===p.type,f=(0,tl.Iw)(p.id),v=s.plan,b=(0,tl.fA)(p.id),y=(0,tl.XB)(v),w="ambassador"===p.id,N=(b||w)&&0===s.billing_period_credits_limit,_=N?null!=u?u:0:null!=c?c:0,k=N?null!=d?d:0:null!=i?i:0,S=s.billing_period_end_date?(0,I.WU)(s.billing_period_end_date.toDate(),"MMM d, yyyy"):"",C=g?k:12*k;if(y)return(0,l.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,l.jsx)(rm,{workspace:s,shouldDisableWorkspaceAdminActions:h}),(0,l.jsx)(nS.Zb,{className:"border border-muted-border bg-muted p-4 shadow-sm",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("h3",{className:"font-medium text-foreground",children:[f," Plan"]})}),(0,l.jsx)("div",{className:"md:hidden",children:(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["$",g?x:12*x," ","per ",g?"month":"year"," •"," ",s.plan_scheduled?"Cancels":"Renews"," ",S]})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-4 md:justify-end",children:[(0,l.jsx)("div",{className:"hidden text-right md:block",children:(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["$",g?x:12*x," ","per ",g?"month":"year"," •"," ",s.plan_scheduled?"Cancels":"Renews"," ",S]})}),(0,l.jsx)(j.z,{variant:"outline",disabled:h,onClick:()=>r(!0),children:"Manage plan"})]})]})}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"font-medium text-foreground",children:"Credits"}),(0,l.jsx)("div",{className:"flex h-full flex-col justify-center",children:(0,l.jsx)("div",{className:"space-y-4 pb-2",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:"Rollover"}),(0,l.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[(null!=m?m:0).toFixed(2),"/",C]})]}),(0,l.jsx)(n0,{value:C>0?(null!=m?m:0)/C*100:0,className:"h-[11px] w-full"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:"Monthly"}),(0,l.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[_.toFixed(2),"/",k]})]}),(0,l.jsx)(n0,{value:C>0?_/C*100:0,className:"h-[11px] w-full"})]})]})})})]})]})}),(0,l.jsx)(rd,{workspace:s,myWorkspaceRole:a,open:n,onOpenChange:r})]});if("inactive"!==v){let e=(0,tl.Iw)(v);return(0,nX.oW)({id:v,type:"monthly"}),(0,l.jsx)(nS.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,l.jsxs)("span",{children:["You're currently on plan:"," ",(0,l.jsx)("span",{className:"font-medium capitalize",children:e}),". "]})," ",(0,l.jsx)(rh,{workspace:s,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})})}},rh=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nQ.m)();return(0,l.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},rx=e=>{var t,s;let{workspace:a,showDowngradeConfirmation:n,setShowDowngradeConfirmation:r}=e,i=(0,nH.tS)();return n?(0,l.jsx)(rc,{workspace:a,targetPlan:null!==(s=null===(t=i.targetDowngradePlan)||void 0===t?void 0:t.id)&&void 0!==s?s:tl.tJ.FREE,onCancel:()=>{i.setTargetDowngradePlan(null),r(!1)}}):(0,l.jsx)(nY.SV,{className:"w-full",showEnterprise:!0})},rg=e=>{let{workspace:t,myWorkspaceRole:s}=e,a="inactive"===t.plan,[n,r]=(0,o.useState)(!1),[i,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),m=(0,nV.useSearchParams)();(0,o.useEffect)(()=>{let e=m.get("planChanged"),t=m.get("planName");if("true"===e&&t){u({planName:t}),c(!0);let e=new URL(window.location.href);e.searchParams.delete("planChanged"),e.searchParams.delete("planName"),window.history.replaceState({},"",e.toString())}},[m]);let h=(0,to.Kq)();return(0,l.jsxs)(p.tM,{title:"Plans & Billing",value:"billing",docsLink:"https://docs.lovable.dev/user-guides/messaging-limits",children:[(0,l.jsxs)(nB.om,{planCardContext:"billing",workspace:t,myWorkspaceRole:s,onDowngradeClick:()=>r(!0),children:[a?(0,l.jsxs)("span",{children:["Your subscription is currently"," ",(0,l.jsx)("span",{className:"font-medium",children:"inactive"}),". You can select a new plan below to restore full functionality to your workspace."]}):null,!n&&(h?(0,l.jsx)(rp,{workspace:t,myWorkspaceRole:s}):(0,l.jsx)(n4,{workspace:t,myWorkspaceRole:s})),(0,l.jsx)(rx,{workspace:t,showDowngradeConfirmation:n,setShowDowngradeConfirmation:r})]}),(0,l.jsx)(ty.Vq,{open:i,onOpenChange:c,children:(0,l.jsxs)(ty.cZ,{className:"gap-4 outline-none focus:ring-0",size:"md",hideCloseButton:!0,blurOverlay:!0,onInteractOutside:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,l.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,l.jsx)(tT.xx,{className:"h-9"}),(0,l.jsxs)(ty.fK,{children:[(0,l.jsxs)(ty.$N,{className:"text-2xl md:text-3xl",children:["Plan successfully changed to ",null==d?void 0:d.planName,"!"]}),(0,l.jsx)(ty.Be,{children:"Your new plan will be activated at the start of the next billing cycle."})]})]}),(0,l.jsx)(ty.cN,{fullWidthButtons:!0,className:"flex-col gap-2",children:(0,l.jsxs)(j.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!1),u(null),r(!1)},className:"w-full",children:[(0,l.jsx)(nd.Z,{className:"mr-2 h-4 w-4"}),"Got it!"]})})]})})]})};var rf=s(29984);let rj=rf.fC;rf.xz;let rv=rf.h_,rb=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(rf.aV,{className:(0,U.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t})});rb.displayName=rf.aV.displayName;let ry=o.forwardRef((e,t)=>{let{className:s,overlayClassName:a,...n}=e;return(0,l.jsxs)(rv,{children:[(0,l.jsx)(rb,{className:a}),(0,l.jsx)(rf.VY,{ref:t,className:(0,U.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n})]})});ry.displayName=rf.VY.displayName;let rw=e=>{let{className:t,...s}=e;return(0,l.jsx)("div",{className:(0,U.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};rw.displayName="AlertDialogHeader";let rN=e=>{let{className:t,...s}=e;return(0,l.jsx)("div",{className:(0,U.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};rN.displayName="AlertDialogFooter";let r_=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(rf.Dx,{ref:t,className:(0,U.cn)("font-semibold text-lg",s),...a})});r_.displayName=rf.Dx.displayName;let rk=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(rf.dk,{ref:t,className:(0,U.cn)("text-sm text-muted-foreground",s),...a})});rk.displayName=rf.dk.displayName;let rS=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(rf.aU,{ref:t,className:(0,U.cn)((0,j.d)(),s),...a})});rS.displayName=rf.aU.displayName;let rC=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(rf.$j,{ref:t,className:(0,U.cn)((0,j.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...a})});rC.displayName=rf.$j.displayName;var rE=s(49360);let rz=e=>{let{workspace:t,onSuccess:s,onCancel:a,initialData:n}=e,[r,i]=(0,o.useState)("oidc"),[c,d]=(0,o.useState)((null==n?void 0:n.domain)||""),[u,m]=(0,o.useState)(!1),[p,h]=(0,o.useState)(""),{register:x,handleSubmit:f,formState:{errors:v,isSubmitting:y},getValues:w}=(0,tY.cI)({defaultValues:{clientId:(null==n?void 0:n.clientId)||"",clientSecret:(null==n?void 0:n.clientSecret)||"",issuer:(null==n?void 0:n.issuer)||""},mode:"onBlur"}),{mutateAsync:N,isPending:_}=(0,th.D)({mutationFn:async()=>{let e=(0,g.SJ)();return await e.post("/workspaces/".concat(t.id,"/identity/verify-domain"),{domain:c}),m(!0),h(""),!0},onError:e=>{h(e.message),eU.Am.error(e.message)}}),{mutateAsync:k}=(0,th.D)({mutationFn:async e=>{let s=(0,g.SJ)(),a=(0,rE.Z)().replace(/-/g,"").slice(0,8);return await s.post("/workspaces/".concat(t.id,"/identity/add-oidc-provider"),{displayName:a,oidc:{clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}})},onSuccess:()=>{i("complete"),eU.Am.success("SSO provider added successfully!"),null==s||s()},onError:e=>{eU.Am.error(e.message,{description:"Please check your OIDC provider settings and try again."})}}),S=async()=>{if("domain"===r&&u)i("oidc");else if("oidc"===r){let e=w();await k({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>{i("verification")}).catch(()=>{})}};return"complete"===r?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(b.Z,{name:"check",className:"mx-auto h-16 w-16 text-success-primary"}),(0,l.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"SSO Provider Added Successfully!"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Your SSO provider has been configured and is ready to use."})]}),(0,l.jsxs)(nS.Zb,{children:[(0,l.jsx)(nS.Ol,{children:(0,l.jsx)(nS.ll,{className:"text-sm",children:"Provider Details"})}),(0,l.jsxs)(nS.aY,{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:"Domain:"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:c})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provider Type:"}),(0,l.jsx)(sP.C,{variant:"outline",children:"OIDC"})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status:"}),(0,l.jsx)(sP.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:a,children:"Close"}),(0,l.jsx)(j.z,{onClick:()=>i("domain"),children:"Add Another Provider"})]})]}):(0,l.jsxs)("div",{className:"space-y-6",children:["domain"===r&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(se.Label,{htmlFor:"domain",children:"Domain"}),(0,l.jsx)(tV.I,{id:"domain",value:c,onChange:e=>d(e.target.value),placeholder:"yourdomain.com",disabled:u,className:"mt-1"})]}),!u&&(0,l.jsxs)(sY.bZ,{children:[(0,l.jsx)(b.Z,{name:"info",size:"small"}),(0,l.jsx)(sY.Cd,{children:"Domain Verification Required"}),(0,l.jsxs)(sY.X,{children:["To verify your domain, add the following TXT record to your DNS provider:",(0,l.jsxs)("div",{className:"mt-2 flex gap-2 rounded bg-muted p-2 font-mono text-sm",children:[(0,l.jsx)("div",{children:"TXT"}),(0,l.jsx)("div",{children:"@"}),(0,l.jsxs)("div",{className:"break-all",children:["lovable_verification=",t.id]})]}),(0,l.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"DNS changes may take a few minutes to propagate."})]})]}),p&&(0,l.jsxs)(sY.bZ,{variant:"destructive",children:[(0,l.jsx)(b.Z,{name:"info",size:"small"}),(0,l.jsx)(sY.Cd,{children:"Verification Failed"}),(0,l.jsx)(sY.X,{children:p})]}),u&&(0,l.jsxs)(sY.bZ,{variant:"success",children:[(0,l.jsx)(b.Z,{name:"check"}),(0,l.jsx)(sY.Cd,{children:"Domain Verified!"}),(0,l.jsx)(sY.X,{children:"Your domain has been successfully verified."})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)(j.z,{variant:"outline",onClick:a,children:"Cancel"}),(0,l.jsxs)("div",{className:"space-x-2",children:[!u&&(0,l.jsx)(j.z,{onClick:()=>N(),disabled:_||!c,loading:_,children:_?"Verifying...":"Verify Domain"}),u&&(0,l.jsx)(j.z,{onClick:S,children:"Continue"})]})]})]}),"oidc"===r&&(0,l.jsxs)("form",{className:"space-y-4",onSubmit:f(async e=>{await k({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>i("verification")).catch(()=>{})}),noValidate:!0,children:[(0,l.jsxs)(sY.bZ,{children:[(0,l.jsx)(b.Z,{name:"info",size:"small"}),(0,l.jsx)(sY.Cd,{children:"OIDC Configuration"}),(0,l.jsx)(sY.X,{children:"Configure your OIDC provider settings. You'll need to obtain these values from your identity provider."})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(se.Label,{htmlFor:"clientId",children:"Client ID"}),(0,l.jsx)(tV.I,{id:"clientId",...x("clientId",{required:"Client ID is required"}),placeholder:"Enter your OIDC client ID",className:v.clientId?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!v.clientId,"aria-describedby":"clientId-error"}),v.clientId&&(0,l.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientId-error",children:v.clientId.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(se.Label,{htmlFor:"clientSecret",children:"Client Secret"}),(0,l.jsx)(tV.I,{id:"clientSecret",type:"password",...x("clientSecret",{required:"Client Secret is required"}),placeholder:"Enter your OIDC client secret",className:v.clientSecret?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!v.clientSecret,"aria-describedby":"clientSecret-error"}),v.clientSecret&&(0,l.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientSecret-error",children:v.clientSecret.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(se.Label,{htmlFor:"issuer",children:"Issuer URL"}),(0,l.jsx)(tV.I,{id:"issuer",...x("issuer",{required:"Issuer URL is required",pattern:{value:/^https?:\/\/.+/,message:"Must be a valid URL (starting with http(s)://)"},validate:e=>{try{return new URL(e),!0}catch(e){return"Must be a valid URL"}}}),placeholder:"https://your-identity-provider.com",className:v.issuer?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!v.issuer,"aria-describedby":"issuer-error"}),v.issuer&&(0,l.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"issuer-error",children:v.issuer.message})]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)(j.z,{variant:"outline",onClick:()=>{"oidc"===r?i("domain"):"verification"===r&&i("oidc")},type:"button",children:[(0,l.jsx)(b.Z,{name:"arrow_left_alt",size:"small"}),"Back"]}),(0,l.jsx)(j.z,{type:"submit",disabled:y,children:"Configure Provider"})]})]}),"verification"===r&&(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(Z.$,{size:"large"}),(0,l.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Configuring SSO Provider"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Please wait while we configure your SSO provider..."})]})})]})},rA=e=>{var t;let{workspace:s}=e,[a,n]=(0,o.useState)([{type:"list",title:"Identity & Access"}]),[r,i]=(0,o.useState)(null),c=(0,e6.NL)(),d=(0,g.SJ)(),{data:u=[],isLoading:m,error:h}=(0,x.a)({queryKey:["sso-providers",s.id],queryFn:async()=>await d.get("/workspaces/".concat(s.id,"/identity/sso-providers"))}),f=(0,th.D)({mutationFn:async e=>{await d.delete("/workspaces/".concat(s.id,"/identity/sso-providers/").concat(e))},onSuccess:()=>{c.invalidateQueries({queryKey:["sso-providers",s.id]}),i(null),eU.Am.success("SSO provider deleted successfully")},onError:e=>{i(null),eU.Am.error(e.message||"Failed to delete SSO provider")}}),v=a[a.length-1],y=()=>{i(null),n(e=>[...e,{type:"add-provider",title:"Add SSO Provider"}])},w=()=>{i(null),n(e=>e.slice(0,-1))},N=()=>{i(null),n([{type:"list",title:"Identity & Access"}])},_=e=>(0,l.jsx)(sP.C,{variant:"affirmative",children:"Active"}),k=e=>{switch(e){case"oidc":return(0,l.jsx)(b.Z,{name:"security"});case"saml":return(0,l.jsx)(b.Z,{name:"key"});default:return(0,l.jsx)(b.Z,{name:"settings"})}},S=e=>{i(e)},C=()=>{i(null)},E=()=>{c.invalidateQueries({queryKey:["sso-providers",s.id]}),N()};return h?(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsx)(nS.Zb,{children:(0,l.jsx)(nS.aY,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center text-destructive-primary",children:["Error loading SSO providers: ",h.message]})})})}):(0,l.jsxs)(p.tM,{value:"identity",title:"Identity",description:"Manage your workspace identity and SSO.",children:[a.length<=1?null:(0,l.jsx)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:a.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[t>0&&(0,l.jsx)(b.Z,{name:"chevron_right",size:"small"}),t===a.length-1?(0,l.jsx)("span",{className:"font-medium text-foreground",children:e.title}):(0,l.jsx)("button",{onClick:()=>n(e=>e.slice(0,t+1)),className:"transition-colors hover:text-foreground",children:e.title})]},t))}),"list"===v.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("h2",{className:"text-xl font-medium",children:"SSO Providers"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure single sign-on providers for your workspace"})]}),(0,l.jsxs)(j.z,{onClick:y,variant:"secondary",children:[(0,l.jsx)(b.Z,{name:"add",size:"small"}),"Add Provider"]})]}),m?(0,l.jsxs)("div",{className:"py-8 text-center",children:[(0,l.jsx)(b.Z,{name:"security",className:"mx-auto h-12 w-12 animate-pulse text-muted-foreground"}),(0,l.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Loading SSO providers..."})]}):0===u.length?(0,l.jsxs)("div",{className:"py-8 text-center",children:[(0,l.jsx)(b.Z,{name:"security",className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,l.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No SSO providers configured"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first SSO provider to enable single sign-on for your workspace."}),(0,l.jsxs)(j.z,{className:"mt-4",onClick:y,children:[(0,l.jsx)(b.Z,{name:"add",size:"small"}),"Add Provider"]})]}):(0,l.jsx)("div",{className:"space-y-4",children:u.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:k(e.type)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium",children:e.provider_id}),(0,l.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[_(e),(0,l.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Added ",new Date(e.created_at).toLocaleDateString()]})]})]})]}),(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsx)(j.z,{variant:"ghost",size:"sm",className:"hover:bg-destructive-foreground/10 hover:text-destructive-foreground",onClick:()=>S(e.id),children:"Delete"})})]},e.id))}),(0,l.jsx)(rj,{open:!!r,onOpenChange:e=>{e||C()},children:(0,l.jsxs)(ry,{overlayClassName:"z-[11000]",className:"z-[11000]",children:[(0,l.jsxs)(rw,{children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(b.Z,{name:"delete",className:"text-destructive-foreground"}),(0,l.jsx)(r_,{children:"Delete SSO Provider"})]}),(0,l.jsx)(rk,{children:"Are you sure you want to delete this SSO provider? This action cannot be undone and will disable SSO authentication for the configured domains."})]}),(0,l.jsxs)(rN,{children:[(0,l.jsx)(rC,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"outline",size:"sm",disabled:f.isPending,children:"Cancel"})}),(0,l.jsx)(rS,{asChild:!0,children:(0,l.jsx)(j.z,{variant:"destructive",size:"sm",onClick:()=>{r&&(f.mutate(r),i(null))},disabled:f.isPending,children:f.isPending?"Deleting...":"Delete"})})]})]})}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-medium",children:"Security & Access Control"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Additional security settings for your workspace"})]}),(0,l.jsx)(eG.P,{label:"Just-in-Time Provisioning",description:"Automatically create user accounts when they sign in via SSO",justify:"end",children:(0,l.jsx)(sP.C,{variant:"affirmative",children:"Enabled"})}),(0,l.jsx)(eG.P,{label:"Enforce SSO",description:"Require all workspace members to use SSO for authentication",justify:"end",children:(0,l.jsx)(sP.C,{variant:"outline",children:"Coming Soon"})})]}),"add-provider"===v.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-medium",children:"Add SSO Provider"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure a new single sign-on provider for your workspace"})]}),(0,l.jsx)(rz,{workspace:s,onSuccess:E,onCancel:w})]}),"edit-provider"===v.type&&(v.provider?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)(j.z,{variant:"ghost",size:"sm",onClick:w,children:[(0,l.jsx)(b.Z,{name:"chevron_left",size:"small"}),"Back"]})}),(0,l.jsxs)(nS.Zb,{children:[(0,l.jsxs)(nS.Ol,{children:[(0,l.jsx)(nS.ll,{children:"Edit SSO Provider"}),(0,l.jsxs)(nS.SZ,{children:["Update the configuration for ",v.provider.display_name]})]}),(0,l.jsx)(nS.aY,{children:(0,l.jsx)(rz,{workspace:s,initialData:{domain:(null===(t=v.provider.domains)||void 0===t?void 0:t[0])||"",clientId:v.provider.client_id,clientSecret:v.provider.client_secret,issuer:v.provider.issuer},onSuccess:E,onCancel:w})})]})]}):(w(),null))]})};var rI=s(32800),rD=s(19878);let rO=e=>"owner"===e,rP=e=>"admin"===e,rT=e=>(0,tl.Ll)(e.plan),rL={ADD_EDITOR:"claim.workspace.add_editor",ADD_ADMIN:"claim.workspace.add_admin",SEE_USAGE:"claim.workspace.see_usage",MANAGE_PLAN:"claim.workspace.manage_plan",REMOVE_EDITOR:"claim.workspace.remove_editor",REMOVE_ADMIN:"claim.workspace.remove_admin",PROJECT_MAGIC_LINK:"claim.project.magic_link"};class rR{canEmailInvite(){return this.claims.has(rL.ADD_EDITOR)}canSetInviteRole(){return this.claims.has(rL.ADD_ADMIN)}canEditRole(){let{targetRole:e}=this.context;return rP(e)?this.claims.has(rL.REMOVE_ADMIN):this.claims.has(rL.REMOVE_EDITOR)&&!rO(e)}canSeeUsage(){return this.claims.has(rL.SEE_USAGE)}canCreateSecretLink(){return this.claims.has(rL.PROJECT_MAGIC_LINK)}canManagePlan(){return this.claims.has(rL.MANAGE_PLAN)}canRemoveMember(){let{targetRole:e}=this.context;return rP(e)?this.claims.has(rL.REMOVE_ADMIN):this.claims.has(rL.REMOVE_EDITOR)&&!rO(e)}constructor(e){this.context=e,this.claims=new Set;let{role:t}=e,s=rT(e.workspace);"free"===s?rO(t)&&(this.claims.add(rL.ADD_EDITOR),this.claims.add(rL.SEE_USAGE),this.claims.add(rL.MANAGE_PLAN),this.claims.add(rL.REMOVE_EDITOR),this.claims.add(rL.PROJECT_MAGIC_LINK)):(rO(t)?(this.claims.add(rL.ADD_EDITOR),this.claims.add(rL.ADD_ADMIN),this.claims.add(rL.SEE_USAGE),this.claims.add(rL.MANAGE_PLAN),this.claims.add(rL.REMOVE_EDITOR),this.claims.add(rL.REMOVE_ADMIN),this.claims.add(rL.PROJECT_MAGIC_LINK)):rP(t)&&(this.claims.add(rL.ADD_EDITOR),this.claims.add(rL.SEE_USAGE),this.claims.add(rL.REMOVE_EDITOR),this.claims.add(rL.PROJECT_MAGIC_LINK)),"pro"!==s&&"ktlo"!==s||rO(t)||this.claims.delete(rL.PROJECT_MAGIC_LINK))}}let rF=e=>new rR(e),rZ=e=>{let{workspace:t,authUserId:s,role:a,targetRole:n}=e;return(0,o.useMemo)(()=>{let e={workspace:t,isWorkspaceOwner:s===t.owner_id,role:a,targetRole:n},r=rF(e);return{canEmailInvite:()=>r.canEmailInvite(),canSetInviteRole:()=>r.canSetInviteRole(),canEditRole:()=>r.canEditRole(),canSeeUsage:()=>r.canSeeUsage(),canCreateSecretLink:()=>r.canCreateSecretLink(),canManagePlan:()=>r.canManagePlan(),canRemoveMember:()=>r.canRemoveMember(),isWorkspaceOwner:e.isWorkspaceOwner}},[t,s,a,n])};var rM=s(40782),rU=s(70335);let rq=e=>{let{workspace:t,memberships:s}=e,a=new Date().getMonth()+1,n=new Date().getFullYear(),{data:r}=(0,x.a)(sc.t.workspaceUsage({workspaceId:null==t?void 0:t.id,month:a,year:n})),{data:i}=(0,x.a)(sc.t.workspaceUserTotalUsage({workspaceId:null==t?void 0:t.id})),c=(0,o.useMemo)(()=>null==i?void 0:i.map(e=>{let t=s.find(t=>t.user_id===e.user_id);return t?{...e,membership:t}:null}).filter(e=>null!==e).sort((e,t)=>t.count-e.count),[i,s]),d=(0,o.useMemo)(()=>null==r?void 0:r.user_usages.map(e=>{let t=s.find(t=>t.user_id===e.user_id);return t?{...e,membership:t}:null}).filter(e=>null!==e).sort((e,t)=>t.count-e.count),[r,s]);return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("p",{className:"pb-2 text-sm text-muted-foreground",children:["Showing usage for"," ",(0,I.WU)(new Date(n,a-1),"MMMM yyyy"),"."]}),(0,l.jsx)("div",{className:"flex flex-col gap-2",children:(null==d?void 0:d.length)===0?(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"No usage data for this period. Usage will appear here once members begin using the workspace."}):null==d?void 0:d.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(rU.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,l.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,l.jsxs)("div",{className:"text-muted-foreground",children:[(0,n2.H)(e.count)," credit",1===e.count?"":"s"," used"]})]},e.user_id))}),c&&c.length>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"border-t pt-4",children:[(0,l.jsx)("p",{className:"pb-2 text-sm text-muted-foreground",children:"Total usage across all months."}),(0,l.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(rU.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,l.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,l.jsxs)("div",{className:"font-medium text-muted-foreground",children:[(0,n2.H)(e.count)," credit",1===e.count?"":"s"," total"]})]},e.user_id))})]})})]})};var rW=s(45659),rK=s(61011),rJ=e=>{let{memberName:t,onConfirm:s,onCancel:a}=e;return(0,l.jsx)(rK.Z,{title:"Remove workspace member",targetName:t,descriptionTemplate:"Are you sure you want to remove ".concat(t," from this workspace? They will no longer have access to any workspace projects or resources."),onConfirm:s,onCancel:a})},rG=s(82157);let rV={owner:"Owner",admin:"Admin",member:"Editor"},rB={owner:"Owners can manage all collaborators, projects, and integrations.",admin:"Admins can manage editors, projects, and integrations.",member:"Editors can only create and edit projects."},rH=e=>{var t,s;let{currentMembership:a,workspaceId:n,memberships:r,workspace:i}=e,[c,u]=(0,o.useState)(null!==(s=a.credit_limit)&&void 0!==s?s:void 0),[m,p]=(0,o.useState)(!1),h=(0,o.useRef)(null),{authUser:x}=(0,d.Eu)(),f=a.user_id===(null==x?void 0:x.uid),y=(0,eJ.z)(rJ),w=null===(t=r.find(e=>e.user_id===(null==x?void 0:x.uid)))||void 0===t?void 0:t.role,N=!a.joined_at,_=rZ({workspace:i,authUserId:null==x?void 0:x.uid,role:w,targetRole:a.role}),k=_.canEditRole()&&!f&&!N,{updateWorkspaceMemberRole:S}=function(e){let{workspaceId:t}=e,s=(0,e6.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,th.D)({mutationFn:async e=>{let{userId:s,role:a}=e,n=(0,g.SJ)();await n.put("/user/workspaces/".concat(t,"/memberships/").concat(s),{role:a})},onMutate:async e=>{let n=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:(0,rM.q)(r.memberships.map(t=>t.user_id===e.userId?{...t,role:e.role}:t))}),{previousData:r}},onError:(e,n,r)=>{if((0,tx.Eo)(e),null==r?void 0:r.previousData){let e=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{updateWorkspaceMemberRole:n}}({workspaceId:n}),{updateWorkspaceMemberCreditLimit:C}=function(e){let{workspaceId:t}=e,s=(0,e6.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,th.D)({mutationFn:async e=>{let{userId:s,creditLimit:a}=e,n=(0,g.SJ)();await n.put("/user/workspaces/".concat(t,"/memberships/").concat(s),{credit_limit:null!=a?a:-1})},onMutate:async e=>{let n=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:(0,rM.q)(r.memberships.map(t=>t.user_id===e.userId?{...t,credit_limit:-1===e.creditLimit?null:e.creditLimit}:t))}),{previousData:r}},onError:(e,n,r)=>{if((0,tx.Eo)(e),null==r?void 0:r.previousData){let e=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{updateWorkspaceMemberCreditLimit:n}}({workspaceId:n}),{removeWorkspaceMember:E}=function(e){let{workspaceId:t}=e,s=(0,e6.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,th.D)({mutationFn:async e=>{let{userId:s}=e,a=(0,g.SJ)();await a.delete("/workspaces/".concat(t,"/memberships/").concat(s))},onMutate:async e=>{let n=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:r.memberships.filter(t=>t.user_id!==e.userId)}),{previousData:r}},onError:(e,n,r)=>{if((0,tx.Eo)(e),null==r?void 0:r.previousData){let e=sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:sc.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{removeWorkspaceMember:n}}({workspaceId:n}),z=(0,o.useCallback)(async e=>{N||await C({userId:a.user_id,creditLimit:isNaN(null!=e?e:0)?-1:e})},[a.user_id,N,C]);(0,o.useEffect)(()=>{let e=e=>{m&&h.current&&!h.current.contains(e.target)&&z(c).then(()=>{p(!1)})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[m,c,C,z]);let A=async e=>{N||await S({userId:a.user_id,role:e})},I=()=>{y({childProps:{memberName:a.display_name||a.username,onConfirm:async()=>{await E({userId:a.user_id}),y(!1)},onCancel:()=>y(!1)}})},D=(0,to.Tj)(),O=(0,l.jsxs)(l.Fragment,{children:[["owner","admin"].includes(null!=w?w:"")&&D&&(0,l.jsxs)(ev.u,{delayDuration:600,children:[(0,l.jsx)(ev.aJ,{children:(0,l.jsx)(l.Fragment,{children:m?(0,l.jsxs)("div",{ref:h,className:"relative flex items-center",children:[(0,l.jsx)(tV.I,{placeholder:"Limit / month",value:c||"",className:"max-w-32 pr-8 text-xs",onChange:e=>u(parseInt(e.target.value)),onKeyDown:e=>{if("Enter"===e.key)z(c).then(()=>{p(!1)});else if("Escape"===e.key){var t;u(null!==(t=a.credit_limit)&&void 0!==t?t:void 0),p(!1)}},autoFocus:!0}),(0,l.jsx)(j.z,{variant:"ghost",size:"icon",className:"absolute right-0.5 h-8 w-8 shadow-none hover:bg-accent hover:shadow-none",onClick:()=>{z(c).then(()=>{p(!1)})},children:(0,l.jsx)(b.Z,{name:"check",size:"small"})})]}):(0,l.jsx)(j.z,{variant:"ghost",size:"sm",className:"text-xs shadow-none hover:bg-accent hover:shadow-none",onClick:()=>p(!0),children:(null==a?void 0:a.credit_limit)?"".concat(a.credit_limit," credits/mo"):"No limit"})})}),(0,l.jsx)(ev._v,{className:"max-w-[30ch]",children:"Update credit limits for this member"})]}),(0,l.jsxs)(v.h_,{children:[(0,l.jsxs)(ev.u,{children:[(0,l.jsx)(ev.aJ,{children:(0,l.jsx)(v.$F,{asChild:!0,disabled:f||!_.canRemoveMember(),children:(0,l.jsxs)(j.z,{"aria-haspopup":"true",variant:"ghost",children:[N?"Pending":rV[a.role]," ",(0,l.jsx)(b.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})]})})}),(0,l.jsx)(ev._v,{className:"max-w-[30ch]",children:N?"This user has been invited to join as ".concat(rV[a.role]):rB[a.role]})]}),(0,l.jsx)(v.AW,{align:"end",children:N?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(rG.w,{label:"Pending",isSelected:!0,onClick:()=>{},disabled:!0}),(0,l.jsx)(rG.w,{label:"Remove",destructive:!0,onClick:I})]}):(0,l.jsxs)(l.Fragment,{children:[_.canSetInviteRole()&&(0,l.jsx)(rG.w,{label:"Admin",isSelected:"admin"===a.role,onClick:()=>A("admin"),disabled:!k,tooltip:rB.admin}),(0,l.jsx)(rG.w,{label:"Editor",isSelected:"member"===a.role,onClick:()=>A("member"),disabled:!k,tooltip:rB.member}),(0,l.jsx)(rG.w,{label:f?"Leave":"Remove",destructive:!0,onClick:I})]})})]})]});return(0,l.jsx)(rW.Q,{id:a.user_id,username:a.username,displayName:a.display_name,photoURL:a.photo_url,avatarClassName:"h-8 w-8",actionComponent:O,isCurrentUser:f,email:a.email,isInvited:N})},rY=[{value:"admin",label:"Admin"},{value:"member",label:"Editor"}],rQ=e=>{var t;let{memberships:s,workspace:a}=e,{authUser:n}=(0,d.Eu)(),[r,i]=(0,o.useState)(""),c=null===(t=s.find(e=>e.user_id===(null==n?void 0:n.uid)))||void 0===t?void 0:t.role,u=rZ({workspace:a,authUserId:null==n?void 0:n.uid,role:c}),m="free"===(0,tl.Ll)(a.plan),p=s?(0,rM.q)(s):[],h=p.filter(e=>{var t;return null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase())}),{inviteWorkspaceMember:x,isInvitingMember:g}=(0,rD.B)({workspaceId:a.id}),f=async e=>{let{emails:t,role:s}=e;if(0===t.length)return{success:!1};let a=0,n=m?"member":s;for(let e of t)await x({email:e,role:n}),a++;return{success:a>0}};return(0,l.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,l.jsx)(rI.s,{onInvite:e=>{let{emails:t,role:s}=e;return f({emails:t,role:s})},isInviting:g,roleOptions:rY,canSelectRoles:u.canSetInviteRole(),defaultRole:"member",placeholder:"Add emails",completelyDisabled:!u.canEmailInvite(),onInputChange:e=>i(e)}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 border-b pb-3",children:[(0,l.jsx)("h4",{children:"Members"}),(0,l.jsx)("ul",{className:"flex flex-col gap-2",children:h.length>0?h.map((e,t)=>(0,l.jsx)(rH,{currentMembership:e,workspaceId:a.id,memberships:p,workspace:a},"".concat(e.user_id,"-").concat(t))):(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:r?"No users found for '".concat(r,"'"):"No members found"})})]}),u.canSeeUsage()&&p&&(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("h4",{children:"Usage"}),(0,l.jsx)(rq,{workspace:a,memberships:p})]})]})},rX=e=>{let{workspace:t}=e;return(0,e$.MD)()?(0,l.jsx)(r0,{workspace:t}):(0,l.jsx)(r$,{workspace:t})};function r$(e){let{workspace:t}=e,s=(0,u.aS)(e=>e.memberships),a=t.num_seats||20,n=s.length,r=t.name||"Workspace",i=(0,l.jsxs)(l.Fragment,{children:["Inviting people to ",(0,l.jsx)("strong",{children:r})," gives access to workspace shared projects and credits. You're using ",n,"/",a," seats. Need more?"," ",(0,l.jsx)(eZ.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,l.jsx)(p.tM,{title:"People",value:"people",description:i,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,l.jsx)(rQ,{memberships:s,workspace:t})})}function r0(e){let{workspace:t}=e,s=(0,e$.hO)(e=>e.memberships),a=t.num_seats||20,n=s.length,r=t.name||"Workspace",i=(0,l.jsxs)(l.Fragment,{children:["Inviting people to ",(0,l.jsxs)("strong",{children:[r,"'s workspace"]})," gives access to workspace shared projects and credits. You're using"," ",n,"/",a," seats. Need more?"," ",(0,l.jsx)(eZ.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,l.jsx)(p.tM,{title:"People",value:"people",description:i,children:(0,l.jsx)(rQ,{memberships:s,workspace:t})})}var r1=s(62395),r2=s(63210);let r4=e=>{let{workspace:t}=e,{data:s,isLoading:a}=(0,x.a)(sc.t.templates({workspaceId:t.id}));return(0,l.jsx)(p.tM,{title:"Templates",value:"templates",description:"Browse and manage team templates, used to start new projects. Publish new templates from settings.",children:(0,l.jsxs)("div",{className:"grid flex-1 grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r1.R,{}),(0,l.jsx)(r1.R,{}),(0,l.jsx)(r1.R,{})]}),!a&&(s&&s.length>0?s.map(e=>(0,l.jsx)(r2.t,{project:e,subtitleType:"created-by",isCommunityProject:!1,positionIndex:0,isTemplate:!0},e.id)):(0,l.jsxs)("div",{className:"col-span-full flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,l.jsx)(b.Z,{name:"file_export",size:"large"}),(0,l.jsx)("p",{className:"text-center text-sm",children:"No templates found. Mark projects as templates to get started."})]}))]})})};var r5=s(56141);function r6(e,t){return e&&("owner"===t||"admin"===t)}let r3=()=>{var e;let{authUser:t}=(0,d.Eu)(),s=(0,e4.iZ)(e=>e.project),{projectWorkspace:a,isMemberOfWorkspace:n,workspaceMemberships:r}=(0,tD.f)(),i=null===(e=r.find(e=>e.user_id===(null==t?void 0:t.uid)))||void 0===e?void 0:e.role;return(0,l.jsx)(r8,{project:s,workspace:null!=a?a:void 0,isMemberOfWorkspace:n,myWorkspaceRole:i})},r8=e=>{var t,s;let{project:a,workspace:n,myWorkspaceRole:r,isMemberOfWorkspace:i}=e,[u,h]=(0,o.useState)(!0),x=(0,tO.v)(),g=x?"admin":r,{activeTab:f,openSettings:j,closeSettings:v}=(0,tc.r)();(0,o.useEffect)(()=>{null!==f?h(!0):h(!1)},[f]),(0,c.y1)("mod+.",()=>{null===f?j(a?"project":"account"):v()});let{authUser:y}=(0,d.Eu)(),w=(null==y?void 0:y.displayName)||"Your Account",N=x||i,_=null==n?void 0:n.name,k=(0,to.R5)(),S=(0,to.uF)(),C=(0,to.Hj)(),E=(0,to.wf)(),z=(0,to.fR)(),A=(0,m.dl)(eH.P.IntegrationConnection);return(0,l.jsx)(tz,{open:u,onOpenChange:e=>{e?j():v()},children:(0,l.jsxs)(p.v_,{value:f||"settings",onValueChange:e=>j(e,!0),children:[(0,l.jsxs)(p.eD,{hasActiveTab:!!f,children:[a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.yf,{title:"Project"}),(0,l.jsxs)(p.QK,{value:"project",children:[(0,l.jsx)(b.Z,{name:"settings"}),(0,l.jsx)("p",{children:"Project Settings"})]}),(0,l.jsxs)(p.QK,{value:"domains",children:[(0,l.jsx)(b.Z,{name:"language"}),(0,l.jsx)("p",{children:"Domains"})]}),S&&(0,l.jsxs)(p.QK,{value:"analytics",children:[(0,l.jsx)(b.Z,{name:"bid_landscape"}),(0,l.jsx)("p",{children:"Analytics"})]}),(0,l.jsxs)(p.QK,{value:"knowledge",children:[(0,l.jsx)(b.Z,{name:"school"}),(0,l.jsx)("p",{children:"Knowledge"})]}),C&&(0,l.jsxs)(p.QK,{value:"memory",children:[(0,l.jsx)(b.Z,{name:"database"}),(0,l.jsx)("p",{children:"Memory"})]}),E&&(0,l.jsxs)(p.QK,{value:"ai_gateway",children:[(0,l.jsx)(b.Z,{name:"smart_toy"}),(0,l.jsx)("p",{children:"AI Gateway"})]}),(null==a?void 0:null===(t=a.enabled_integrations)||void 0===t?void 0:t.includes("supabase_exp"))&&(0,l.jsxs)(p.QK,{value:"supabase",children:[(0,l.jsx)(b.Z,{name:"database",className:"h-4 w-4"}),(0,l.jsx)("p",{children:"Backend"})]})]}),n&&N&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.yf,{title:"Workspace"}),(0,l.jsxs)(p.QK,{value:"workspace",className:"-ml-0.5",children:[(0,l.jsx)(tP.z,{className:(0,U.cn)("h-6 w-6 !rounded-[6px] md:h-5 md:w-5"),workspace:n}),(0,l.jsx)("p",{className:"-ml-0.5",children:_})]}),(0,l.jsxs)(p.QK,{value:"people",children:[(0,l.jsx)(b.Z,{name:"group"}),(0,l.jsx)("p",{children:"People"})]}),k&&(0,l.jsxs)(p.QK,{value:"templates",children:[(0,l.jsx)(b.Z,{name:"browse"}),(0,l.jsx)("p",{children:"Templates"})]}),(0,l.jsxs)(p.QK,{value:"billing",children:[(0,l.jsx)(b.Z,{name:"credit_card"}),(0,l.jsx)("p",{children:"Plans & Billing"})]}),r6(z,r)&&(0,l.jsxs)(p.QK,{value:"identity",children:[(0,l.jsx)(b.Z,{name:"security"}),(0,l.jsx)("p",{children:"Identity"})]})]}),(0,l.jsx)(p.yf,{title:"Account"}),(0,l.jsxs)(p.QK,{value:"account",children:[(0,l.jsx)(b.Z,{name:"account_circle"}),(0,l.jsx)("p",{children:w})]}),(0,l.jsxs)(p.QK,{value:"labs",children:[(0,l.jsx)(b.Z,{name:"science"}),(0,l.jsx)("p",{children:"Labs"})]}),N&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.yf,{title:"Integrations"}),!(null==a?void 0:null===(s=a.enabled_integrations)||void 0===s?void 0:s.includes("supabase_exp"))&&(0,l.jsxs)(p.QK,{value:"supabase",children:[(0,l.jsx)(tT.xR.Supabase,{className:"h-4 w-4"}),(0,l.jsx)("p",{children:"Supabase"})]}),(a||n)&&(0,l.jsxs)(p.QK,{value:"github",children:[(0,l.jsx)(tT.xR.GitHub,{className:"h-4 w-4"}),(0,l.jsx)("p",{children:"GitHub"})]}),A&&n&&(0,l.jsxs)(p.QK,{value:"mcp",children:[(0,l.jsx)(b.Z,{name:"cloud"}),(0,l.jsx)("p",{children:"MCP"})]})]})]}),(0,l.jsxs)("div",{className:(0,U.cn)("relative h-full w-full flex-1 overflow-x-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground md:w-auto",f?"flex":"hidden md:flex"),children:[a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.tM,{value:"project",title:"Project Settings",description:"Manage your project details, visibility, and preferences.",children:(0,l.jsx)(tj,{projectId:a.id})}),(0,l.jsx)(p.tM,{value:"knowledge",title:"Knowledge",description:"Add custom knowledge to your project.",docsLink:"https://docs.lovable.dev/features/knowledge",children:(0,l.jsx)(e5,{})}),(0,l.jsx)(p.tM,{value:"domains",title:"Domains",description:"Publish your project to custom domains.",docsLink:"https://docs.lovable.dev/tips-tricks/custom-domain",children:(0,l.jsx)(e0,{project:a})}),S&&(0,l.jsx)(eT,{project:a}),C&&(0,l.jsx)(s0,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:g,project:a}),E&&(0,l.jsx)(ee,{project:a})]}),n&&i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r5.r,{workspace:n}),(0,l.jsx)(rX,{workspace:n}),(0,l.jsx)(rg,{workspace:n,myWorkspaceRole:r}),k&&(0,l.jsx)(r4,{workspace:n}),r6(z,r)&&(0,l.jsx)(rA,{workspace:n})]}),(0,l.jsx)(si,{}),(0,l.jsx)(tM,{}),N&&n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sG,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:g}),(0,l.jsx)(nq,{workspace:n,isInsideEditor:!!a,project:a,myWorkspaceRole:g}),A&&(0,l.jsx)(s$,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:g})]})]})]})})};var r7=()=>{var e;let{authUser:t}=(0,d.Eu)(),s=(0,e$.MD)(),a=(0,u.aS)(e=>e.currentWorkspace),n=(0,u.aS)(e=>e.memberships),r=n.some(e=>e.user_id===(null==t?void 0:t.uid));if(s)return(0,l.jsx)(r3,{});let i=null===(e=n.find(e=>e.user_id===(null==t?void 0:t.uid)))||void 0===e?void 0:e.role;return(0,l.jsx)(r8,{workspace:null!=a?a:void 0,isMemberOfWorkspace:r,myWorkspaceRole:i})}},19878:function(e,t,s){s.d(t,{B:function(){return d}});var a=s(29827),n=s(21770),r=s(52558),i=s(64040),l=s(49131),o=s(89668),c=s(40782);function d(e){let{workspaceId:t}=e,s=(0,a.NL)(),{authUser:d}=(0,r.Eu)(),{mutateAsync:u,isPending:m}=(0,n.D)({mutationFn:async e=>{let{email:s,role:a="member"}=e;return(0,l.SJ)().post("/workspaces/".concat(t,"/memberships"),{email:s,role:a})},onSuccess:async e=>{if(e){let a=o.t.workspaceMemberships({workspaceId:t,userId:null==d?void 0:d.uid}),n=s.getQueryData(a.queryKey);n&&!n.memberships.some(t=>t.user_id===e.user_id)&&s.setQueryData(a.queryKey,{...n,memberships:(0,c.q)([...n.memberships,e])})}s.invalidateQueries({queryKey:o.t.workspaceMemberships({workspaceId:t,userId:null==d?void 0:d.uid}).queryKey})},onError:e=>{(0,i.Eo)(e)}});return{inviteWorkspaceMember:u,isInvitingMember:m}}},40782:function(e,t,s){s.d(t,{q:function(){return n}});let a={owner:3,admin:2,member:1};function n(e){return[...e].sort((e,t)=>{let s=!!e.joined_at,n=!!t.joined_at;if(s&&!n)return -1;if(!s&&n)return 1;let r=a[t.role]-a[e.role];return 0!==r?r:e.joined_at&&t.joined_at?new Date(t.joined_at).getTime()-new Date(e.joined_at).getTime():0})}},56141:function(e,t,s){s.d(t,{r:function(){return L},Y:function(){return R}});var a=s(57437),n=s(13590),r=s(92850),i=s(29827),l=s(21770),o=s(29501),c=s(14438),d=s(91115),u=s(52558),m=s(6812),p=s(69084),h=s(32165),x=s(66870),g=s(62869),f=s(78276),j=s(26110),v=s(15681),b=s(95186),y=s(76818),w=s(64040),N=s(49131),_=s(89668),k=s(99376),S=s(61922),C=s(2265),E=s(57346),z=s(26034),A=s(97318),I=s(94508),D=s(94949);let O=["image/png","image/jpeg","image/jpg","image/webp"],P=e=>{let{workspace:t,className:s}=e,{authUser:n}=(0,u.Eu)(),r=(0,N.SJ)(),{upload:o}=(0,D.F)(),d=(0,i.NL)(),m=(0,C.useRef)(null),p=()=>{m.current&&(m.current.value="")},{mutateAsync:h,isPending:x}=(0,l.D)({mutationFn:async e=>{let{file:s,workspaceId:a}=e;if(!n)throw Error("You must be logged in to upload files");await o({fileName:s.name,file:s,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:i}=await (0,z._c)({dir_name:n.uid,file_name:s.name});return await r.put("/user/workspaces/".concat(t.id),{image_url:i})},onSuccess:(e,t)=>{c.Am.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),d.invalidateQueries({queryKey:A.E.all}),p()},onError:()=>{c.Am.error("Failed to update workspace avatar",{description:"Please try again"}),p()}}),f=async e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&await h({file:a,workspaceId:t.id})};return(0,a.jsxs)(g.z,{variant:"secondary",size:"icon-sm",className:(0,I.cn)("absolute -bottom-1 -right-2 h-5 w-5 rounded-sm border disabled:opacity-100",s),type:"button",disabled:x,onClick:()=>{var e;null===(e=m.current)||void 0===e||e.click()},children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:O.join(","),onChange:f,disabled:x,ref:m}),(0,a.jsx)(E.Z,{name:x?"progress_activity":"edit_square",size:"xsmall",className:x?"animate-spin":""})]})},T=d.z.object({name:d.z.string().min(1,"Workspace name is required"),description:d.z.string().optional()}),L=e=>{var t,s,i;let{workspace:c}=e,d=(0,o.cI)({defaultValues:{name:null!==(s=c.name)&&void 0!==s?s:"",description:null!==(i=c.description)&&void 0!==i?i:""},resolver:(0,n.F)(T)}),{authUser:m}=(0,u.Eu)(),{data:w}=(0,r.a)(_.t.workspaceMemberships({userId:null==m?void 0:m.uid,workspaceId:c.id})),C=null==w?void 0:null===(t=w.memberships.find(e=>e.user_id===(null==m?void 0:m.uid)))||void 0===t?void 0:t.role,E="owner"===C,z="member"===C,{leaveWorkspace:A,isLeavingWorkspace:I}=function(){let{setCurrentWorkspaceId:e}=(0,S.J1)(),t=(0,k.useRouter)(),{mutateAsync:s,isPending:a}=(0,l.D)({mutationFn:async e=>(0,N.SJ)().post("/user/workspaces/".concat(e,"/leave")),onSuccess:async()=>{e(null),t.push("/")}});return{leaveWorkspace:s,isLeavingWorkspace:a}}(),{updateWorkspace:D,isUpdatingWorkspace:O}=R({form:d,workspaceId:c.id});return(0,a.jsx)(x.tM,{title:"Workspace Settings",value:"workspace",description:"Workspaces allow you to collaborate on projects in real time.",docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(v.l0,{...d,children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:d.handleSubmit(e=>{D(e)}),children:[(0,a.jsx)(h.P,{label:"Workspace Avatar",description:"Set an avatar for your workspace.",mobileLayout:"horizontal",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.z,{className:"h-10 w-10",workspace:c}),("admin"===C||E)&&(0,a.jsx)(P,{workspace:c})]})}),(0,a.jsx)(h.P,{label:"Workspace Name",description:"Your full workspace name, as visible to others.",children:(0,a.jsx)(v.Wi,{control:d.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:z,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(b.I,{...t,placeholder:"Enter workspace name",disabled:z})})}),(0,a.jsx)(v.zG,{})]})}})}),(0,a.jsx)(h.P,{label:"Workspace Description",description:"A short description about your workspace or team.",isLast:E,children:(0,a.jsx)(v.Wi,{control:d.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:z,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(y.g,{rows:3,className:"border bg-background",placeholder:"Description",disabled:z,...t})})}),(0,a.jsx)(v.zG,{})]})}})}),!E&&(0,a.jsx)(h.P,{label:"Leave Workspace",description:"Leave the workspace (you will lose all access to projects inside this workspace).",isLast:!0,children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsxs)(j.Vq,{children:[(0,a.jsx)(j.hg,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:I,children:"Leave Workspace"})}),(0,a.jsxs)(j.cZ,{size:"sm",children:[(0,a.jsxs)(j.fK,{children:[(0,a.jsx)(j.$N,{children:"Leave Workspace"}),(0,a.jsx)(j.Be,{children:"Are you sure you want to leave this workspace?"})]}),(0,a.jsxs)(j.cN,{children:[(0,a.jsx)(j.GG,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:I,onClick:()=>A(c.id),children:"Leave Workspace"})]})]})]})})}),d.formState.isDirty&&(0,a.jsx)(h.j,{children:(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)(g.z,{variant:"secondary",type:"button",onClick:()=>{d.reset()},children:"Cancel"}),(0,a.jsx)(g.z,{variant:"affirmative",type:"submit",loading:O,children:"Update"})]})})]})})})};function R(e){let{form:t,workspaceId:s}=e,a=(0,i.NL)(),{authUser:n}=(0,u.Eu)(),{store:r}=(0,m.bm)(),{mutate:o,isPending:d}=(0,l.D)({mutationFn:async e=>{var t;return(0,N.SJ)().put("/user/workspaces/".concat(s),{name:e.name,description:null!==(t=e.description)&&void 0!==t?t:""})},onSuccess:e=>{var i,l,o;c.Am.success("Success",{description:"Workspace settings updated successfully"});let d=_.t.detail({workspaceId:s}).queryKey;a.setQueryData(d,t=>t?{...t,workspace:e}:{workspace:e,projects:[]});let u=_.t.workspaces({userId:null==n?void 0:n.uid}).queryKey;a.setQueryData(u,t=>t?{workspaces:t.workspaces.map(t=>t.id===e.id?e:t)}:{workspaces:[e]});let m=(null!==(i=null==r?void 0:r.getState().workspaces)&&void 0!==i?i:[]).map(t=>t.id===e.id?e:t);null==r||r.setState({workspaces:m}),t.reset({name:null!==(l=e.name)&&void 0!==l?l:"",description:null!==(o=e.description)&&void 0!==o?o:""})},onError:e=>{(0,w.Eo)(e)}});return{updateWorkspace:o,isUpdatingWorkspace:d}}},74751:function(e,t,s){s.d(t,{p:function(){return l}});var a=s(57437),n=s(35974),r=s(94508);let i={pro:"brand-twilight",admin:"brand-saffron",labs:"brand-twilight",internal:"secondary"},l=e=>{let{badge:t,className:s}=e;return(0,a.jsx)(n.C,{variant:i[t],className:(0,r.cn)("capitalize",s),children:t})}},32165:function(e,t,s){s.d(t,{P:function(){return i},j:function(){return l}});var a=s(57437),n=s(94508),r=s(74751);let i=e=>{let{children:t,label:s,className:i,isLast:l=!1,description:o,badges:c,customBadge:d,mobileLayout:u="vertical",justify:m="start",...p}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("relative grid gap-4 pb-4 last:border-b-0 md:grid md:grid-cols-2",{"border-b-0":l,"border-b":!l,"flex justify-between":"horizontal"===u,"grid-cols-1":"vertical"===u},i),...p,children:[(s||o)&&(0,a.jsxs)("div",{className:"flex-col gap-1 md:flex",children:[(0,a.jsxs)("p",{className:"flex flex-wrap items-center gap-x-1.5 text-base font-medium",children:[s,null==c?void 0:c.map(e=>(0,a.jsx)(r.p,{badge:e},e)),d]}),o&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:o})]}),t&&(0,a.jsx)("div",{className:(0,n.cn)("flex items-center","end"===m&&"md:justify-end"),children:t})]})},l=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("absolute inset-x-0 bottom-0 z-10 flex min-h-8 items-center border-t bg-background px-6 py-3 md:px-10",s),...r,children:t})}},66870:function(e,t,s){s.d(t,{QK:function(){return u},eD:function(){return d},tM:function(){return m},v_:function(){return c},yf:function(){return p}});var a=s(57437),n=s(20271),r=s(55157),i=s(57346),l=s(27132),o=s(94508);let c=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)(n.mQ,{className:(0,o.cn)("mt-0 flex w-full flex-1 flex-col items-start overflow-hidden md:flex-row",s),orientation:"vertical",...r,children:t})},d=e=>{let{children:t,className:s,hasActiveTab:r,...i}=e;return(0,a.jsxs)(n.dr,{className:(0,o.cn)("mt-[22px] flex h-full w-full flex-col gap-0.5 overflow-y-auto px-4 py-6 md:mt-0 md:w-[240px] md:flex-nowrap md:border-r",s,r?"hidden md:flex":"flex"),...i,children:[(0,a.jsx)(h,{hideBackButton:!0,className:"mt-[22px]",children:"Settings"}),t]})},u=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)(n.SP,{className:(0,o.cn)("flex min-h-10 w-full items-center justify-start gap-3 rounded-md px-2.5 py-2 text-start text-base data-[state=active]:bg-muted hover:bg-muted-hover md:min-h-8 md:w-auto md:gap-2 md:text-sm [&>svg]:size-5 md:[&>svg]:size-4",s),...r,children:t})},m=e=>{let{children:t,className:s,title:r,description:l,docsLink:c,descriptionAction:d,...u}=e;return(0,a.jsxs)(n.nU,{className:(0,o.cn)("flex max-h-full w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6 pt-20 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground data-[state=inactive]:hidden focus:outline-none md:px-10 md:pt-6",s),...u,children:[r&&(0,a.jsxs)("div",{className:"hidden w-full flex-col gap-2 border-b pb-3 md:flex",children:[(0,a.jsx)("h4",{className:"text-lg font-medium",children:r}),l&&(0,a.jsxs)("p",{className:(0,o.cn)("flex items-start justify-between gap-2 text-sm text-muted-foreground"),children:[(0,a.jsx)("div",{className:"",children:l}),c&&(0,a.jsxs)("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-muted-foreground duration-150 ease-in-out hover:text-muted-foreground/80",children:[(0,a.jsx)(i.Z,{name:"help",size:"small"}),"Docs"]}),d&&d]})]}),(0,a.jsx)(h,{descriptionAction:d,children:r}),t]})},p=e=>{let{title:t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("mb-1 mt-6 px-3 text-sm font-medium text-muted-foreground first:mt-0 md:text-xs"),children:t})},h=e=>{let{children:t,className:s,hideBackButton:n=!1,descriptionAction:c,...d}=e,{openSettings:u}=(0,r.r)();return(0,l.Z)("md")?(0,a.jsxs)("div",{className:(0,o.cn)("absolute inset-x-0 top-0 z-20 flex min-h-8 items-center justify-between border-b bg-background px-2 py-3 md:hidden",s),...d,children:[(0,a.jsx)("div",{className:"flex items-baseline",children:!n&&(0,a.jsxs)("button",{className:(0,o.cn)("flex items-center gap-1 text-base md:text-sm"),onClick:()=>u(),children:[(0,a.jsx)(i.Z,{name:"chevron_left",size:"default"})," Settings"]})}),(0,a.jsx)("div",{className:"absolute left-1/2 flex -translate-x-1/2 items-baseline justify-center text-center text-lg font-medium",children:t}),(0,a.jsx)("div",{className:"flex min-h-7 items-baseline pr-0.5",children:c})]}):null}},56922:function(e,t,s){s.d(t,{D:function(){return l},e:function(){return i}});var a=s(57437),n=s(2265);let r=(0,n.createContext)({setSelectedProject:()=>{},setOpen:()=>{}}),i=()=>{let e=(0,n.useContext)(r);if(!e)throw Error("useSupabaseConnectMenuContext must be used within a SupabaseConnectMenuContext");return e},l=e=>{let{children:t,setSelectedProject:s,setOpen:n}=e;return(0,a.jsx)(r.Provider,{value:{setSelectedProject:s,setOpen:n},children:t})}},22876:function(e,t,s){s.d(t,{K:function(){return m}});var a=s(57437),n=s(27648),r=s(2265),i=s(23518),l=s(78276),o=s(55721),c=s(57346),d=s(56922),u=s(27559);let m=e=>{var t;let{organization:s}=e;return(0,a.jsxs)(o.Ph,{children:[(0,a.jsx)(o.kt,{className:"text-sm",children:(0,a.jsx)("span",{className:"truncate",children:s.name})}),(0,a.jsxs)(o.TG,{className:"w-56 p-0",children:[(0,a.jsxs)(i.mY,{children:[(0,a.jsx)(i.sZ,{placeholder:"Search projects...",autoFocus:!0}),(0,a.jsxs)(i.e8,{className:"max-h-60 scrollbar-thin scrollbar-thumb-muted-foreground/20",children:[(0,a.jsx)(i.rb,{children:"No projects found."}),(0,a.jsx)(i.fu,{children:null===(t=s.projects)||void 0===t?void 0:t.map(e=>(0,a.jsx)(p,{project:e},e.id))})]})]}),(0,a.jsx)(o.VD,{className:"mt-0"}),(0,a.jsx)("div",{className:"px-1 pb-1",children:(0,a.jsx)(o.Xi,{asChild:!0,children:(0,a.jsxs)(n.default,{href:"https://supabase.com/dashboard/new/".concat(s.id),target:"_blank",rel:"noopener noreferrer",className:"flex w-full items-center gap-2",children:[(0,a.jsx)(c.Z,{name:"add",size:"small"}),"Create project",(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small",className:"ml-auto"})]})})})]})]},s.id)},p=e=>{let{project:t}=e,s=(0,u.u)(t),{setSelectedProject:n,setOpen:o}=(0,d.e)(),m=(0,r.useCallback)(()=>{n(t),o(!1)},[t,n,o]);return(0,a.jsx)(l.b,{showTooltip:!s,side:"left",tooltipContent:"Check project status in Supabase.",children:(0,a.jsxs)(i.di,{onSelect:m,disabled:!s,className:"group flex w-full items-center",value:t.name,children:[(0,a.jsx)("span",{className:"truncate",children:t.name}),!s&&(0,a.jsx)(c.Z,{name:"warning_fill",size:"small",className:"ml-auto text-destructive-primary"})]},t.id)})}},27559:function(e,t,s){s.d(t,{u:function(){return n}});var a=s(22853);let n=e=>e.status===a.k.ACTIVE_HEALTHY},30811:function(e,t,s){s.d(t,{B:function(){return m}});var a=s(57437),n=s(35974),r=s(94508),i=s(54616),l=s(78276),o=s(57346);let c=/[,;\n\t]+/g,d=/\s+/g,u=e=>e.replace(c," ").replace(d," ").trim().split(" ").map(e=>e.trim()).filter(e=>""!==e),m=e=>{let{tags:t,setTags:s,inputValue:c,setInputValue:d,placeholder:m="Type and press Enter...",className:p="",...h}=e,x=e=>{t.includes(e)||""===e.trim()||s([...t,e]),d("")},g=e=>{s(t.filter((t,s)=>s!==e))};return(0,a.jsxs)("div",{className:(0,r.cn)("flex min-h-9 w-full min-w-0 flex-wrap items-center gap-1.5 overflow-hidden rounded-md border border-input bg-transparent p-2 py-1.5 text-sm shadow-sm transition-colors focus-within:ring-1 focus-within:ring-ring",p),children:[t.map((e,t)=>{let s=(0,i.Jh)(e);return(0,a.jsx)(l.b,{showTooltip:!s,tooltipContent:"This is not a valid email.",instant:!0,className:"min-w-0",children:(0,a.jsxs)(n.C,{variant:"secondary",className:"flex min-w-0 cursor-default items-center gap-1 rounded-sm px-1 py-0 text-xs font-medium",children:[!s&&(0,a.jsx)(o.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 max-w-[160px] overflow-hidden truncate md:whitespace-nowrap",children:e}),(0,a.jsx)("button",{type:"button",className:"flex-shrink-0 rounded-sm duration-100 ease-out hover:bg-muted-hover",onClick:()=>g(t),children:(0,a.jsx)(o.Z,{name:"close_small"})})]})},t)}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key&&" "!==e.key||e.metaKey||""===c.trim()?"Backspace"===e.key&&""===c&&t.length>0&&g(t.length-1):(e.preventDefault(),x(c.trim()))},onPaste:e=>{e.preventDefault();let a=u(e.clipboardData.getData("text")),n=new Set(t),r=[...t];a.forEach(e=>{let t=""!==e.trim();!n.has(e)&&t&&(r.push(e),n.add(e))}),s(r)},placeholder:m,className:"min-w-[80px] flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",...h})]})};m.displayName="TagsInput"},99153:function(e,t,s){s.d(t,{O:function(){return o}});var a=s(57437),n=s(78298),r=s(55721),i=s(57346),l=s(27132);let o=()=>{let e=(0,l.Z)("md"),{theme:t,setTheme:s}=(0,n.F)();return e?null:(0,a.jsxs)(r.Ph,{children:[(0,a.jsxs)(r.kt,{children:[(0,a.jsx)(i.Z,{name:"contrast"}),(0,a.jsx)("p",{children:"Appearance"})]}),(0,a.jsx)(r.cq,{children:(0,a.jsx)(r.TG,{children:(0,a.jsxs)(r._x,{value:t,onValueChange:e=>{("light"===e||"dark"===e||"system"===e)&&s(e)},children:[(0,a.jsx)(r.qB,{value:"light",children:"Light"}),(0,a.jsx)(r.qB,{value:"dark",children:"Dark"}),(0,a.jsx)(r.qB,{value:"system",children:"System theme"})]})})})]})}},32129:function(e,t,s){var a=s(57437),n=s(54365),r=s(27648),i=s(99376);s(2265);var l=s(30438),o=s(46170),c=s(62869),d=s(57346);t.Z=e=>{let{plan:t,withWrapper:s=!1,className:u,...m}=e,p=(0,i.usePathname)(),h=(0,l.c)();return(0,o.XB)(t)||!h?null:s?(0,a.jsxs)("div",{className:"flex w-full items-center justify-between rounded-md bg-muted px-3 py-2 text-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Turn Pro"]}),(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsx)(r.default,{href:"".concat(p,"?settings=billing"),children:"Upgrade"})})]}):(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsxs)(r.default,{href:"".concat(p,"?settings=billing"),children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Upgrade"]})})}},2124:function(e,t,s){s.d(t,{F:function(){return h}});var a=s(57437),n=s(38706),r=s(76678),i=s(60256),l=s(88391),o=s(3813),c=s(94508),d=s(55157),u=s(35974),m=s(26815),p=s(74991);let h=e=>{let{visibility:t,setVisibility:s,onClick:h,disabled:x,className:g,customPrivateDescription:f,customPublicDescription:j,redirectToSubscription:v=!1,workspacePlan:b}=e,y=(0,n.T_)("VisibilitySelection"),w=(0,o.sp)(b),N=(0,i.dF)({workspacePlan:b}),_=(0,l.z)(r.g),{openSettings:k}=(0,d.r)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(p.E,{className:g,disabled:x,defaultValue:"public",value:t,onValueChange:e=>{s(e)},children:[(0,a.jsxs)("div",{className:"flex items-start gap-2 px-4 py-2",children:[(0,a.jsx)(p.m,{value:"public",id:"public",onClick:()=>{null==h||h()}}),(0,a.jsxs)(m.Label,{htmlFor:"public",className:(0,c.cn)("flex w-full cursor-pointer flex-col gap-0.5"),children:[(0,a.jsx)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:y("public.title")}),j||(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("public.description")})]})]}),(0,a.jsxs)("div",{className:"flex w-full items-start gap-2 px-4 py-2",children:[(0,a.jsx)(p.m,{value:"private",id:"private",onClick:e=>{N?null==h||h():(e.preventDefault(),v?k("billing"):_({childProps:{dialogDescription:y("upgradeMessages.workspaceRequired")}}))}}),(0,a.jsxs)(m.Label,{htmlFor:"private",className:"flex w-full cursor-pointer flex-col gap-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:[y("workspace.title"),(0,a.jsx)(u.C,{variant:"affirmative",children:"Pro"})]}),f||(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("workspace.description")})]})]}),!!w&&(0,a.jsxs)("div",{className:"flex w-full items-start gap-2 px-4 py-2",children:[(0,a.jsx)(p.m,{value:"draft",id:"draft",onClick:e=>{N?null==h||h():(e.preventDefault(),v?k("billing"):_({childProps:{dialogDescription:y("upgradeMessages.proRequired")}}))}}),(0,a.jsxs)(m.Label,{htmlFor:"draft",className:"flex w-full cursor-pointer flex-col gap-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:[y("draft.title"),(0,a.jsx)(u.C,{variant:"affirmative",children:"Business"})]}),f||(0,a.jsx)("p",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("draft.description")})})]})]})]})})}},35194:function(e,t,s){s.d(t,{CreateWorkspaceDialog:function(){return k}});var a=s(57437),n=s(27648),r=s(2265),i=s(14438),l=s(6812),o=s(6371),c=s(7309),d=s(62869),u=s(95186),m=s(26815),p=s(65269),h=s(94508),x=s(29827),g=s(21770),f=s(52558),j=s(61922),v=s(108),b=s(64040),y=s(49131),w=s(89668);let N=e=>{let{closeDialog:t}=e,s=(0,x.NL)(),{setCurrentWorkspaceId:a}=(0,j.J1)(),{store:n}=(0,l.bm)(),{authUser:r}=(0,f.Eu)(),{toCheckout:o}=(0,v.m)(),{mutate:c,isPending:d}=(0,g.D)({mutationFn:async e=>{let{name:t}=e;return(0,y.SJ)().post("/user/workspaces",{name:t})},onSuccess:async(e,l)=>{var c;let{plan:d}=l,u=w.t.workspaces({userId:null==r?void 0:r.uid}).queryKey;s.setQueryData(u,t=>({workspaces:[...(null==t?void 0:t.workspaces)||[],e]}));let m=w.t.detail({workspaceId:e.id}).queryKey;s.setQueryData(m,{workspace:e,projects:[]}),null==n||n.setState({workspaces:[...null!==(c=null==n?void 0:n.getState().workspaces)&&void 0!==c?c:[],e]}),a(e.id);try{if(!e.id)throw Error("Workspace ID is required");await o({plan:d,workspaceId:e.id,changeType:"upgrade"}),i.Am.success("Workspace created successfully",{description:e.name})}finally{t()}},onSettled:e=>{e&&(s.invalidateQueries({queryKey:w.t.workspaces({userId:null==r?void 0:r.uid}).queryKey}),s.invalidateQueries({queryKey:w.t.detail({workspaceId:e.id}).queryKey}))},onError:e=>{(0,b.Eo)(e)}});return{createWorkspace:c,isCreatingWorkspace:d}},_={name:{title:"Create a Workspace",description:"Create a new place to make projects or collaborate with others."},plan:{title:"Select a Plan",description:"Select a plan for your new workspace."}},k=()=>{let e=(0,l.Q)(e=>e.showCreateWorkspaceDialog),t=(0,l.Q)(e=>e.setShowCreateWorkspaceDialog),[s,n]=(0,r.useState)("name"),{title:i,description:o}=_[s];return(0,a.jsx)(p.v,{title:i,description:o,open:e,onOpenChange:e=>{e||n("name"),t(e)},className:"plan"===s?"max-w-[500px]":"",children:(0,a.jsx)(S,{closeDialog:()=>{n("name"),t(!1)},step:s,setStep:n})})},S=e=>{let{closeDialog:t,step:s,setStep:n}=e,[l,o]=(0,r.useState)(""),{createWorkspace:d,isCreatingWorkspace:u}=N({closeDialog:t}),m=c.qI.planOptions[0],[p,h]=(0,r.useState)(m);return(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),"name"===s){if(""===l){i.Am.error("Workspace name is required");return}n("plan");return}null!==p&&d({name:l,plan:p})},className:"flex flex-col gap-4",children:[(0,a.jsx)(C,{step:s,workspaceName:l,setWorkspaceName:o,closeDialog:t,setStep:n}),(0,a.jsx)(E,{step:s,plan:p,setPlan:h,setStep:n,workspaceName:l,isCreatingWorkspace:u})]})},C=e=>{let{step:t,workspaceName:s,setWorkspaceName:n,closeDialog:r,setStep:i}=e;return(0,a.jsxs)("div",{className:(0,h.cn)("hidden flex-col gap-4","name"===t&&"flex"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-1",children:[(0,a.jsx)(m.Label,{children:"Workspace Name"}),(0,a.jsx)(u.I,{id:"workspaceName",value:s,onChange:e=>n(e.target.value),placeholder:"Enter workspace name",required:!0})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 pb-1",children:[(0,a.jsx)(d.z,{type:"button",className:"flex-1",variant:"secondary",onClick:r,children:"Go Back"}),(0,a.jsx)(d.z,{className:"flex-1",disabled:!s,type:"button",onClick:()=>i("plan"),children:"Continue to Plan"})]})]})},E=e=>{let{step:t,plan:s,setPlan:r,setStep:i,workspaceName:l,isCreatingWorkspace:u}=e,m=s===c.qI.planOptions[0];return(0,a.jsxs)("div",{className:(0,h.cn)("hidden flex-col gap-4","plan"===t&&"flex"),children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-2",children:[(0,a.jsxs)(o._b,{name:"Pro",price:c.qI.planOptions[0].monthlyPrice,description:"For more projects and usage",highlighted:m,children:[(0,a.jsx)(o.ak,{type:"button",onClick:()=>r(c.qI.planOptions[0]),variant:m?"affirmative":"default",className:"cursor-default hover:opacity-100",children:m?"Selected":"Select"}),(0,a.jsx)(o.jq,{label:"Everything in Free, plus:",features:["100+ credits per month","Private projects","Remove the Lovable badge","Custom domains","Role based access"]})]}),(0,a.jsxs)(o._b,{name:"Enterprise",price:0,description:"For custom needs",highlighted:!1,hidePrice:!1,customPriceLabel:"Custom",children:[(0,a.jsx)(d.z,{type:"button",asChild:!0,className:"w-full whitespace-nowrap bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",children:(0,a.jsx)(n.default,{target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"})}),(0,a.jsx)(o.jq,{label:"Everything in Pro, plus:",features:["Dedicated support","Custom integrations","SSO","Opt out of data training"]})]})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 py-1",children:[(0,a.jsx)(d.z,{type:"button",className:"flex-1",variant:"secondary",onClick:()=>i("name"),children:"Go Back"}),(0,a.jsx)(d.z,{type:"submit",className:"flex-1",disabled:null===s||!l||u,loading:u,children:u?"Creating...":"Create Workspace"})]})]})}},65269:function(e,t,s){s.d(t,{v:function(){return u}});var a=s(57437),n=s(49027),r=s(95098),i=s(2265),l=s(62869),o=s(57346),c=s(41135),d=s(94508);let u=e=>{let{title:t,description:s,children:u,open:m,onOpenChange:p,className:h}=e;return(0,i.useEffect)(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),(0,a.jsx)(n.Vq,{open:m,onOpenChange:p,children:(0,a.jsx)(n.PK,{children:(0,a.jsxs)(n.cZ,{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-background px-4 md:px-0",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(r.TX,{children:[(0,a.jsx)(n.$N,{children:t}),(0,a.jsx)(n.Be,{children:s})]}),(0,a.jsxs)("div",{className:(0,d.cn)("flex max-w-96 flex-col gap-6 overflow-auto p-1",h),children:[(0,a.jsx)(c.xx,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"mr-auto text-2xl md:text-3xl",children:t}),(0,a.jsx)("p",{className:"w-full",children:s})]}),u]}),(0,a.jsx)("div",{className:"absolute right-2 top-2 md:right-8 md:top-8",children:(0,a.jsx)(n.GG,{asChild:!0,children:(0,a.jsx)(l.z,{className:"hover:bg-transparent hover:opacity-75",variant:"ghost",children:(0,a.jsx)(o.Z,{name:"close",size:"small"})})})})]})})})}},82157:function(e,t,s){s.d(t,{w:function(){return c}});var a=s(57437),n=s(2265),r=s(55721),i=s(57346),l=s(94508),o=s(81103);let c=e=>{let{label:t,isSelected:s,onClick:c,disabled:d,className:u,destructive:m,tooltip:p}=e,[h,x]=(0,n.useState)(!1);return(0,a.jsxs)(o.u,{open:void 0!==p&&h,onOpenChange:x,children:[(0,a.jsx)(o.aJ,{asChild:!0,children:(0,a.jsxs)(r.Xi,{onClick:c,disabled:d,className:(0,l.cn)("flex items-center justify-between",{"bg-muted":s,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":m},u),children:[t,s&&(0,a.jsx)(i.Z,{name:"check",size:"small"})]})}),(0,a.jsx)(o._v,{side:"right",className:"max-w-[30ch]",children:p})]})}},65613:function(e,t,s){s.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var a=s(57437),n=s(77712),r=s(2265),i=s(94508);let l=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg]:absolute [&>svg]:text-foreground [&>svg]:left-4 [&>svg]:top-4 [&>svg+div]:translate-y-[-3px] [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground bg-destructive border-destructive-foreground dark:border-destructive-foreground [&>svg]:text-destructive-foreground",warning:"text-warning-foreground bg-warning border-warning-foreground dark:border-warning-foreground [&>svg]:text-warning-foreground",affirmative:"text-affirmative-foreground bg-affirmative border-affirmative-foreground dark:border-affirmative-foreground [&>svg]:text-affirmative-foreground",success:"text-success-foreground bg-success border-success-foreground dark:border-success-foreground [&>svg]:text-success-foreground"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:n,...r}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:n}),s),...r})});o.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...n})});c.displayName="AlertTitle";let d=r.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...n})});d.displayName="AlertDescription"},23518:function(e,t,s){s.d(t,{di:function(){return m},e8:function(){return c},fu:function(){return u},mY:function(){return l},rb:function(){return d},sZ:function(){return o}});var a=s(57437),n=s(46343);s(2265),s(26110);var r=s(94508),i=s(57346);function l(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY,{"data-slot":"command",className:(0,r.cn)("flex h-full w-full flex-col overflow-hidden rounded-xl bg-popover text-popover-foreground",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,a.jsx)(i.Z,{name:"search",className:"size-4 shrink-0 opacity-50"}),(0,a.jsx)(n.mY.Input,{"data-slot":"command-input",className:(0,r.cn)("flex h-10 w-full rounded-xl bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.List,{"data-slot":"command-list",className:(0,r.cn)("max-h-[300px] scroll-py-1 overflow-y-auto overflow-x-hidden",t),...s})}function d(e){let{...t}=e;return(0,a.jsx)(n.mY.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.Group,{"data-slot":"command-group",className:(0,r.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s})}function m(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.Item,{"data-slot":"command-item",className:(0,r.cn)("relative flex cursor-default select-none items-center gap-2 rounded-lg px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...s})}},5073:function(e,t,s){s.d(t,{Yi:function(){return o},bZ:function(){return c},zs:function(){return l}});var a=s(57437),n=s(2265),r=s(16605),i=s(94508);let l=r.fC,o=r.xz,c=n.forwardRef((e,t)=>{let{className:s,align:n="center",sideOffset:l=4,...o}=e;return(0,a.jsx)(r.VY,{ref:t,align:n,sideOffset:l,className:(0,i.cn)("z-50 w-64 origin-[--radix-hover-card-content-transform-origin] rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})});c.displayName=r.VY.displayName},74991:function(e,t,s){s.d(t,{E:function(){return o},m:function(){return c}});var a=s(57437),n=s(20653),r=s(42325),i=s(2265),l=s(94508);let o=i.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.fC,{className:(0,l.cn)("grid gap-2",s),...n,ref:t})});o.displayName=r.fC.displayName;let c=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.ck,{ref:t,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...i,children:(0,a.jsx)(r.z$,{className:"flex items-center justify-center",children:(0,a.jsx)(n.jXb,{className:"h-3.5 w-3.5 fill-primary"})})})});c.displayName=r.ck.displayName},6512:function(e,t,s){s.d(t,{Separator:function(){return l}});var a=s(57437),n=s(55156),r=s(2265),i=s(94508);let l=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:l=!0,...o}=e;return(0,a.jsx)(n.f,{ref:t,decorative:l,orientation:r,className:(0,i.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});l.displayName=n.f.displayName},12339:function(e,t,s){s.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return l},nU:function(){return d}});var a=s(57437),n=s(20271),r=s(2265),i=s(94508);let l=n.fC,o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg p-1 text-muted-foreground",s),...r})});o.displayName=n.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...r})});c.displayName=n.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});d.displayName=n.VY.displayName},61563:function(e,t,s){s.d(t,{G:function(){return d},t:function(){return c}});var a=s(57437),n=s(90175),r=s(2265),i=s(63611),l=s(94508);let o=r.createContext({size:"default",variant:"default"}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,children:c,...d}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,l.cn)("flex items-center justify-center gap-1",s),...d,children:(0,a.jsx)(o.Provider,{value:{variant:r,size:i},children:c})})});c.displayName=n.fC.displayName;let d=r.forwardRef((e,t)=>{let{className:s,children:c,variant:d,size:u,...m}=e,p=r.useContext(o);return(0,a.jsx)(n.ck,{ref:t,className:(0,l.cn)((0,i.E)({variant:p.variant||d,size:p.size||u}),s),...m,children:c})});d.displayName=n.ck.displayName},63611:function(e,t,s){s.d(t,{E:function(){return o},Z:function(){return c}});var a=s(57437),n=s(9987),r=s(77712),i=s(2265),l=s(94508);let o=(0,r.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,t)=>{let{className:s,variant:r,size:i,...c}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,l.cn)(o({variant:r,size:i,className:s})),...c})});c.displayName=n.f.displayName},30438:function(e,t,s){s.d(t,{c:function(){return o}});var a=s(52558),n=s(61922),r=s(71759);let i=(e,t)=>!!e&&!!t&&t.owner_id===e,l=()=>{let e=(0,r.MD)(),t=(0,r.q$)(t=>e?t.projectWorkspace:null),s=(0,n.i7)(t=>e?null:t.currentWorkspace);return t||s},o=()=>{let{authUser:e}=(0,a.Eu)(),t=l();return i(null==e?void 0:e.uid,t)}},6478:function(e,t,s){s.d(t,{F:function(){return i}});var a=s(57437),n=s(81103),r=s(2265);let i=e=>{let[t,s]=(0,r.useState)(!1),i=(0,r.useRef)(),l=(0,r.useCallback)(e=>{e&&(clearTimeout(i.current),navigator.clipboard.writeText(e),s(!0),i.current=setTimeout(()=>{s(!1)},1e3))},[]);return s=>{let{TriggerComponent:r,textToCopy:i,copiedFeedbackText:o="Copied!"}=s;return(0,a.jsx)(n.pn,{children:(0,a.jsxs)(n.u,{open:t,children:[(0,a.jsx)(n.aJ,{onClick:t=>{(null==e||!e.altKey||t.altKey)&&i&&l(i)},asChild:!0,className:"hello",children:(0,a.jsx)(r,{})}),(0,a.jsx)(n._v,{children:(0,a.jsx)("p",{children:o})})]})})}}},5103:function(e,t,s){s.d(t,{f:function(){return r}});var a=s(52558),n=s(71759);function r(){let{authUser:e}=(0,a.Eu)(),t=(0,n.hO)(e=>e.projectWorkspace),s=(0,n.hO)(e=>e.memberships);return{projectWorkspace:t,isMemberOfWorkspace:s.some(t=>t.user_id===(null==e?void 0:e.uid)),workspaceMemberships:s}}},81677:function(e,t,s){s.d(t,{GD:function(){return o},Zl:function(){return c},Hp:function(){return p},Mn:function(){return m}});var a=s(14438),n=s(91115),r=s(21288);let i="https://github.com/login/oauth/authorize?client_id=".concat("Iv1.365d6a195dbca85b"),l="https://github.com/apps/".concat("lovable-dev","/installations/new"),o="githubOAuthNonce",c=n.z.object({nonce:n.z.string(),workspaceId:n.z.string().optional()}),d=e=>(null==e?void 0:e.id)?"".concat(l,"/permissions?target_id=").concat(e.id,"&target_type=").concat(e.type):l,u=(e,t)=>{let s=crypto.randomUUID();try{localStorage.setItem(o,s)}catch(e){r.logging.error("Failed to set state in GitHub OAuth popup"),a.Am.error("Failed to initiate GitHub OAuth flow",{description:"Try clearing browser local storage and try again."});return}let n=(null==t?void 0:t.workspaceId)?{nonce:s,workspaceId:t.workspaceId}:{nonce:s,workspaceId:void 0},i=new URL(e);i.searchParams.set("state",btoa(JSON.stringify(n))),e=i.toString();let l=window.open(e,"_blank","width=600,height=700,left=100,top=100");if(!l){r.logging.error("Failed to open GitHub OAuth popup");return}l.focus()},m=e=>{let{githubOwner:t,workspaceId:s}=e;u(d(t),{workspaceId:s})},p=()=>{u(i)}},33910:function(e,t,s){s.d(t,{D:function(){return l}});var a=s(92850),n=s(2265),r=s(60256),i=s(79804);let l=e=>{var t,s,l,o;let{enabled:c}=e,{userData:d}=(0,r.SE)(),u=(0,a.a)(i.V.installations({enabled:c})),m=null==d?void 0:null===(t=d.github)||void 0===t?void 0:t.encrypted_access_token,p=(0,n.useRef)(m);return(0,n.useEffect)(()=>{p.current!==m&&(u.refetch(),p.current=m)},[m,u]),{isLoading:u.isLoading,installations:null===(s=u.data)||void 0===s?void 0:s.installations,hasAccessToken:null===(l=u.data)||void 0===l?void 0:l.has_access_token,hasValidAccessToken:null===(o=u.data)||void 0===o?void 0:o.has_valid_access_token}}},59709:function(e,t,s){s.d(t,{G:function(){return l},d:function(){return c}});var a=s(29827),n=s(2265),r=s(14438),i=s(91115);let l="mcp_oauth_data",o=i.z.object({type:i.z.literal("mcpAuth"),success:i.z.boolean(),error:i.z.string().optional()}),c=e=>{let{workspaceId:t,onConnectSuccess:s,onConnectError:i,enabled:l=!0}=e,c=(0,a.NL)();(0,n.useEffect)(()=>{if(!l)return;let e=async e=>{if(e.origin!==window.location.origin)return;let a=o.safeParse(e.data);a.success&&(a.data.success?(r.Am.success("Authorization successful!"),await c.invalidateQueries({queryKey:["mcp-servers",t]}),s&&s()):(r.Am.error(a.data.error||"OAuth authorization failed"),i&&i()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[c,t,s,i,l])}},59053:function(e,t,s){s.d(t,{O:function(){return l}});var a=s(2265),n=s(52558),r=s(79358),i=s(61922);let l=e=>{var t,s;let{isAuthenticated:l}=(0,n.Eu)(),c=(0,i.aS)(e=>e.currentWorkspace),d=null!==(t=null==e?void 0:e.projectWorkspace)&&void 0!==t?t:c,u=(0,a.useMemo)(()=>{var e;if(d&&l)return(null!==(e=d.credits_granted)&&void 0!==e?e:0)-d.credits_used>0||d.daily_credits_used<d.daily_credits_limit||(d.billing_period_credits_used||0)<d.billing_period_credits_limit},[d,l]),m=null==d?void 0:d.daily_credits_limit,p=null==d?void 0:d.daily_credits_used,h=null==d?void 0:d.billing_period_credits_limit,x=null==d?void 0:d.billing_period_credits_used,g=void 0!==h&&void 0!==x&&h>0,f=void 0!==m&&void 0!==p&&m>0,j=g?(0,r.u)(h-x,h):"",v=f?(0,r.u)(m-p,m):"";return{dailyCreditLimit:m,dailyCreditsUsed:p,billingPeriodCreditLimit:h,billingPeriodCreditsUsed:x,hasBillingPeriodCredits:g,hasDailyCreditsLimit:f,billingPeriodCreditsFormatted:j,totalCreditsUsedInBillingPeriod:null==d?void 0:d.total_credits_used_in_billing_period,dailyCreditsFormatted:v,rolloverCredits:(null==d?void 0:d.rollover_credits_limit)!==void 0&&(null==d?void 0:d.rollover_credits_used)!==void 0?d.rollover_credits_limit-d.rollover_credits_used:void 0,bonusCredits:(null==d?void 0:d.credits_granted)!==void 0?d.credits_granted-(null!==(s=d.credits_used)&&void 0!==s?s:0):void 0,areCreditsAvailable:u,billingPeriodEndDate:o(null==d?void 0:d.billing_period_end_date)}},o=e=>e?"string"==typeof e?new Date(e):e.toDate():null},78844:function(e,t,s){s.d(t,{Ef:function(){return u},YP:function(){return c},hb:function(){return m},i6:function(){return d}});var a=s(2265),n=s(14438),r=s(91115),i=s(60256),l=s(21288),o=s(25566);let c="supabaseOAuthNonce",d="supabaseOAuthCodeVerifier",u=r.z.object({workspaceId:r.z.string(),userId:r.z.string().optional(),nonce:r.z.string()}),m=e=>{let[t,s]=(0,a.useState)(!1),{userData:r}=(0,i.SE)();return{handleConnect:(0,a.useCallback)(async()=>{s(!0);try{let t=window.location.origin,a=crypto.randomUUID();try{localStorage.setItem(c,a)}catch(e){l.logging.error("Error storing nonce in localStorage:",{error:e}),n.Am.error("Failed to initiate Supabase OAuth flow",{description:"Try clearing browser local storage and try again."}),s(!1);return}let i=btoa(JSON.stringify({workspaceId:e,userId:null==r?void 0:r.id,nonce:a})),u=o.env.NEXT_PUBLIC_SUPABASE_OAUTH_CLIENT_ID||"dbd565fc-4637-4cb6-ab68-0af4b5708417",m=function(){let e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(),h=await p(m);localStorage.setItem(d,m);let x="https://api.supabase.com/v1/oauth/authorize?response_type=code"+"&client_id=".concat(u)+"&redirect_uri=".concat(encodeURIComponent("".concat(t,"/supabase/callback")))+"&state=".concat(encodeURIComponent(i))+"&code_challenge=".concat(encodeURIComponent(h))+"&code_challenge_method=S256",g=window.open(x,"_blank","width=600,height=700,left=100,top=100");g?g.focus():window.location.href=x}catch(e){l.logging.error("Error initiating Supabase connection:",{error:e}),n.Am.error("Connection Error",{description:"An error occurred while connecting to Supabase. Please try again."})}finally{s(!1)}},[e,null==r?void 0:r.id]),isConnecting:t}};async function p(e){let t=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(s)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},10441:function(e,t,s){s.d(t,{c:function(){return i}});var a=s(52274),n=s(49131),r=s(97318);let i={domains:e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.C)({queryKey:r.iZ.domains(t),queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/domains")),refetchOnMount:!1,refetchOnWindowFocus:!1,enabled:s&&!!t,staleTime:3e5,retry:!1})}}},51408:function(e,t,s){s.d(t,{V:function(){return l}});var a=s(52274),n=s(49131),r=s(21288),i=s(97318);let l={workspace:e=>{let{workspaceId:t,userData:s}=e;return(0,a.C)({queryKey:i.TZ.workspace(t),queryFn:async()=>{let e=(0,n.SJ)();return(await e.get("/user/workspaces/".concat(t))).workspace},enabled:!!s&&!!t})},workspaces:e=>{let{userData:t}=e;return(0,a.C)({queryKey:i.TZ.workspaces(),queryFn:async()=>{let e=(0,n.SJ)();return await e.get("/user/workspaces")},enabled:!!t})},experimentalFeatures:e=>{let{user:t}=e;return(0,a.C)({queryKey:i.TZ.experimentalFeatures(),enabled:!!t&&!!t.idToken,refetchOnWindowFocus:!1,queryFn:async()=>{let e=(0,n.SJ)();try{return await e.get("/users/".concat(null==t?void 0:t.uid,"/experimental-features"))}catch(e){return r.logging.error("Failed to fetch experimental features",{error:e}),null}}})},contributions:e=>{let{userData:t}=e;return(0,a.C)({queryKey:i.TZ.contributions(null==t?void 0:t.id),queryFn:async()=>(null==t?void 0:t.id)?(0,n.SJ)().get("/users/".concat(t.id,"/contributions")):{},enabled:!!(null==t?void 0:t.username)})},publicProfile:e=>{let{username:t}=e;return(0,a.C)({queryKey:i.TZ.profile(t),queryFn:()=>(0,n.Tb)().get("/profile/".concat(t)),enabled:!!t,retry:!1})}}},74225:function(e,t,s){s.d(t,{P:function(){return a}});let a=e=>e.replace(/(^\w+:|^)\/\//,"")},72384:function(e,t,s){var a,n;s.d(t,{S:function(){return a}}),(n=a||(a={})).AGENT="agent",n.INSTANT="instant"},22853:function(e,t,s){var a,n;s.d(t,{k:function(){return a}}),(n=a||(a={})).ACTIVE_HEALTHY="ACTIVE_HEALTHY",n.ACTIVE_UNHEALTHY="ACTIVE_UNHEALTHY",n.COMING_UP="COMING_UP",n.GOING_DOWN="GOING_DOWN",n.INACTIVE="INACTIVE",n.INIT_FAILED="INIT_FAILED",n.REMOVED="REMOVED",n.RESTARTING="RESTARTING",n.UNKNOWN="UNKNOWN",n.UPGRADING="UPGRADING",n.PAUSING="PAUSING",n.RESTORING="RESTORING",n.RESTORE_FAILED="RESTORE_FAILED",n.PAUSE_FAILED="PAUSE_FAILED"},79358:function(e,t,s){function a(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}function n(e,t){return"".concat(a(e),"/").concat(a(t))}s.d(t,{H:function(){return a},u:function(){return n}})},54616:function(e,t,s){s.d(t,{Jh:function(){return i},UM:function(){return o},hO:function(){return l}});var a=s(91115);let n=a.z.string().min(1,"Email is required").email("Please enter a valid email address"),r=a.z.array(n).max(3,"You can invite up to 3 team members").refine(e=>new Set(e.map(e=>e.toLowerCase())).size===e.length,{message:"Duplicate email addresses are not allowed"});function i(e){return n.safeParse(e).success}function l(e){let t=e.filter(e=>""!==e.trim());return r.safeParse(t)}function o(e,t){let s=e.filter(e=>""!==e.trim()),a=r.safeParse(s),i=[null,null,null];for(let t=0;t<3;t++){let s=e[t];if(s&&s.trim()){let e=n.safeParse(s);if(!e.success){var l;i[t]=(null===(l=e.error.errors[0])||void 0===l?void 0:l.message)||"Invalid email address"}}}let o=[];return a.success||(o=a.error.errors.filter(e=>0===e.path.length).map(e=>e.message)),t&&s.some(e=>e.trim().toLowerCase()===t.trim().toLowerCase())&&o.push("You cannot invite yourself"),{globalErrors:o,fieldErrors:i}}}}]);