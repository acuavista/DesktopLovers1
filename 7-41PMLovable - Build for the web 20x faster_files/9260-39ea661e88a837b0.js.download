try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2c0f9650-ee3e-4c62-99c0-f0696f64b055",e._sentryDebugIdIdentifier="sentry-dbid-2c0f9650-ee3e-4c62-99c0-f0696f64b055")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9260],{96484:function(e,t,r){"use strict";r.d(t,{L6:function(){return u},Rc:function(){return l},fm:function(){return i}});var n=r(57437),s=r(2265);let a="editor-mode-store",i=["auto","gpt-4.1","gpt-4.1-mini","o4-mini","gemini-2.5-pro","gemini-2.5-flash","claude-3.5-sonnet","claude-3.7-sonnet","claude-4-sonnet","claude-4-opus","silverleaf","goldrush"],o=(0,s.createContext)(null),l=e=>{let{children:t}=e,[r,i]=(0,s.useState)(()=>null);return(0,s.useEffect)(()=>{null===r?localStorage.removeItem(a):localStorage.setItem(a,JSON.stringify(r))},[r]),(0,n.jsx)(o.Provider,{value:{selectedModel:r,setSelectedModel:i},children:t})},u=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useGetSelectedChatModel must be used within a ModelSelectorProvider");return e}},72116:function(e,t,r){"use strict";r.d(t,{Cg:function(){return o},hP:function(){return v},zL:function(){return p}});var n=r(6273),s=r(91115),a=r(21288);let i=new n.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),o=e=>null!=e&&"object"==typeof e&&"type"in e&&"tool_use"===e.type&&"name"in e&&"data"in e&&"done"in e;s.z.object({type:s.z.literal("lov-sql"),lovSql:s.z.string(),done:s.z.boolean()}),s.z.object({type:s.z.literal("lov-mermaid"),mermaidCode:s.z.string(),done:s.z.boolean()});let l=s.z.object({type:s.z.literal("lov_action__link"),url:s.z.string(),text:s.z.string()}),u=s.z.object({type:s.z.literal("lov_action__migrate"),toolUseId:s.z.string().optional(),done:s.z.boolean()}),c=s.z.object({type:s.z.literal("lov_action__message_prompt"),message:s.z.string(),text:s.z.string()}),d=s.z.object({type:s.z.literal("lov_action__knowledge")}),g=s.z.object({type:s.z.literal("lov_action__secret_form"),name:s.z.string()}),f=s.z.object({type:s.z.literal("lov_action__suggestion"),message:s.z.string(),text:s.z.string()}),m=s.z.union([l,u,c,d,g,f]);function p(e){return e.parts.filter(e=>"done"in e&&e.done&&("search_replace_parts"in e||"content"in e)).length}function v(e){let t=[],r=[],n=null,s=!1,l=!1,u=!1,c=!1,d=!1,g=!1,f=!1,p=!1,v=!1,_="",b="",S="",y="",E=null,w="",x="";function C(){var e,C,I,k,M,T,j;let R=S.trim();if("<lov-plan>"===R||"</lov-plan>"===R){S="";return}if(S.trim().startsWith("<lov-tool-use")){let i;v=!0;let o=(y=S).match(/id="([^"]*)"/),l=y.match(/name="([^"]*)"/),u=y.match(/data="((?:[^"\\]|\\.)*)"(?=\s|\/|>)/),c=y.match(/data="(.*)$/),d=y.match(/failed="([^"]*)"/),g=(null==d?void 0:d[1])==="true",f=y.match(/requires-approval="([^"]*)"/),m=(null==f?void 0:f[1])==="true",p=y.match(/user-input="((?:[^"\\]|\\.)*)"/);if(null==p?void 0:p[1])try{let e=p[1].replace(/\\"/g,'"');e=e.replace(/\\\\/g,"\\"),i=JSON.parse(e)}catch(e){a.logging.error("Failed to parse user input",{error:e,userInput:p[1]})}let _=y.match(/duration="([^"]*)"/),b=_?Math.floor(parseFloat(_[1])):void 0;if(void 0!==b&&b<=0&&(b=1),l&&n){let a=u?u[1]:c?c[1]:"",d=a?h(a):{};s&&n&&"parts"in n?n.parts.push({type:"tool_use",id:null!==(e=null==o?void 0:o[1])&&void 0!==e?e:null,name:l[1],data:a,parsedData:d,done:!1,failed:g,duration:b,requiresApproval:m,userInput:i}):(t.push(n),t.push({type:"tool_use",id:null!==(C=null==o?void 0:o[1])&&void 0!==C?C:null,name:l[1],data:a,parsedData:d,done:!1,failed:g,duration:b,requiresApproval:m,userInput:i}),n={type:"text",content:""}),o&&"lov-supabase-migration"===l[1]&&!r.find(e=>"lov_action__migrate"===e.type)&&r.push({type:"lov_action__migrate",done:!1,toolUseId:o[1]})}}else if(v){if(y+=S,S.includes("</lov-tool-use>")){if(v=!1,s&&n&&"parts"in n){let e=n.parts.findLastIndex(e=>"tool_use"===e.type);if(e>=0){let t=n.parts[e];if(t.done=!0,t.id&&"lov-supabase-migration"===t.name){let e=r.find(e=>"lov_action__migrate"===e.type&&e.toolUseId===t.id);e&&"lov_action__migrate"===e.type&&(e.done=!0)}}}else{let e=t.findLastIndex(e=>o(e));if(e>=0){let n=t[e];if(n.done=!0,n.id&&"lov-supabase-migration"===n.name){let e=r.find(e=>"lov_action__migrate"===e.type&&e.toolUseId===n.id);e&&"lov_action__migrate"===e.type&&(e.done=!0)}}}}}else if("<thinking>"===S.trim())s&&n&&"parts"in n?n.parts.push({type:"tool_use",id:null,name:"lov-think",data:"",parsedData:{},done:!1,failed:!1,requiresApproval:!1}):(n&&t.push(n),t.push({type:"tool_use",id:null,name:"lov-think",data:"",parsedData:{},done:!1,failed:!1,requiresApproval:!1}),n={type:"text",content:""}),f=!0,S="";else if("</thinking>"===S.trim()){let e=x.trim(),r={content:e};if(s&&n&&"parts"in n){let t=n.parts.findLastIndex(e=>"tool_use"===e.type&&"lov-think"===e.name);if(t>=0){let s=n.parts[t];s.done=!0,s.data=e,s.parsedData=r}}else{let n=t.findLastIndex(e=>o(e)&&"lov-think"===e.name);if(n>=0){let s=t[n];s.done=!0,s.data=e,s.parsedData=r}}f=!1,x="",S=""}else if("<lov-code>"===S.trim())n&&t.push(n),s=!0,n={parts:[],done:!1};else if("</lov-code>"===S.trim())n&&"done"in n&&(n.done=!0,t.push(n),n=null),s=!1;else if("<lov-sql>"===S.trim())n&&t.push(n),l=!0,n={type:"lov-sql",lovSql:"",done:!1};else if("</lov-sql>"===S.trim())n&&"lovSql"in n&&(n.done=!0,t.push(n),r.find(e=>"lov_action__migrate"===e.type)||r.push({type:"lov_action__migrate",done:!0}),n=null),l=!1;else if("<lov-mermaid>"===S.trim())n&&t.push(n),u=!0,n={type:"lov-mermaid",mermaidCode:"",done:!1};else if("</lov-mermaid>"===S.trim())n&&"mermaidCode"in n&&(n.done=!0,t.push(n),n=null),u=!1;else if(["<lov-actions>","<actions>"].includes(S.trim()))p=!0;else if(["</lov-actions>","</actions>"].includes(S.trim()))p=!1,r.push(...function(e){try{return i.parse(e).map(e=>{try{var t,r,n,s,i,o,l,u,c,d;if("lov-link"in e)return{type:"lov_action__link",url:null===(t=e[":@"])||void 0===t?void 0:t["@_url"],text:null===(n=e["lov-link"])||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r["#text"]};if("lov-knowledge"in e)return{type:"lov_action__knowledge"};if("lov-message-prompt"in e)return{type:"lov_action__message_prompt",message:null===(s=e[":@"])||void 0===s?void 0:s["@_message"],text:null===(o=e["lov-message-prompt"])||void 0===o?void 0:null===(i=o[0])||void 0===i?void 0:i["#text"]};if("lov-secret-form"in e)return{type:"lov_action__secret_form",name:null===(l=e[":@"])||void 0===l?void 0:l["@_name"]};if("lov-suggestion"in e)return{type:"lov_action__suggestion",message:null===(u=e[":@"])||void 0===u?void 0:u["@_message"],text:null===(d=e["lov-suggestion"])||void 0===d?void 0:null===(c=d[0])||void 0===c?void 0:c["#text"]};return a.logging.error("Unknown Lov action",{node:e}),null}catch(t){return a.logging.error("Error processing XML node",{error:t,node:e}),null}}).filter(e=>null!==e).reduce((e,t)=>{let r=m.safeParse(t);return r.success?e.push(r.data):a.logging.error("Failed to validate Lov action",{action:t,error:r.error}),e},[])}catch(t){return a.logging.error("Error parsing XML in parseLovActions",{error:t,input:e}),[]}}(w)),w="";else if(S.startsWith('<lov-write file_path="'))c=!0,b=(null===(I=S.match(/"([^"]*)"/))||void 0===I?void 0:I[1])||"",s&&n&&"parts"in n&&n.parts.push({type:"writing_file",file_path:b,content:"",done:!1});else if(S.startsWith('<lov-search-replace file_path="'))d=!0,b=(null===(k=S.match(/"([^"]*)"/))||void 0===k?void 0:k[1])||"",s&&n&&"parts"in n&&n.parts.push({type:"edit",file_path:b,search_replace_parts:[],done:!1});else if(S.startsWith('<lov-delete file_path="'))g=!0,b=(null===(M=S.match(/"([^"]*)"/))||void 0===M?void 0:M[1])||"",s&&n&&"parts"in n&&n.parts.push({type:"delete",file_path:b});else if(S.startsWith('<lov-rename original_file_path="')){let e=(null===(T=S.match(/original_file_path="([^"]*)"/))||void 0===T?void 0:T[1])||"",t=(null===(j=S.match(/new_file_path="([^"]*)"/))||void 0===j?void 0:j[1])||"";s&&n&&"parts"in n&&n.parts.push({type:"rename",original_file_path:e,new_file_path:t})}else if(S.startsWith("<lov-add-dependency>"))_=S.replace("<lov-add-dependency>","").replace("</lov-add-dependency>","").trim(),s&&n&&"parts"in n&&n.parts.push({type:"add_dependency",dependency:_,isDevDependency:!1});else if("</lov-add-dependency>"===S.trim())_="";else if(S.startsWith("<lov-add-dev-dependency>"))_=S.replace("<lov-add-dev-dependency>","").replace("</lov-add-dev-dependency>","").trim(),s&&n&&"parts"in n&&n.parts.push({type:"add_dependency",dependency:_,isDevDependency:!0});else if("</lov-add-dev-dependency>"===S.trim())_="";else if(S.startsWith("<lov-remove-dependency>")){let e=S.replace("<lov-remove-dependency>","").replace("</lov-remove-dependency>","").trim();s&&n&&"parts"in n&&n.parts.push({type:"remove_dependency",removed_dependency:e})}else if("</lov-remove-dependency>"===S.trim())_="";else if("</lov-write>"===S.trim()||"</lov-search-replace>"===S.trim()||"/>"===S.trim()&&g){if(c=!1,d=!1,g=!1,b="",s&&n&&"parts"in n){let e=n.parts[n.parts.length-1];"done"in e&&(e.done=!0)}}else if(s){if(v);else if(n&&"parts"in n){if(n.parts.length>0){let e=n.parts[n.parts.length-1];if(c&&"content"in e)e.content+=S;else if(d&&"search_replace_parts"in e){if("<lov-search>"===S.trim())e.search_replace_parts.push({search:"",replace:""}),E="search";else if("<lov-replace>"===S.trim())E="replace";else if("</lov-search>"===S.trim()||"</lov-replace>"===S.trim())E=null;else{let t=e.search_replace_parts[e.search_replace_parts.length-1];t&&E&&(t[E]+=S)}}else"text"===e.type&&"content"in e?e.content+=S:n.parts.push({type:"text",content:S})}else n.parts.push({type:"text",content:S})}}else l?n&&"lovSql"in n&&(n.lovSql+=S):u?n&&"mermaidCode"in n&&(n.mermaidCode+=S):p?w+=S:f?x+=S:(n&&"content"in n||(n={type:"text",content:""}),"content"in n&&(n.content+=S));S=""}let I=0;for(;I<e.length;){if(l){let t="</lov-sql>",r=e.indexOf(t,I);if(-1===r){S+=e.slice(I),I=e.length;break}S+=e.slice(I,r),C(),S=t,C(),I=r+t.length;continue}if(u){let t="</lov-mermaid>",r=e.indexOf(t,I);if(-1===r){S+=e.slice(I),I=e.length;break}S+=e.slice(I,r),C(),S=t,C(),I=r+t.length;continue}if("<"===e[I]){S&&C();let t=I,r=!1;for(;t<e.length&&!(++t>=e.length);){if('"'===e[t]){t>0&&"\\"===e[t-1]||(r=!r);continue}if(">"===e[t]&&!r)break}t<e.length?(S=e.substring(I,t+1),C(),I=t+1):(S+=e[I],I++)}else S+=e[I],I++}return S&&C(),n&&t.push(n),{parts:t,lovActions:r}}let h=e=>{let t=e.replace(/\\"/g,'"');t=t.replace(/\\\\/g,"\\");try{return JSON.parse(t)}catch(s){let e;let r={},n=/"([^"]+)":\s*(?:"([^"]*)"?|(true|false|null|\d+(?:\.\d+)?))/g;for(;null!==(e=n.exec(t));){let t=e[1],n=void 0!==e[2]?e[2]:e[3];r[t]=n}return r}}},51115:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});var n=r(46214),s=r(14438),a=r(60256),i=r(74746),o=r(50126),l=r(37675),u=r(35034),c=r(21288),d=r(88746),g=r(47902);function f(){let{setIsOutOfCreditsDialogOpen:e}=(0,a.SE)(),{removeMessage:t}=(0,i.mx)(),{showErrorDialog:r}=(0,d.t)(),{setShouldShowTipsAndTricksOnDevServerStart:f}=(0,o.pE)(),{setIsSendChatMessageMutationPending:m}=(0,l.Xr)();return{handleChatStreamingError:(a,i)=>{var o,l,d,p,v,h,_;let b;let{lastUserMessageId:S,onErrorHandled:y}=i;if(t(S),"AbortError"!==a.name){if(a instanceof u.O){if(b=a.traceId,429===a.status)c.logging.error("rate_limit_exceeded",{error:a}),(0,g.rI)(),n.ZP.capture("send_chat_request_rate_limit_exceeded"),a.message.includes("We are currently under heavy load, please try again later")?s.Am.error("We are currently under heavy load, please try again later"):r(a.message,!1,b),null==y||y();else if(402===a.status)n.ZP.capture("out_of_credits_dialog_opened"),e(!0),null==y||y();else if(503===a.status)c.logging.error("send_chat_request_service_unavailable",{error:a}),r(("string"==typeof(null===(o=a.response)||void 0===o?void 0:o.details)?a.response.details:void 0)||a.message,!1,b),null==y||y();else if(499===a.status){c.logging.info("send_chat_request_client_closed",{error:a}),null==y||y();return}else{if(a.status>=500?c.logging.error("send_chat_request_internal_error",{error:a}):c.logging.error("send_chat_request_failed",{error:a}),m(!1),f(!1),400===a.status){let e=(null===(p=a.response)||void 0===p?void 0:p.detail)||(null===(v=a.response)||void 0===v?void 0:v.details)||a.message||"Request failed";s.Am.error(e),null==y||y();return}r((null===(l=a.response)||void 0===l?void 0:l.detail)||(null===(d=a.response)||void 0===d?void 0:d.details)||a.message||"Request failed",!1,b),null==y||y()}}else"message"in a&&"type"in a?(c.logging.error("send_chat_request_error",{error:a}),r(a.message,!1)):(c.logging.error("send_chat_request_unknown_reason",{message:null==a?void 0:a.message,stack:null==a?void 0:a.stack,isOnline:navigator.onLine,errorType:a instanceof TypeError?"NetworkError":"ApplicationError",isNetworkError:null==a?void 0:null===(h=a.message)||void 0===h?void 0:h.includes("Failed to fetch"),isCorsError:null==a?void 0:null===(_=a.message)||void 0===_?void 0:_.includes("CORS"),isTimeout:(null==a?void 0:a.name)==="TimeoutError",isAbort:(null==a?void 0:a.name)==="AbortError",isDomException:a instanceof DOMException,error:a}),r()),null==y||y()}}}}},68904:function(e,t,r){"use strict";r.d(t,{t:function(){return c}});var n=r(46214),s=r(52558),a=r(74746);let i="start-request",o="first-token",l="end-request",u="start-request";function c(){let{authUser:e}=(0,s.Eu)(),t=null==e?void 0:e.uid,{snapshot:{getUserMessageCount:r,getLastUserMessage:c}}=(0,a.mx)();return{createChatRequestPerformanceMeasurer:e=>{var s,a;let{projectId:d}=e,g=1>=r(),f=null!==(a=null===(s=c())||void 0===s?void 0:s.chatOnly)&&void 0!==a&&a,m=()=>performance.getEntriesByName(i,"mark").length>0;return{measureRequestStart:()=>{performance.mark(i)},measureTimeToFirstToken:()=>{if(!m())return;performance.mark(o);let e=performance.measure(u,i,o);n.ZP.capture("time_to_first_token",{duration:e.duration,project_id:d,user_id:t,chat_only:f,is_creation:g})},measureTimeToLastToken:()=>{if(!m())return;performance.mark(l);let e=performance.measure(u,i,l);n.ZP.capture("time_to_last_token",{duration:e.duration,project_id:d,user_id:t,chat_only:f,is_creation:g})}}}}}},92441:function(e,t,r){"use strict";r.d(t,{m:function(){return d},u:function(){return c}});var n=r(5978),s=r(2265),a=r(52558),i=r(74746),o=r(90045),l=r(74541),u=r(10867);let c='\n<lov-tool-use id="thinking-opt" name="lov-think" data="">\n';function d(){let{authUser:e}=(0,a.Eu)(),t=null==e?void 0:e.uid,{updateMessage:r}=(0,i.mx)(),d=(0,o.hT)(e=>e.chatMode!==o.jE.DEFAULT);return{createOptimisticMessage:(0,s.useCallback)(e=>{var s,a;let{body:i}=e,o={id:i.id,createdAt:new Date,role:"user",type:"userMessage",selectedElements:null!==(s=i.selected_elements)&&void 0!==s?s:[],content:i.message,tags:null!==(a=i.tags)&&void 0!==a?a:[],images:[],containsError:!!i.contains_error,userId:t,optimistImageUrls:i.optimisticImageUrls};if(r(i.id,o,!0),("enabled"===i.agent_mode||!0===i.chat_only||d)&&i.ai_message_id){let e={id:i.ai_message_id,created_at:n.EK.fromDate(new Date),content:c,thinking_time_ms:0,exclude_from_history:!1,message_type:"aiMessage",status:"running",stopped:!1,graph_id:"optimistic-graph-id",role:l.r.role.AI,tag:l.r.tag.INSTANT_MODE_MESSAGE},t=(0,u.AR)(e);t&&"aiMessage"===t.type&&r(t.id,t,!0)}},[r,t,d])}}},78079:function(e,t,r){"use strict";r.d(t,{os:function(){return T},OU:function(){return j},mo:function(){return k}});var n=r(21770),s=r(6454),a=r(96484),i=r(82176),o=r(21288),l=r(10531),u=r(2925),c=r(50126),d=r(90045),g=r(37675),f=r(20958),m=r(2265),p=r(22076),v=r(29328);let h=e=>{let t=e.map(e=>{let t=JSON.stringify(e);return t.length>1e4?{type:e.type,timestamp:e.timestamp,data:{truncated:!0,originalSize:t.length}}:e}),r=0,n=[];for(let e=t.length-1;e>=0;e--){let s=JSON.stringify(t[e]);if(r+s.length<=1e6)n.unshift(t[e]),r+=s.length;else break}return JSON.stringify(n)};var _=r(74746),b=r(49131),S=r(51115),y=r(14438),E=r(24032),w=r(68904),x=r(92441),C=r(47176),I=r(10867);function k(e){let t=(0,f.C)();return j({...e,repoAccessibilityState:t})}let M={};function T(e,t){return t&&(M[e.id]||(M[e.id]=(0,s.Xm)("aimsg").toString()),e.ai_message_id=M[e.id]),e}function j(e){let{projectId:t,onRepoInaccessible:r,onSubmit:s,autoSwitchToCode:f=!1,onSuccess:k,repoAccessibilityState:M}=e,j=(0,i.dl)(l.P.AgentDefault),R=(0,u.u)(e=>e.currentPage),{setShouldShowTipsAndTricksOnDevServerStart:A}=(0,c.pE)(),{setIsSendChatMessageMutationPending:P}=(0,g.Xr)(),{createChatRequestPerformanceMeasurer:D}=(0,w.t)(),{createSseEventHandler:O}=function(e){let{autoSwitchToCode:t=!1}=e,{updateMessage:r,setLatestStreamedMessage:n,isMessageStopped:s}=(0,_.mx)(),{updateConsoleStateOnStreaming:a}=(0,C.k)({autoSwitchToCode:t});return{createSseEventHandler:()=>{let e="";return t=>{if("message"!==t.type){o.logging.error("received_unknown_chat_sse",{event_type:t.type,event_data:t.data});return}let i=t.data.message;if(s(i.id))return;let l={...i,stopped:!!i.stopped,status:"running"};n(l);let u=(0,I.AR)(l);u&&("aiMessage"===u.type||"userMessage"===u.type)?r(i.id,u,!0):o.logging.error("unknown_message_type",{message:i}),e=a(i,e)}}}}({autoSwitchToCode:f}),{handleChatStreamingError:N}=(0,S.Z)(),{isRepoAccessible:L,removeLatestMessageIfRepoInaccessible:z}=function(){let{restoreEditorState:e}=(0,E.WR)(),{removeMessage:t}=(0,_.mx)(),r=(0,m.useCallback)(e=>!e||(null==e?void 0:e.accessibility)==="repo_accessible"||(null==e?void 0:e.accessibility)==="repo_not_found",[]),n=r=>{let{onRepoInaccessible:n,latestMessageId:s}=r;null==n||n(),e(),y.Am.error("We couldn't access this project repository."),s&&t(s)};return{isRepoAccessible:r,removeLatestMessageIfRepoInaccessible:(e,t,s)=>{r(e)||n({onRepoInaccessible:s,latestMessageId:t})}}}(),{sendChatRequest:U}=function(){let{prepareMessageDiagnostics:e}=function(){let e=(0,p.D)(),{store:t}=(0,v.My)();return{prepareMessageDiagnostics:(0,m.useCallback)(r=>{let{runtimeErrors:n,latestBuildTimestamp:s}=e.store.getState(),a=t.getState().rrwebEvents;r.session_replay=h(a);let i=t.getState().consoleLogs.length,o=t.getState().networkRequests.length;r.client_logs=[...t.getState().consoleLogs.slice(Math.max(i-50,0),i)],r.network_requests=[...t.getState().networkRequests.slice(Math.max(o-50,0),o)],r.runtime_errors=[...n].filter(e=>e.timestamp>=s),e.clearDiagnostics(),t.setState(e=>{e.consoleLogs=[],e.networkRequests=[],e.rrwebEvents=[]})},[e,t])}}(),{addAbortController:t,removeAbortController:r}=(0,_.mx)();return{sendChatRequest:async n=>{let{projectId:s,body:a,onStart:i,onComplete:o}=n;e(a);let l=new AbortController;t(l),null==i||i();let u=(0,b.SJ)();try{await u.postWithStreaming("/projects/".concat(s,"/chat"),a,()=>{l.abort()},l.signal)}finally{null==o||o(),r(l)}}}}(),{createOptimisticMessage:q}=(0,x.m)(),F=(0,d.hT)(e=>e.chatMode!==d.jE.DEFAULT),W=(0,d.hT)(e=>e.chatMode===d.jE.AGENT),{selectedModel:Z}=(0,a.L6)(),V=async(e,n)=>{e.current_page=R,"enabled"!==e.agent_mode&&(e.agent_mode=W?"enabled":"disabled"),"auto"!==Z&&(e.model=Z),j&&(e.agent_mode="enabled");let s=n||t;if(!s){o.logging.error("Project ID is required to send chat message");return}let{measureRequestStart:a,measureTimeToFirstToken:i}=D({projectId:s});if(!L(M)){var l;z(M,null!==(l=e.id)&&void 0!==l?l:void 0,r);return}await U({projectId:s,body:e,onMessage:O(),onStart:a,onFirstEvent:i})};return(0,n.D)({mutationFn:async e=>{let{body:r,projectId:n,isCreation:s}=e;P(!0),s&&A(!0);let a=n||t;if(!a){o.logging.error("Project ID is required to send chat message");return}return V(T(r,F),a)},onMutate:e=>{let{body:t,clear:r}=e;q({body:T(t,F)}),null==s||s(t.message),null==r||r()},onSuccess:()=>{null==k||k()},onError:(e,t)=>{let{body:r,restore:n}=t;return N(e,{lastUserMessageId:r.id,onErrorHandled:n})}})}},47902:function(e,t,r){"use strict";r.d(t,{Y:function(){return c},ZK:function(){return a},_g:function(){return d},rI:function(){return o}});var n=r(66491),s=r(5978);let a=e=>{if(!e)return!0;let t=e instanceof s.EK?e.toDate():new Date(e);return(new Date().getTime()-t.getTime())/36e5>=24},i="lovable_rate_limit_timestamp",o=()=>{let e=Date.now();localStorage.setItem(i,e.toString())},l=()=>{let e=localStorage.getItem(i);return e?parseInt(e,10):null},u=()=>{localStorage.removeItem(i)},c=()=>{let e=l();if(!e)return{isRateLimited:!1,secondsRemaining:0};let t=Math.max(0,60-Math.floor((Date.now()-e)/1e3));return 0===t?(u(),{isRateLimited:!1,secondsRemaining:0}):{isRateLimited:!0,secondsRemaining:t}},d=e=>{let t=new Date,r=Math.floor((t.getTime()-e.getTime())/1e3);if(r<60)return"Just now";let s=Math.floor(r/60);if(s<60)return"".concat(s,"m ago");let a=Math.floor(s/60);return a<24?"".concat(a,"h ago"):e.getFullYear()===t.getFullYear()?(0,n.WU)(e,"hh:mm 'on' MMM dd"):(0,n.WU)(e,"hh:mm 'on' MMM dd yyyy")}},10867:function(e,t,r){"use strict";r.d(t,{AR:function(){return l},Fd:function(){return c},Oh:function(){return u}});var n=r(5978),s=r(6454),a=r(21288);let i=[],o=e=>"string"==typeof e?new Date(e):e instanceof n.EK?e.toDate():new n.EK(e.seconds,e.nanoseconds).toDate(),l=(e,t)=>{var r,n,s,l,u,c,d,g,f,m,p,v,h,_,b,S,y,E,w,x,C,I,k,M,T;switch(e.tag){case"instant-mode-message":if("user"===e.role)return{createdAt:o(e.created_at),role:"user",id:e.id,content:e.content,type:"userMessage",selectedElements:null!==(r=e.selected_elements)&&void 0!==r?r:i,images:null!==(n=e.images)&&void 0!==n?n:i,containsError:null!==(s=e.contains_error)&&void 0!==s&&s,tags:null!==(l=e.tags)&&void 0!==l?l:i,userId:null!==(u=e.user_id)&&void 0!==u?u:void 0,chatOnly:null!==(c=e.chat_only)&&void 0!==c&&c,isStuck:null!==(d=e.is_stuck)&&void 0!==d&&d,isSecurityReview:null!==(g=e.is_security_review)&&void 0!==g&&g};return{createdAt:o(e.created_at),role:"ai",id:e.id,content:e.content,type:"aiMessage",editId:null!==(m=e.edit_id)&&void 0!==m?m:void 0,stopped:!!e.stopped,errors:null!==(p=null===(f=e.errors)||void 0===f?void 0:f.sort((e,t)=>t.created_at.seconds-e.created_at.seconds))&&void 0!==p?p:void 0,sqlRunState:null!==(v=e.sql_run_state)&&void 0!==v?v:void 0,persisted:null!==(h=null==t?void 0:t.persisted)&&void 0!==h&&h,status:null!==(_=e.status)&&void 0!==_?_:"completed",thinkingTimeMs:null!==(b=e.thinking_time_ms)&&void 0!==b?b:void 0,timeToFirstTokenMs:null!==(S=e.time_to_first_token_ms)&&void 0!==S?S:void 0,feedbackSentiment:null!==(y=e.feedback_sentiment)&&void 0!==y?y:void 0,feedbackContent:null!==(E=e.feedback_content)&&void 0!==E?E:void 0,feedbackCategory:null!==(w=e.feedback_category)&&void 0!==w?w:void 0,costCredits:null!==(x=e.cost_credits)&&void 0!==x?x:void 0};case"branch-switched":return{createdAt:o(e.created_at),id:e.id,type:"branchSwitched",branchName:e.branch_name};case"external-commit-pushed":return{createdAt:o(e.created_at),id:e.id,type:"userCommit",shortCommitHash:null!==(C=e.commit_hash)&&void 0!==C?C:void 0,commitMessage:e.commit_message};case"revert-success":return{createdAt:o(e.created_at),id:e.id,type:"revertSuccess",shortCommitHash:null!==(I=e.commit_hash)&&void 0!==I?I:void 0,editId:null!==(k=e.edit_id)&&void 0!==k?k:""};case"manual-edit":return{createdAt:o(e.created_at),id:e.id,type:"manualEdit",content:e.content,editId:e.edit_id,errors:null!==(T=null===(M=e.errors)||void 0===M?void 0:M.sort((e,t)=>t.created_at.seconds-e.created_at.seconds))&&void 0!==T?T:void 0};case"revert":if("user"===e.role)return{createdAt:o(e.created_at),id:e.id,type:"userMessage",content:e.content,containsError:!1,tags:[],images:[],selectedElements:[],userId:e.user_id,role:"user"};return{createdAt:o(e.created_at),id:e.id,type:"aiMessage",content:e.content,role:"ai",persisted:!0,status:"completed",sqlRunState:void 0,stopped:!1};default:return a.logging.error("Unknown message tag",{message:e}),null}},u=(e,t)=>{let r={};return e.forEach(e=>{let n=e.data(),s=l(n,t);s&&(r[n.id]=s)}),r},c=()=>(0,s.Xm)("umsg").toString()},88746:function(e,t,r){"use strict";r.d(t,{Y:function(){return g},t:function(){return d}});var n=r(57437),s=r(46214),a=r(2265),i=r(59625),o=r(62869),l=r(26110),u=r(57346),c=r(67817);let d=(0,i.Ue)(e=>({open:!1,errorMessage:null,showTryAgain:!0,traceId:null,showErrorDialog:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0;return s.ZP.capture("error_dialog_shown",{error_message:t,show_try_again:r,trace_id:n}),e({open:!0,errorMessage:t,showTryAgain:r,traceId:n})},closeError:()=>e({open:!1,errorMessage:null,showTryAgain:!0,traceId:null})}));function g(){let{open:e,errorMessage:t,closeError:r,showTryAgain:i,traceId:g}=d(),[f,m]=(0,a.useState)(!1),p=(0,c.v)(),v=async()=>{if(g)try{await navigator.clipboard.writeText(g),m(!0),setTimeout(()=>m(!1),2e3)}catch(e){console.error("Failed to copy trace ID: ",e)}},h=()=>g?"https://lovable.grafana.net/a/grafana-exploretraces-app/explore?from=now-24h&to=now&timezone=browser&var-ds=grafanacloud-traces&var-primarySignal=nestedSetParent%3C0&var-filters=&var-metric=rate&var-groupBy=resource.service.name&var-spanListColumns=&var-latencyThreshold=&var-partialLatencyThreshold=&actionView=breakdown&traceId=".concat(g):"";return(0,n.jsx)(l.Vq,{open:e,onOpenChange:e=>{e||(s.ZP.capture("error_dialog_closed",{action:"backdrop",error_message:t,trace_id:g}),r())},children:(0,n.jsxs)(l.cZ,{children:[(0,n.jsxs)(l.fK,{className:"text-left",children:[(0,n.jsx)(l.$N,{className:"text-left",children:"Error"}),(0,n.jsxs)(l.Be,{className:"flex flex-col items-start",children:[(t||"An unexpected error occurred. ").split("\n").map((e,r)=>(0,n.jsxs)("span",{children:[e,r!==(t||"An unexpected error occurred. ").split("\n").length-1&&(0,n.jsx)("br",{})]},r)),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("span",{children:"Please try again later."})]}),g&&(0,n.jsx)("div",{className:"mt-2 w-full text-[10px] text-muted-foreground/70",children:(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(0,n.jsx)("p",{children:"ID:"}),(0,n.jsx)("code",{className:"relative break-all rounded bg-muted/50 px-[0.2rem] font-mono",children:g}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(o.z,{variant:"link",size:"icon-xs",className:"p-0 text-muted-foreground/70 hover:text-muted-foreground focus:ring-0 focus-visible:ring-0 focus-visible:ring-offset-0",onClick:v,"aria-label":"Copy Trace ID",tabIndex:-1,children:(0,n.jsx)(u.Z,{name:f?"check":"content_copy",size:"small"})}),p&&(0,n.jsx)(o.z,{variant:"link",size:"icon-xs",className:"p-0 text-muted-foreground/70 hover:text-muted-foreground focus:ring-0 focus-visible:ring-0 focus-visible:ring-offset-0",onClick:()=>window.open(h(),"_blank"),"aria-label":"View in Grafana",tabIndex:-1,children:(0,n.jsx)(u.Z,{name:"monitoring",size:"small"})})]})]})})]})]}),(0,n.jsx)("div",{className:"mt-4 flex justify-end gap-2",children:(0,n.jsxs)(l.cN,{className:"flex flex-row justify-end gap-2",children:[(0,n.jsx)(o.z,{variant:"outline",onClick:()=>{s.ZP.capture("error_dialog_closed",{action:"get_help",error_message:t,trace_id:g}),r(),window.open("https://docs.lovable.dev/#stay-connected","_blank")},children:"Get help"}),(0,n.jsx)(o.z,{onClick:()=>{s.ZP.capture("error_dialog_closed",{action:"ok",error_message:t,trace_id:g}),r()},autoFocus:!0,children:"Dismiss"})]})})]})})}},2925:function(e,t,r){"use strict";r.d(t,{u:function(){return n}});let n=(0,r(59625).Ue)(e=>({currentPage:"index",setCurrentPage:t=>e({currentPage:t})}))},47176:function(e,t,r){"use strict";r.d(t,{k:function(){return i}});var n=r(50126),s=r(72116),a=r(29328);function i(e){let{autoSwitchToCode:t=!1}=e,r=(0,n.Sl)(e=>e.consoleContentType),{store:i,setActiveMessageId:o,setShowConsole:l,setConsoleCodeContent:u,exitConsole:c}=(0,n.pE)(),{store:d}=(0,a.My)(),g=(e,r)=>(e.content.includes("</lov-code>")&&!r.includes("</lov-code>")?(c(),d.setState(e=>{e.consoleLogs=[],e.rrwebEvents=[]})):e.content.includes("<lov-code>")&&!r.includes("<lov-code>")&&t&&(l("code"),e.id&&o(e.id)),r),f=(e,t)=>{if(!e.content)return t;let r=i.getState().activeMessageId;if(e.id===r){for(let t of(0,s.hP)(e.content).parts)if("parts"in t)return u(t),e.content}return t};return{consoleContentType:r,updateConsoleStateOnStreaming:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t;return r=g(e,r),r=f(e,r)}}}},74746:function(e,t,r){"use strict";r.d(t,{ei:function(){return f},aM:function(){return k},mx:function(){return M},aK:function(){return T},tV:function(){return j},uO:function(){return R},$m:function(){return D},iY:function(){return P},IE:function(){return A},Fm:function(){return O}});var n=r(57437),s=r(2265),a=r(2043),i=r(37675),o=r(5978),l=r(78099);function u(e){let{array:t,batchSize:r}=e;return Array.from({length:Math.ceil(t.length/r)},(e,n)=>t.slice(n*r,(n+1)*r))}var c=r(21288);let d=e=>{let t={};return e.forEach((e,r)=>{var n,s,a,i,o,l,u,c,d;let g=e.data(),f={id:g.id,commit_sha:null!==(n=g.commit_sha)&&void 0!==n?n:"unknown",commit_message:null!==(s=g.commit_message)&&void 0!==s?s:"unknown",created_at:g.created_at,reverted:null!==(a=g.reverted)&&void 0!==a&&a,type:g.type,diff:null!==(i=g.diff)&&void 0!==i?i:null,status:null!==(o=g.status)&&void 0!==o?o:null,previewBuildStatus:null!==(l=g.preview_build_status)&&void 0!==l?l:null,bookmarked:null!==(u=g.bookmarked)&&void 0!==u&&u,revert_target_edit_id:null!==(c=g.revert_target_edit_id)&&void 0!==c?c:void 0,pages:null!==(d=g.pages)&&void 0!==d?d:[]};t[f.id]=f}),t};var g=r(10867);let f={FIRESTORE_BATCH_SIZE:30,COOLDOWN_TIME_MS:300,MESSAGES_PAGE_SIZE:30,EDIT_PAGE_SIZE:30};var m=r(10418),p=r(59625),v=r(14884);(0,m.MD)();let h=()=>(0,p.Ue)()((0,v.n)(e=>({sortedMessageIds:[],messages:{},edits:{},selectedImageUrl:void 0,imageUrlCache:{},loadingMessagesStatus:"idle",loadingEditsStatus:"idle",isInitialized:!1,hasOlderMessages:!0,hasOlderEdits:!0,canLoadMoreMessages:!0,canLoadMoreEdits:!0,stoppedMessageIds:new Set,latestStreamedMessage:void 0,abortControllers:[]})));function _(e,t){var r;return null!==(r=Object.values(e.messages).find(e=>"aiMessage"===e.type&&e.editId===t))&&void 0!==r?r:null}function b(e,t){var r;return null!==(r=Object.values(e.messages).find(e=>"userCommit"===e.type&&e.shortCommitHash===t))&&void 0!==r?r:null}function S(e,t){return Object.values(e.edits).find(e=>e.commit_sha.startsWith(t))||null}function y(e){var t,r;return null!==(r=null===(t=Object.values(e.edits).sort((e,t)=>{let r=e.created_at.toDate().getTime();return t.created_at.toDate().getTime()-r}).find(e=>!!e.pages&&!!e.pages.length))||void 0===t?void 0:t.pages)&&void 0!==r?r:null}function E(e){let{messages:t,sortedMessageIds:r}=e;for(let e=r.length-1;e>=0;e--){var n;let s=r[e];if((null===(n=t[s])||void 0===n?void 0:n.type)==="userMessage")return t[s]}return null}function w(e){let{messages:t,sortedMessageIds:r}=e;for(let e=r.length-1;e>=0;e--){var n;let s=r[e];if((null===(n=t[s])||void 0===n?void 0:n.type)==="aiMessage")return{messageId:s,message:t[s]}}return null}var x=r(96771),C=r(74541);let I=(0,s.createContext)(null),k=e=>{let{projectId:t,messageId:r,children:m}=e,p=(0,s.useRef)(h()),v=function(e){let{projectId:t}=e;return(0,s.useMemo)(()=>(0,o.IO)((0,o.hJ)(l.db,"projects",t,"trajectory"),(0,o.Xo)("created_at","desc")),[t])}({projectId:t}),y=function(e){let{projectId:t}=e;return(0,s.useMemo)(()=>(0,o.IO)((0,o.hJ)(l.db,"projects",t,"edits"),(0,o.ar)("type","in",[x.I.type.MANUAL_UPDATE,x.I.type.AI_UPDATE,x.I.type.DEVELOPER_UPDATE,x.I.type.REVERT]),(0,o.Xo)("created_at","desc")),[t])}({projectId:t}),w=function(e){let{projectId:t,messageId:r}=e;return(0,s.useMemo)(()=>r?(0,o.JU)(l.db,"projects",t,"trajectory",r):null,[t,r])}({projectId:t,messageId:r}),{updateMessage:k,removeMessage:M,isMostRecentMessage:T,getMessageByEditId:j,getUserCommitMessageByShortCommitHash:R,getUserMessageCount:A,getLastUserMessage:P}=function(e){let{storeRef:t}=e,r=(0,s.useCallback)((e,r,n)=>{t.current.getState().isInitialized&&t.current.setState(t=>{let s=t.messages[e],a=s&&n?{...s,content:r.content}:r;"ai"===r.role&&"ai"===a.role&&n&&(a.thinkingTimeMs=r.thinkingTimeMs,a.timeToFirstTokenMs=r.timeToFirstTokenMs);let i=n?[...t.sortedMessageIds.filter(e=>e!==r.id),e]:t.sortedMessageIds;return{messages:{...t.messages,[e]:a},sortedMessageIds:i}})},[t]),n=(0,s.useCallback)(e=>{t.current.setState(t=>{let{[e]:r,...n}=t.messages;return{messages:n,sortedMessageIds:t.sortedMessageIds.filter(t=>t!==e)}})},[t]),a=(0,s.useCallback)(e=>{let r=t.current.getState().sortedMessageIds;return r[r.length-1]===e},[t]),i=(0,s.useCallback)(e=>_(t.current.getState(),e),[t]);return{updateMessage:r,removeMessage:n,isMostRecentMessage:a,getMessageByEditId:i,getUserCommitMessageByShortCommitHash:(0,s.useCallback)(e=>b(t.current.getState(),e),[t]),getUserMessageCount:(0,s.useCallback)(()=>Object.values(t.current.getState().messages).filter(e=>"userMessage"===e.type).length,[t]),getLastUserMessage:(0,s.useCallback)(()=>E(t.current.getState()),[t])}}({storeRef:p}),{loadEarlierMessages:D,loadMessagesFromId:O,earliestMessageDocRef:N,processMessagesWithEdits:L}=function(e){let{storeRef:t,projectId:r,messagesQuery:n}=e,a=(0,s.useRef)(null),i=(0,s.useCallback)(async e=>{if(0===e.length)return{};let t=u({array:e,batchSize:f.FIRESTORE_BATCH_SIZE});return(await Promise.all(t.map(async e=>d((await (0,o.PL)((0,o.IO)((0,o.hJ)(l.db,"projects",r,"edits"),(0,o.ar)("id","in",e)))).docs)))).reduce((e,t)=>({...e,...t}),{})},[r]),m=(0,s.useCallback)(async(e,t)=>{let r=(0,g.Oh)(e,t),n=e.map(e=>e.data().edit_id).filter(e=>!!e);return{messages:r,edits:await i(n)}},[i]),p=(0,s.useCallback)((e,r)=>{let{messages:n,edits:s}=r,i=e.map(e=>e.id);t.current.setState(e=>({messages:{...e.messages,...n},edits:{...e.edits,...s},sortedMessageIds:[...i,...e.sortedMessageIds]})),e.length>0&&(a.current=e[0])},[t]),v=(0,s.useCallback)(async()=>{let e=t.current.getState();if(a.current&&e.canLoadMoreMessages){t.current.setState({loadingMessagesStatus:"loading",canLoadMoreMessages:!1});try{let e=(await (0,o.PL)((0,o.IO)(n,(0,o.TQ)(a.current),(0,o.b9)(f.MESSAGES_PAGE_SIZE)))).docs.reverse();if(e.length>0){a.current=e[0];let r=await m(e,{persisted:!0});t.current.setState(t=>({messages:{...t.messages,...r.messages},edits:{...t.edits,...r.edits},hasOlderMessages:e.length>=f.MESSAGES_PAGE_SIZE,sortedMessageIds:[...e.map(e=>e.id),...t.sortedMessageIds]}))}else t.current.setState({hasOlderMessages:!1});t.current.setState({loadingMessagesStatus:"success"})}catch(e){t.current.setState({loadingMessagesStatus:"error"}),c.logging.warn("Firestore error - useMessageDataFetching - loadEarlierMessages",{error:e})}finally{setTimeout(()=>{t.current.setState({canLoadMoreMessages:!0})},f.COOLDOWN_TIME_MS)}}},[n,t,m]),h=(0,s.useCallback)((e,r)=>{let n=t.current.getState();return"message_id"===r?n.messages[e]:"shortCommitHash"===r?b(n,e):_(n,e)},[t]),S=(0,s.useCallback)(async e=>{let t=(0,o.IO)(n,(0,o.Lx)(a.current||void 0),(0,o.b9)(1e3)),r=(await (0,o.PL)(t)).docs.reverse(),s=await m(r,{persisted:!0});p(r,s)},[n,m,p]),y=(0,s.useCallback)(async(e,t)=>{let r=(0,o.IO)(n,(0,o.ar)("message_id"===t?"id":"edit_id","==",e),..."message_id"===t?[(0,o.b9)(1)]:[]),s=await (0,o.PL)(r);if(!s.docs[0])return;let i="message_id"===t?s.docs[0]:s.docs.find(e=>e.data().tag===C.r.tag.INSTANT_MODE_MESSAGE);if(!i)return;let l=(0,o.IO)(n,(0,o.Lx)(i),(0,o.TQ)(a.current||void 0)),u=[i,...(await (0,o.PL)(l)).docs.reverse()],c=await m(u,{persisted:!0});p(u,c)},[n,m,p]);return{fetchEditsForMessages:i,processMessagesWithEdits:m,loadEarlierMessages:v,loadMessagesFromId:(0,s.useCallback)(async e=>{let{messageId:r,id_type:n="edit_id"}=e,s=h(r,n),a=t.current.getState();if(!(s&&a.sortedMessageIds.includes(s.id))){t.current.setState({loadingMessagesStatus:"loading"});try{"shortCommitHash"===n?await S(r):await y(r,n),t.current.setState({loadingMessagesStatus:"success"})}catch(e){t.current.setState({loadingMessagesStatus:"error"}),console.error("Error loading messages from ID",{error:e,messageId:r,id_type:n})}}},[h,S,y,t]),earliestMessageDocRef:a}}({storeRef:p,projectId:t,messagesQuery:v}),{loadEarlierEdits:z,earliestEditDocRef:U,fetchMessagesForEdits:q}=function(e){let{storeRef:t,projectId:r,editsQuery:n}=e,a=(0,s.useRef)(null),i=(0,s.useCallback)(async e=>{if(0===e.length)return{};let t=u({array:e,batchSize:f.FIRESTORE_BATCH_SIZE});return(await Promise.all(t.map(async e=>{let t=await (0,o.PL)((0,o.IO)((0,o.hJ)(l.db,"projects",r,"trajectory"),(0,o.ar)("edit_id","in",e)));return(0,g.Oh)(t.docs,{persisted:!0})}))).reduce((e,t)=>({...e,...t}),{})},[r]);return{loadEarlierEdits:(0,s.useCallback)(async()=>{if(a.current&&t.current.getState().canLoadMoreEdits){t.current.setState({loadingEditsStatus:"loading",canLoadMoreEdits:!1});try{let e=(await (0,o.PL)((0,o.IO)(n,(0,o.TQ)(a.current),(0,o.b9)(f.EDIT_PAGE_SIZE)))).docs;if(e.length>0){a.current=e[e.length-1];let r=d(e),n=Object.keys(r),s=await i(n);t.current.setState(t=>({edits:{...t.edits,...r},messages:{...t.messages,...s},hasOlderEdits:e.length>=f.EDIT_PAGE_SIZE}))}else t.current.setState({hasOlderEdits:!1});t.current.setState({loadingEditsStatus:"success"})}catch(e){t.current.setState({loadingEditsStatus:"error"}),c.logging.warn("Firestore error - useEditOperations - loadEarlierEdits",{error:e})}finally{setTimeout(()=>{t.current.setState({canLoadMoreEdits:!0})},f.COOLDOWN_TIME_MS)}}},[n,t,i]),earliestEditDocRef:a,fetchMessagesForEdits:i}}({storeRef:p,projectId:t,editsQuery:y}),{getEditByShortCommitHash:F,updateEdit:W}=function(e){let{storeRef:t}=e;return{getEditByShortCommitHash:(0,s.useCallback)(e=>S(t.current.getState(),e),[t]),updateEdit:(0,s.useCallback)((e,r)=>{t.current.setState(t=>{if(t.edits[e]){let n={...t.edits};return n[e]={...n[e],...r},{edits:n}}return t})},[t])}}({storeRef:p}),{cacheImageUrl:Z,setSelectedImageUrl:V}=function(e){let{storeRef:t}=e;return{cacheImageUrl:(0,s.useCallback)((e,r)=>{t.current.setState(t=>({imageUrlCache:{...t.imageUrlCache,[e]:r}}))},[t]),setSelectedImageUrl:(0,s.useCallback)(e=>{t.current.setState({selectedImageUrl:e})},[t])}}({storeRef:p}),{subscriptionBoundaryTime:B}=function(e){let{storeRef:t,messagesQuery:r,editsQuery:n,processMessagesWithEdits:a}=e,i=(0,s.useRef)(o.EK.now());return(0,s.useEffect)(()=>{let e=t.current,s=(0,o.cf)((0,o.IO)(r,(0,o.ar)("created_at",">=",i.current)),async t=>{let r=[...t.docs].reverse(),n=(0,g.Oh)(r,{persisted:!0});e.setState(e=>{let t=new Set(e.sortedMessageIds),s=r.map(e=>e.id).filter(e=>!t.has(e));return{messages:{...e.messages,...n},sortedMessageIds:[...e.sortedMessageIds,...s]}})}),a=(0,o.cf)((0,o.IO)(n,(0,o.ar)("created_at",">=",i.current)),t=>{let r=d([...t.docs]);e.setState(e=>({...e,edits:{...e.edits,...r}}))});return()=>{s(),a()}},[r,n,t,a]),{subscriptionBoundaryTime:i}}({storeRef:p,messagesQuery:v,editsQuery:y,processMessagesWithEdits:L}),J=(0,s.useCallback)(e=>{p.current.setState(t=>({...t,isInitialized:e}))},[p]),{loadInitialData:G}=function(e){let{storeRef:t,messagesQuery:r,editsQuery:n,subscriptionBoundaryTime:a,earliestMessageDocRef:i,earliestEditDocRef:l,processMessagesWithEdits:u,fetchMessagesForEdits:c,messageId:g,specificMessageQuery:m}=e;return{loadInitialData:(0,s.useCallback)(async()=>{let e;if(g&&m){let t=await (0,o.QT)(m);e=t.exists()?await (0,o.PL)((0,o.IO)(r,(0,o.ar)("created_at","<",a.current),(0,o.Wu)(t))):await (0,o.PL)((0,o.IO)(r,(0,o.ar)("created_at","<",a.current),(0,o.b9)(f.MESSAGES_PAGE_SIZE)))}else e=await (0,o.PL)((0,o.IO)(r,(0,o.ar)("created_at","<",a.current),(0,o.b9)(f.MESSAGES_PAGE_SIZE)));let s=e.docs.reverse();s.length>0&&(i.current=s[0]);let{messages:p,edits:v}=await u(s,{persisted:!0}),h=await (0,o.PL)((0,o.IO)(n,(0,o.ar)("created_at","<",a.current),(0,o.b9)(f.EDIT_PAGE_SIZE)));h.docs.length>0&&(l.current=h.docs[h.docs.length-1]);let _=d(h.docs),b=d((await (0,o.PL)((0,o.IO)(n,(0,o.ar)("bookmarked","==",!0)))).docs),S=Object.keys(b),y={};S.length>0&&(y=await c(S)),t.current.setState(t=>{let r={...t.messages,...p,...y},n=[...new Set([...t.sortedMessageIds,...s.map(e=>e.id)])];return n=n.sort((e,t)=>{let n=r[e],s=r[t];return n.createdAt.getTime()-s.createdAt.getTime()}),{messages:r,hasOlderMessages:e.docs.length>=f.MESSAGES_PAGE_SIZE,edits:{...t.edits,...v,..._,...b},hasOlderEdits:h.docs.length>=f.EDIT_PAGE_SIZE,sortedMessageIds:n,isInitialized:!0}})},[r,n,a,i,l,u,c,t,g,m])}}({storeRef:p,messagesQuery:v,editsQuery:y,subscriptionBoundaryTime:B,earliestMessageDocRef:N,earliestEditDocRef:U,processMessagesWithEdits:L,fetchMessagesForEdits:q,messageId:r,specificMessageQuery:w}),{setLatestStreamedMessage:H,addStoppedMessageId:K,isMessageStopped:X,addAbortController:Y,removeAbortController:$}=function(e){let{storeRef:t}=e;return{setLatestStreamedMessage:(e,r)=>{r&&e?t.current.setState(t=>({...t,sortedMessageIds:[...t.sortedMessageIds,e.id],latestStreamedMessage:e,messages:{...t.messages,[e.id]:e}})):t.current.setState(t=>({...t,latestStreamedMessage:e}))},addStoppedMessageId:e=>{e&&t.current.setState(t=>({...t,stoppedMessageIds:new Set([...t.stoppedMessageIds,e])}))},isMessageStopped:e=>{let r=t.current.getState();return!!r.latestStreamedMessage&&"stopped"in r.latestStreamedMessage&&!!r.latestStreamedMessage.stopped||r.stoppedMessageIds.has(e)},addAbortController:e=>{t.current.setState(t=>({...t,abortControllers:[...t.abortControllers,e]}))},removeAbortController:e=>{t.current.setState(t=>({...t,abortControllers:t.abortControllers.filter(t=>t!==e)}))}}}({storeRef:p}),{setIsSendChatMessageMutationPending:Q}=(0,i.Xr)(),{canEdit:ee}=(0,a.t)();(0,s.useEffect)(()=>{ee&&G()},[G,ee]);let et={store:p.current,updateMessage:k,removeMessage:M,setIsInitialized:J,loadEarlierMessages:D,loadMessagesFromId:O,loadEarlierEdits:z,cacheImageUrl:Z,setSelectedImageUrl:V,isMostRecentMessage:T,updateEdit:W,setLatestStreamedMessage:H,addStoppedMessageId:K,isMessageStopped:X,addAbortController:Y,removeAbortController:$,abortRequests:()=>{Q(!1),p.current.getState().abortControllers.forEach(e=>{e.abort()}),p.current.setState(e=>({...e,abortControllers:[]}))},snapshot:{getEditByShortCommitHash:F,getMessageByEditId:j,getUserCommitMessageByShortCommitHash:R,getUserMessageCount:A,getLastUserMessage:P}};return(0,n.jsx)(I.Provider,{value:et,children:m})};function M(){let e=(0,s.useContext)(I);if(!e)throw Error("useChatContext must be used within a ChatProvider");return e}function T(e){let t=M();if(!t)throw Error("useChatStore must be used within a ChatProvider");return t.store(e)}function j(e){return T(t=>e?t.edits[e]:null)}function R(e){return T(t=>e?S(t,e):null)}function A(){return T(y)}function P(){return T(E)}function D(){return T(w)}function O(e){return T(t=>e?_(t,e):null)}},7455:function(e,t,r){"use strict";r.d(t,{c:function(){return f},h:function(){return g}});var n=r(57437),s=r(92850),a=r(2265),i=r(59625),o=r(52558),l=r(33187),u=r(77113);let c=()=>(0,i.Ue)(()=>({collaborators:[],accessLevel:null,collaboratorsInitialized:!1,hasFetchedCollaborators:!1})),d=(0,a.createContext)(null),g=e=>{let{children:t,projectId:r}=e,i=(0,a.useRef)(c()),{authUser:g}=(0,o.Eu)(),f=(0,u.iZ)(e=>e.project),{data:m,isFetched:p}=(0,s.a)(l.W.collaborators({projectId:r,projectOwnerId:null==f?void 0:f.user_id}));(0,a.useEffect)(()=>{if(m&&(null==f?void 0:f.user_id)){let e=(0,l.b)({collaborators:m,projectOwnerId:f.user_id});i.current.setState({collaborators:e})}},[m,null==f?void 0:f.user_id]),(0,a.useEffect)(()=>{if(null==g?void 0:g.uid){let e=null==m?void 0:m.find(e=>e.id===(null==g?void 0:g.uid));e&&e.joined_at?i.current.setState({accessLevel:e.access_level}):i.current.setState({accessLevel:null})}},[null==g?void 0:g.uid,m]),(0,a.useEffect)(()=>{p&&i.current.setState({hasFetchedCollaborators:!0})},[p]);let v={store:i.current};return(0,n.jsx)(d.Provider,{value:v,children:t})};function f(e){let{store:t}=function(){let e=(0,a.useContext)(d);if(!e)throw Error("useCollaborationContext must be used within a CollaborationProvider");return e}();return t(e)}},50126:function(e,t,r){"use strict";r.d(t,{BV:function(){return c},Sl:function(){return g},pE:function(){return d},vD:function(){return o}});var n=r(57437),s=r(2265),a=r(59625),i=r(40878);let o={error:"Error",code:"Code",debug:"Debug",annotation:"Annotation","snapshot-preview":"Snapshot Preview",mermaid:"Mermaid Diagram"},l=()=>(0,a.Ue)(()=>({activeView:"preview",consoleContentType:null,activeMessageId:void 0,activeEditId:void 0,activeConsoleCodeContent:void 0,activeConsoleErrorContent:void 0,activeConsolePreviewContent:void 0,activeConsoleMermaidContent:void 0,shouldShowTipsAndTricksOnDevServerStart:!1})),u=(0,s.createContext)(null),c=e=>{let{children:t}=e,r=(0,s.useRef)(l()),{setIsPreviewDocked:a,setView:o}=(0,i.zp)(),c={store:r.current,setActiveView:e=>{r.current.setState({activeView:e})},setShowConsole:e=>{let t=r.current;"snapshot-preview"!==e&&null!==e&&a(!0),t.setState({consoleContentType:e,activeView:e?"console":"preview"}),o(e?i.$.PREVIEW:i.$.CHAT)},setConsoleContentType:e=>{let t=r.current;t.setState({consoleContentType:e,activeView:e?"console":t.getState().activeView})},setActiveMessageId:e=>{r.current.setState({activeMessageId:e})},setActiveEditId:e=>{r.current.setState({activeEditId:e})},setConsoleCodeContent:e=>{r.current.setState({activeConsoleCodeContent:e})},setConsoleErrorContent:e=>{r.current.setState({activeConsoleErrorContent:e})},setConsolePreviewContent:e=>{r.current.setState({activeConsolePreviewContent:e})},setActiveMermaidContent:e=>{r.current.setState({activeConsoleMermaidContent:e})},setShouldShowTipsAndTricksOnDevServerStart:e=>{r.current.setState({shouldShowTipsAndTricksOnDevServerStart:e})},exitConsole:()=>{r.current.setState({consoleContentType:null,activeView:"preview",activeMessageId:void 0,activeEditId:void 0,activeConsoleErrorContent:void 0,activeConsoleCodeContent:void 0,activeConsolePreviewContent:void 0,activeConsoleMermaidContent:void 0,shouldShowTipsAndTricksOnDevServerStart:!1}),o(i.$.CHAT)}};return(0,n.jsx)(u.Provider,{value:c,children:t})};function d(){let e=(0,s.useContext)(u);if(!e)throw Error("useConsoleContext must be used within a ConsoleProvider");return e}function g(e){let{store:t}=d();return t(e)}},90045:function(e,t,r){"use strict";r.d(t,{VK:function(){return f},cb:function(){return g},es:function(){return a},hT:function(){return m},jE:function(){return i}});var n,s,a,i,o=r(57437),l=r(2265),u=r(59625);(n=a||(a={})).RAW="RAW",n.DIFF="DIFF",(s=i||(i={})).DEFAULT="default",s.CHAT_ONLY="chat-only",s.AGENT="agent";let c=()=>(0,u.Ue)(()=>({chatMode:"default",codeViewType:"RAW"})),d=(0,l.createContext)(null),g=e=>{let{children:t}=e,r=(0,l.useRef)(c()),n={store:r.current,setChatMode:e=>{let t=r.current;"function"==typeof e?t.setState(t=>({chatMode:e(t.chatMode)})):t.setState({chatMode:e})},setCodeViewType:e=>{r.current.setState({codeViewType:e})}};return(0,o.jsx)(d.Provider,{value:n,children:t})};function f(){let e=(0,l.useContext)(d);if(!e)throw Error("useEditorModeContext must be used within an EditorModeProvider");return e}function m(e){let{store:t}=f();return t(e)}},37675:function(e,t,r){"use strict";r.d(t,{Xr:function(){return c},bk:function(){return d},pY:function(){return g},vw:function(){return u}});var n=r(57437),s=r(2265),a=r(59625),i=r(14884);let o=()=>(0,a.Ue)()((0,i.n)(e=>({isSendChatMessageMutationPending:!1,isBuildErrorOccurredDuringStream:!1,isSomeRevertMutationPending:!1,editIdToConfirmRestoreFor:void 0}))),l=(0,s.createContext)(null),u=e=>{let{children:t}=e,r=(0,s.useRef)(o()),a={store:r.current,setIsSendChatMessageMutationPending:e=>{r.current.setState({isSendChatMessageMutationPending:e,isBuildErrorOccurredDuringStream:!1})},setIsBuildErrorOccurredDuringStream:e=>{r.current.setState({isBuildErrorOccurredDuringStream:e})},setIsSomeRevertMutationPending:e=>{r.current.setState({isSomeRevertMutationPending:e})},setEditIdToConfirmRestoreFor:e=>{r.current.setState({editIdToConfirmRestoreFor:e})}};return(0,n.jsx)(l.Provider,{value:a,children:t})};function c(){let e=(0,s.useContext)(l);if(!e)throw Error("useMessageSubmissionContext must be used within a MessageSubmissionProvider");return e}function d(e){let{store:t}=c();return t(e)}let g=()=>{let{isSendChatMessageMutationPending:e,isSomeRevertMutationPending:t}=d(e=>e);return e||t}},40878:function(e,t,r){"use strict";r.d(t,{$:function(){return s},eP:function(){return c},gu:function(){return g},zp:function(){return d}});var n,s,a=r(57437),i=r(2265),o=r(59625);(n=s||(s={})).PREVIEW="preview",n.CHAT="chat";let l=()=>(0,o.Ue)(()=>({view:"chat",isPreviewDocked:!0,showHistoryPanel:!1})),u=(0,i.createContext)(null),c=e=>{let{children:t}=e,r=(0,i.useRef)(l()),n={store:r.current,setView:e=>{let t=r.current;"function"==typeof e?t.setState(t=>({view:e(t.view)})):t.setState({view:e})},setIsPreviewDocked:e=>{let t=r.current;"function"==typeof e?t.setState(t=>({isPreviewDocked:e(t.isPreviewDocked)})):t.setState({isPreviewDocked:e})}};return(0,a.jsx)(u.Provider,{value:n,children:t})};function d(){let e=(0,i.useContext)(u);if(!e)throw Error("useMobileContext must be used within a MobileProvider");return e}function g(e){let{store:t}=d();return t(e)}},29328:function(e,t,r){"use strict";r.d(t,{i5:function(){return K},wF:function(){return A},g9:function(){return H},XE:function(){return J},My:function(){return P},f6:function(){return D},vE:function(){return O}});var n=r(57437),s=r(92850),a=r(53974),i=r(2265),o=r(14273),l=r(59625),u=r(14884),c=r(88568),d=r(21288);let g=e=>{var t,r,n,s,a,i,o,l;let u=Object.entries(e.headers||{}).reduce((e,t)=>{let[r,n]=t;return e+r.length+String(n).length},0);return((null===(t=e.responseBody)||void 0===t?void 0:t.length)||0)+((null===(r=e.requestBody)||void 0===r?void 0:r.length)||0)+((null===(s=e.error)||void 0===s?void 0:null===(n=s.message)||void 0===n?void 0:n.length)||0)+((null===(i=e.error)||void 0===i?void 0:null===(a=i.stack)||void 0===a?void 0:a.length)||0)+((null===(o=e.url)||void 0===o?void 0:o.length)||0)+((null===(l=e.statusText)||void 0===l?void 0:l.length)||0)+u},f=e=>e.reduce((e,t)=>e+t.message.length,0);var m=r(98015),p=r(65666),v=r(49131),h=r(76906),_=r(3813),b=r(22076),S=r(61062),y=r(7163),E=r(48614),w=r(1188),x=e=>{let{isLoading:t}=e,[r,s]=(0,i.useState)(0),[a,o]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t&&(s(0),o(!0))},[t]),(0,i.useEffect)(()=>{if(!t){s(100);return}let e=[];return[{duration:150,increment:15},{duration:250,increment:10},{duration:400,increment:5},{duration:500,increment:3},{duration:650,increment:3},{duration:750,increment:3},{duration:1500,increment:2},{duration:2e3,increment:1},{duration:3e3,increment:1},{duration:4e3,increment:1},{duration:5e3,increment:1},{duration:6e3,increment:1},{duration:7e3,increment:1},{duration:1e4,increment:1},{duration:14e3,increment:1}].forEach(t=>{let{duration:r,increment:n}=t,a=setTimeout(()=>{s(e=>e<75?e+n+2*Math.random():e)},r);e.push(a)}),()=>{e.forEach(e=>clearTimeout(e))}},[t]),(0,n.jsx)("div",{className:"pointer-events-none absolute left-0 right-0 top-0 h-[3px] w-full overflow-hidden bg-transparent",children:(0,n.jsx)(E.M,{children:a&&(0,n.jsx)(w.E.div,{className:"h-full bg-accent",initial:{width:0,opacity:1},animate:{width:"".concat(Math.min(r,100),"%"),opacity:1},exit:{opacity:0,transition:{delay:.2,duration:.3}},transition:{width:{duration:.15,bounce:0}},onAnimationComplete:()=>{t||o(!1)}})})})};function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";try{let r=new URL(e);return t.useCustomScript&&r.searchParams.set("lov-override-script","true"),t.accessToken&&r.searchParams.set("__lovable_token",t.accessToken),r.toString()}catch(t){return console.error("Error formatting preview URL:",t),e}}function I(e){if(!e)return null;try{return e.replace("http://","ws://").replace("https://","wss://")}catch(e){return console.error("Error converting to WebSocket URL:",e),null}}var k=r(37675),M=r(27613),T=r(77113);let j=e=>(0,l.Ue)()((0,u.n)(()=>({device:"desktop",customScript:!1,_sandboxState:null,_isSandboxStateStale:!1,isStartingSandboxInTheBackground:!1,targetMode:M.i.STATIC,activeMode:M.i.STATIC,visibleMode:M.i.STATIC,currentPath:"/",baseUrls:{static:(0,h.t)({projectId:e}),live:null},error:null,consoleLogs:[],networkRequests:[],rrwebEvents:[],accessToken:void 0}))),R=(0,i.createContext)(null);function A(e){let{children:t}=e,r=(0,p.D)(),[l]=(0,i.useState)(()=>j(r)),u=(0,i.useRef)(null),c=(0,i.useRef)(null),g=(0,i.useMemo)(()=>({live:u,static:c}),[]),f=l(e=>e.targetMode===M.i.LIVE&&"running"===e._sandboxState?M.i.LIVE:M.i.STATIC);(0,i.useEffect)(()=>{l.setState(e=>{e.activeMode=f})},[f,l]);let{data:h}=(0,s.a)({queryKey:["accessToken"],queryFn:async()=>{let e=(0,v.SJ)(),{token:t}=await e.get("/projects/".concat(r,"/auth-token"));return t}});(0,i.useEffect)(()=>{h&&l.setState(e=>{e.accessToken=h})},[h,l]),(0,i.useEffect)(()=>{if("live"!==f){l.setState(e=>{e.visibleMode=M.i.STATIC});return}if("live"===f){let e=setTimeout(()=>{l.setState(e=>{e.visibleMode=M.i.LIVE})},2e3);return()=>clearTimeout(e)}},[f,l]);let S=l(e=>e.targetMode),E=l(e=>e._sandboxState);!function(e){let t=(0,v.SJ)(),r=(0,p.D)(),{setIsBuildErrorOccurredDuringStream:n}=(0,k.Xr)(),s=(0,b.D)(),a=(0,i.useMemo)(()=>{let t=e.enabled&&e.url?new URL(e.url):null;return t?I("".concat(t.protocol,"//").concat(t.host)):null},[e.enabled,e.url]);(0,o.useWebSocket)(a,{protocols:"vite-hmr",share:!0,onMessage:e=>{try{let i=JSON.parse(e.data);if((null==i?void 0:i.type)==="update"){let e=Date.now()-500;s.updateLatestBuildTimestamp(e)}if((null==i?void 0:i.type)==="error"){var a;n(!0),d.logging.info("build_error_from_devserver",{message:null==i?void 0:null===(a=i.err)||void 0===a?void 0:a.message});let e=y.p.safeParse(null==i?void 0:i.err);e.success?(0,m.e)(e.data,r,t):(d.logging.error("error_parsing_devserver_error",{error:e}),(0,m.e)(null==i?void 0:i.err,r,t))}}catch(e){d.logging.error("error_parsing_devserver_error",{error:e})}},onOpen:t=>{var r;null===(r=e.onStatusChange)||void 0===r||r.call(e,"running"),d.logging.debug("devserver_websocket_open")},onClose:t=>{var r;null===(r=e.onStatusChange)||void 0===r||r.call(e,"stopped"),d.logging.debug("devserver_websocket_close")},onError:t=>{var r;null===(r=e.onStatusChange)||void 0===r||r.call(e,"error"),d.logging.error("devserver_websocket_error",{event:t})},shouldReconnect:()=>!0,reconnectInterval:1e3})}({enabled:"live"===S&&"running"===E,url:l(e=>e.baseUrls.live)});let w=e=>{l.setState(t=>{t.device=e})},x=e=>{l.setState(t=>{t.customScript=e})},C=(0,_.W7)(),A=(0,i.useCallback)(()=>{l.setState(e=>{e.targetMode="static",e._sandboxState=null,e._isSandboxStateStale=!0,e.error=null})},[l]),P=(0,i.useCallback)(()=>{C&&l.setState(e=>{("live"!==e.targetMode||"running"!==e._sandboxState||e.error)&&(e.targetMode="live",e._sandboxState="starting",e.error=null,e.isStartingSandboxInTheBackground=!0)})},[C,l]),D=(0,i.useCallback)(()=>{l.setState(e=>{("live"!==e.targetMode||"running"!==e._sandboxState||e.error)&&(e.targetMode="live",e._sandboxState="starting",e.error=null,e.isStartingSandboxInTheBackground=!1)})},[l]),O=(0,i.useCallback)(e=>{l.setState(e=>{e._sandboxState="starting",e.targetMode="live",e.error=null})},[l]),N=(0,i.useCallback)(()=>{l.setState(e=>{e._sandboxState="error",e.error={type:"dev_server",message:"Sorry, we ran into an issue starting the live preview!"}})},[l]),B=(0,i.useCallback)(async()=>{l.setState(e=>{e._sandboxState="starting",e.error=null});try{let e=(0,v.SJ)(),t=await e.post("/projects/".concat(r,"/sandbox/start"),{project_id:r});l.setState(e=>{t.url&&!t.url.endsWith("/")&&(t.url=t.url+"/"),e.baseUrls.live=t.url,e._isSandboxStateStale=!0})}catch(e){N()}},[r,N,l]),J=(0,i.useCallback)(async e=>{let t=l.getState();if("live"===t.targetMode&&(t.error||"error"===t._sandboxState)){O(),l.setState(t=>{t.currentPath=null!=e?e:"/"});return}if(e)l.setState(t=>{t.currentPath=e});else{var r;null===(r=g[t.targetMode].current)||void 0===r||r.reload()}},[g,O,l]),G=(0,i.useCallback)(()=>{l.setState(e=>{e._sandboxState="running",e.error=null})},[l]),H=(0,i.useMemo)(()=>({store:l,setDevice:w,setCustomScript:x,startLiveMode:D,startLiveModeInBackground:P,restartLiveMode:O,revertToStaticMode:A,refreshPreview:J,refs:g,buildFullPreviewUrl:V}),[]),K=(0,T.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),X=l(e=>"live"===e.targetMode&&"starting"===e._sandboxState)&&!!K;(0,i.useEffect)(()=>{X&&B()},[B,X]);let Y=(0,a.c3)(18e5);return(0,n.jsxs)(R.Provider,{value:H,children:[(0,n.jsx)(L,{}),(0,n.jsx)(U,{}),"live"===f&&(0,n.jsx)(z,{}),"live"===S&&"error"!==E&&!Y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F,{}),(0,n.jsx)(q,{}),(0,n.jsx)(W,{}),(0,n.jsx)(Z,{onStarted:G,onFatalError:N,onTransientError:O,onInactivityTimeout:A})]}),t]})}function P(){let e=(0,i.useContext)(R);if(!e)throw Error("usePreviewContext must be used within a PreviewProvider");return e}function D(e){let{store:t}=P();return t(e)}function O(){let e=D(e=>e.baseUrls.live);return(0,i.useMemo)(()=>{if(!e)return null;let t=new URL(e);return I("".concat(t.protocol,"//").concat(t.host))},[e])}let N=async e=>{let t;try{if(!(t=await fetch("".concat(e,"_sandbox/dev-server"),{})).ok)return"offline"}catch(e){return"unknown"}try{let e=await t.json();switch(e.state){case"error":case"stopped":case"stopping":case"disabled":case"starting":case"started":case"disabled":return e.state;default:return d.logging.error("unexpected_dev_server_state",{state:e.state}),"unknown"}}catch(e){return d.logging.debug("malformed_dev_server_state_response",{error:e}),"error"}};function L(){let e=P().refs[M.i.STATIC],t=(0,T.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.preview_build_commit_sha}),r=(0,i.useRef)(t);return(0,i.useEffect)(()=>{if(t&&r.current&&t!==r.current){var n;null===(n=e.current)||void 0===n||n.reload()}r.current=t},[t,e]),null}function z(){let e=P().refs[M.i.LIVE];return(0,i.useEffect)(()=>{var t;null===(t=e.current)||void 0===t||t.reload()},[e]),null}function U(){let e=D(e=>e.targetMode),t=P().startLiveMode,r=(0,k.bk)(e=>e.isSendChatMessageMutationPending);return(0,i.useEffect)(()=>{r&&"static"===e&&t()},[r,e,t]),null}function q(){let e=D(e=>e._isSandboxStateStale),t=P().store;return(0,i.useEffect)(()=>{if(e)return;let r=setTimeout(()=>{t.setState(e=>{e._isSandboxStateStale=!0})},"starting"===t.getState()._sandboxState?250:1e4);return()=>clearTimeout(r)},[e,t]),null}function F(){let e=P().store;return(0,i.useEffect)(()=>{e.setState(e=>{e._isSandboxStateStale||(e._isSandboxStateStale=!0)})},[e]),null}function W(){let e=P().store;return(0,i.useEffect)(()=>{let t=()=>{"visible"===document.visibilityState&&e.setState(e=>{e._isSandboxStateStale||(e._isSandboxStateStale=!0)})};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[e]),null}function Z(e){let{onStarted:t,onTransientError:r,onFatalError:n,onInactivityTimeout:s}=e,a=D(e=>e._isSandboxStateStale),o=P().store;return(0,i.useEffect)(()=>{if(!a)return;let e=!0;return async function(){try{let a=o.getState().baseUrls.live;if(!a)return;let i=await N(a);if(!e)return;switch(i){case"offline":s();case"error":n();break;case"unknown":case"stopped":r();break;case"started":t()}}finally{if(!e)return;o.setState(e=>{e._isSandboxStateStale=!1})}}(),()=>{e=!1}},[a,n,r,t,s,o]),null}function V(e){let{baseUrl:t,path:r}=e;if(!t)return null;let n=t.endsWith("/")?t.slice(0,-1):t,s=r.startsWith("/")?r:"/".concat(r);return"".concat(n).concat(s)}let B=(0,i.forwardRef)((e,t)=>{let{url:r,useCustomScript:s,accessToken:a,onNavigate:o,onMessage:l,id:u}=e,d=(0,i.useRef)(null),[g,f]=(0,i.useState)(null),[m,p]=(0,i.useState)(!0),v=(0,T.iZ)(e=>e.project),h=v&&!v.is_protected||a,_=g&&h?C(g,{useCustomScript:s,accessToken:a}):null;return(0,i.useImperativeHandle)(t,()=>({reload(){d.current&&(d.current.src=_||d.current.src)}}),[_]),(0,i.useEffect)(()=>{if(d.current&&r&&r!==g&&h){let e=C(r,{useCustomScript:s,accessToken:a});f(r),p(!0),d.current.src=e}},[a,h,g,o,r,s]),(0,i.useEffect)(()=>{let e=e=>{var t;if((null===(t=d.current)||void 0===t?void 0:t.contentWindow)===e.source){if("URL_CHANGED"===e.data.type){if(e.data.url!==g&&(f(e.data.url),e.data.url)){let{pathname:t,search:r,hash:n}=new URL(e.data.url),s=t;r&&(s+=r),n&&(s+=n),o(s)}}else"404"===e.data?p(!1):l(e)}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[g,l,o]),(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)(x,{isLoading:!0}),(0,n.jsx)("iframe",{sandbox:c.h,ref:d,id:u,className:"min-h-full w-full flex-grow",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",onLoad:()=>p(!1),onError:()=>{p(!1)}})]})});B.displayName="PreviewIframe";let J=e=>"".concat(e,"-preview-panel");function G(e){let t=J(e);return(0,i.memo)(function(){let r=D(t=>t.activeMode===e),s=D(e=>e.currentPath),[a,o]=(0,i.useState)(s);(0,i.useEffect)(()=>{r&&o(s)},[r,s]);let{fullUrl:l,customScript:u,accessToken:c}=D(t=>({fullUrl:V({baseUrl:t.baseUrls[e],path:a}),customScript:t.customScript,accessToken:t.accessToken})),h=(0,i.useMemo)(()=>l,[l]),{store:_}=P(),E=P().refs[e],w=(0,p.D)(),x=(0,b.D)(),C=(0,v.SJ)(),I=(0,i.useCallback)(e=>{o(e),r&&_.setState(t=>{t.currentPath!==e&&(t.currentPath=e)})},[_,r,o]),k=(0,i.useCallback)(e=>{if(r){var t,n;if(!function(e,t){if("CONSOLE_OUTPUT"!==e.data.type)return;let r=[];if(Array.isArray(e.data.messages))e.data.messages.forEach(t=>{"object"==typeof t&&null!==t&&"string"==typeof t.message&&"string"==typeof t.level?r.push({level:t.level,message:t.message.length>1e4?t.message.slice(0,1e4):t.message,logged_at:t.logged_at||e.data.logged_at||new Date().toISOString()}):d.logging.warn("Received invalid message format within messages array",{msgData:t})});else if("string"==typeof e.data.message&&"string"==typeof e.data.level)r.push({level:e.data.level,message:e.data.message.length>1e4?e.data.message.slice(0,1e4):e.data.message,logged_at:e.data.logged_at||new Date().toISOString()});else{d.logging.warn("Received invalid CONSOLE_OUTPUT data format",{data:e.data});return}t(e=>{r.length>50?e.consoleLogs=r.slice(0,50):e.consoleLogs.push(...r);let t=f(e.consoleLogs);for(;t>1e4||e.consoleLogs.length>50;){let r=e.consoleLogs.shift();if(!r)break;t-=r.message.length}})}(e,_.setState),t=_.setState,"NETWORK_REQUEST"===e.data.type&&t(t=>{let r={...e.data.request};r.responseBody&&r.responseBody.length>1e4&&(r.responseBody=r.responseBody.slice(0,1e4)),r.requestBody&&r.requestBody.length>1e4&&(r.requestBody=r.requestBody.slice(0,1e4)),r.error&&(r.error.message&&r.error.message.length>1e4&&(r.error.message=r.error.message.slice(0,1e4)),r.error.stack&&r.error.stack.length>1e4&&(r.error.stack=r.error.stack.slice(0,1e4))),r.url&&r.url.length>1e4&&(r.url=r.url.slice(0,1e4)),r.statusText&&r.statusText.length>1e4&&(r.statusText=r.statusText.slice(0,1e4)),t.networkRequests.push(r);let n=t.networkRequests.reduce((e,t)=>e+g(t),0);for(;n>1e5||t.networkRequests.length>50;){let e=t.networkRequests.shift();if(!e)break;n-=g(e)}}),n=_.setState,"RRWEB_EVENT"===e.data.type&&n(t=>{for(t.rrwebEvents.push(e.data.event);t.rrwebEvents.length>60;)t.rrwebEvents.shift()}),"RUNTIME_ERROR"===e.data.type||"UNHANDLED_PROMISE_REJECTION"===e.data.type)x.addRuntimeError(e.data.error,e.data.type);else if("FETCH_ERROR"===e.data.type){let t=y.W.safeParse(e.data.error),r=t.success?t.data:e.data.error;t.error&&d.logging.error("error_parsing_fetch_error",{error:t.error,event_data:e.data}),"status"in r&&(null==r?void 0:r.status)>=400&&(null==r?void 0:r.status)<500?(0,m.e)({...r,error_type:S.N.HTTP_CLIENT_ERROR},w,C):(0,m.e)({...r,error_type:S.N.HTTP_SERVER_ERROR},w,C)}}},[r,_,x,w,C]);return(0,n.jsx)(B,{ref:E,id:t,url:h,useCustomScript:u,accessToken:c,onNavigate:I,onMessage:k})})}let H=G("static"),K=G("live")},27613:function(e,t,r){"use strict";r.d(t,{H:function(){return n},i:function(){return s}});let n={mobile:{name:"mobile",tooltip:"Show desktop preview",icon:"devices"},tablet:{name:"tablet",tooltip:"Show mobile preview",icon:"devices"},desktop:{name:"desktop",tooltip:"Show tablet preview",icon:"devices"}},s={STATIC:"static",LIVE:"live"}},77113:function(e,t,r){"use strict";r.d(t,{jI:function(){return C},d2:function(){return k},iZ:function(){return M}});var n=r(57437),s=r(21770),a=r(5978),i=r(99376),o=r(2265),l=r(14438),u=r(59625),c=r(52558),d=r(60256),g=r(88391),f=r(49131),m=r(78099),p=r(21288),v=r(5460),h=r(62869),_=r(26110),b=r(57346),S=r(41135);let y=e=>{let{done:t}=e,r=(0,i.useRouter)();return(0,n.jsxs)(_.cZ,{className:"gap-4 outline-none focus:ring-0",size:"md",hideCloseButton:!0,blurOverlay:!0,onInteractOutside:e=>{e.preventDefault()},children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,n.jsx)(S.xx,{className:"h-9"}),(0,n.jsxs)(_.fK,{children:[(0,n.jsx)(_.$N,{className:"text-2xl md:text-3xl",children:"Sorry, you don't have access"}),(0,n.jsx)(_.Be,{children:"This project is private. To view it, contact the owner or switch accounts."})]})]}),(0,n.jsxs)(_.cN,{fullWidthButtons:!0,className:"flex-col",children:[(0,n.jsx)(h.z,{onClick:()=>{r.push("/"),t()},className:"w-full",variant:"outline",children:"Go home"}),(0,n.jsxs)(h.z,{onClick:()=>{r.push("/"),t()},className:"w-full",children:[(0,n.jsx)(b.Z,{name:"add",className:"h-4 w-4"}),"Create your own project"]})]})]})},E=e=>(0,u.Ue)(()=>({projectId:e,project:void 0,isDeleting:!1,hasHandledCollaborationInvite:!1,isRemixDialogOpen:!1})),w=(e,t)=>{let r=(0,o.useRef)(void 0);return(0,o.useEffect)(()=>{"pending"===e?r.current=l.Am.loading(t.pending.title,t.pending.options):"success"===e?r.current?(l.Am.success(t.success.title,{id:r.current,...t.success.options,duration:3e3,dismissible:!1}),r.current=void 0):l.Am.success(t.success.title,t.success.options):"error"===e&&(r.current?(l.Am.error(t.error.title,{id:r.current,...t.error.options,duration:3e3,dismissible:!1}),r.current=void 0):l.Am.error(t.error.title,t.error.options))},[e]),{dismiss:()=>{r.current&&(l.Am.dismiss(r.current),r.current=void 0)}}},x=(0,o.createContext)(null),C=e=>{let{children:t,projectId:r}=e;return(0,n.jsx)(I,{projectId:r,children:t},r)},I=e=>{let{children:t,projectId:r}=e,u=(0,o.useRef)(E(r)),h=(0,g.z)(y),_=(0,i.useRouter)(),{isAuthenticated:b}=(0,c.Eu)(),{userData:S}=(0,d.SE)(),C=u.current(e=>e.hasHandledCollaborationInvite);(0,o.useEffect)(()=>{if(!r||!C)return;let e=(0,a.JU)(m.db,"projects",r),t=(0,a.cf)(e,e=>{let t=e.data();t&&!t.deleted_at?u.current.setState({project:t}):u.current.getState().isDeleting||(p.logging.error("PROJECT NOT FOUND",{projectId:r,docExists:e.exists(),userId:null==S?void 0:S.id}),_.push("/projects/not-found"))},e=>{if(p.logging.error("PROJECT PERMISSION ERROR",{error:e,projectId:r}),"permission-denied"===e.code){p.logging.error("PROJECT PERMISSION DENIED",{error:e,projectId:r}),h({childProps:{done:()=>h(!1)}});return}l.Am.error("Error",{description:"Failed to fetch project."})});return()=>{t()}},[r,S,b,_,C,h]);let I=(0,s.D)({mutationFn:async e=>{let{project:t}=u.current.getState();if(!t)return;let n=(0,f.SJ)();await n.put("/projects/".concat(r),e)},onMutate:e=>{let t=u.current,{project:r}=t.getState();r&&t.setState({project:{...r,...e}})},throwOnError:!0}),k=(0,s.D)({mutationFn:e=>e?(0,f.SJ)().put("/projects/".concat(r,"/visibility"),{visibility:e}):Promise.resolve(),onSuccess:(e,t)=>{"public"===t?l.Am.success("Visibility updated",{description:"Your project is now public."}):"private"===t?l.Am.success("Visibility updated",{description:"Your project is now private."}):l.Am.success("Visibility updated")},onError:()=>{l.Am.error("Error",{description:"Failed to update visibility"})}}),M=(0,s.D)({mutationFn:async e=>{let t=(0,f.SJ)(),n=await t.post("/projects/".concat(r,"/badge/visibility"),{hide_badge:e});return await (0,v.G)({projectId:r}),n}});w(M.status,{pending:{title:"Updating badge visibility..."},success:{title:"Badge visibility updated"},error:{title:"Failed to update badge visibility",options:{duration:3,description:"We couldn't update the badge visibility right now. Please try again in a few minutes."}}});let T={store:u.current,updateProject:(e,t)=>{I.mutate(e,{onSuccess:()=>{(null==t?void 0:t.onSuccess)&&t.onSuccess()},onError:e=>{(null==t?void 0:t.onError)&&t.onError(e)}})},setVisibilityMutation:k,setBadgeVisibility:M.mutateAsync,setHasHandledCollaborationInvite:e=>{u.current.setState({hasHandledCollaborationInvite:e})},setIsRemixDialogOpen:e=>{u.current.setState({isRemixDialogOpen:e})}};return(0,n.jsx)(x.Provider,{value:T,children:t})};function k(){let e=(0,o.useContext)(x);if(!e)throw Error("useProjectContext must be used within a ProjectProvider");return e}function M(e){let{store:t}=k();return t(e)}},71759:function(e,t,r){"use strict";r.d(t,{MD:function(){return _},c8:function(){return v},hO:function(){return b},q$:function(){return S}});var n=r(57437),s=r(92850),a=r(5978),i=r(2265),o=r(59625),l=r(52558),u=r(78099),c=r(21288),d=r(89668),g=r(43930),f=r(77113);let m=()=>(0,o.Ue)(()=>({projectWorkspace:null,memberships:[],permissions:{read:!1,write:!1,admin:!1},isLoading:!0,hasFetchedProjectWorkspace:!1})),p=(0,i.createContext)(null),v=e=>{var t;let{children:r}=e,o=(0,i.useRef)(m()),{authUser:v}=(0,l.Eu)(),h=null!==(t=(0,f.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.workspace_id}))&&void 0!==t?t:void 0,[_,b]=(0,i.useState)(null),[S,y]=(0,i.useState)("idle");(0,i.useEffect)(()=>{if(!h){b(null),y("success");return}y("loading");let e=(0,a.JU)(u.db,"workspaces",h);return(0,a.cf)(e,e=>{e.exists()?b(e.data()):b(null),y("success")},e=>{c.logging.error("Error fetching workspace",{error:e,workspaceId:h}),y("error")})},[h]);let{data:E,isLoading:w}=(0,s.a)(d.t.workspaceMemberships({workspaceId:h,userId:null==v?void 0:v.uid}));(0,i.useEffect)(()=>{let e=(null==E?void 0:E.memberships)||[],t=e.find(e=>e.user_id===(null==v?void 0:v.uid)),r={read:!!t,write:!!t,admin:(null==t?void 0:t.role)==="admin"||(null==t?void 0:t.role)==="owner"};o.current.setState({projectWorkspace:_,memberships:e,permissions:r,isLoading:"loading"===S||w})},[_,S,E,w,null==v?void 0:v.uid]),(0,i.useEffect)(()=>{("success"===S||"error"===S)&&o.current.setState({hasFetchedProjectWorkspace:!0})},[S]);let x=(0,g.i)();(0,i.useEffect)(()=>(null==x||x.setProjectWorkspaceId(null!=h?h:null),()=>{null==x||x.setProjectWorkspaceId(null)}),[h,x]);let C={store:o.current};return(0,n.jsx)(p.Provider,{value:C,children:r})};function h(){return(0,i.useContext)(p)}function _(){return!!h()}function b(e){let{store:t}=function(){let e=(0,i.useContext)(p);if(!e)throw Error("useProjectWorkspaceContext must be used within a ProjectWorkspaceProvider");return e}();return t(e)}function S(e){let t=h(),r=null==t?void 0:t.store;return r?r(e):null}},20958:function(e,t,r){"use strict";r.d(t,{$:function(){return d},C:function(){return g}});var n=r(57437),s=r(92850),a=r(2265),i=r(59625),o=r(2043),l=r(79804);let u=()=>(0,i.Ue)(()=>({repoAccessibilityResponse:void 0})),c=(0,a.createContext)(null),d=e=>{let{children:t,projectId:r}=e,i=(0,a.useRef)(u()),d=(0,a.useMemo)(()=>({store:i.current}),[]),{canEdit:g,isProjectAdmin:f}=(0,o.t)(),{data:m}=(0,s.a)(l.V.repoAccessibility({projectId:r,userProjectPermissions:{admin:f,edit:g}}));return(0,a.useEffect)(()=>{i.current&&i.current.setState(e=>({...e,repoAccessibilityResponse:m}))},[m]),(0,n.jsx)(c.Provider,{value:d,children:t})};function g(){let{store:e}=function(){let e=(0,a.useContext)(c);if(!e)throw Error("useRepoAccessibility must be used within a RepoAccessibilityProvider");return e}();return e(e=>e.repoAccessibilityResponse)}},55157:function(e,t,r){"use strict";r.d(t,{r:function(){return a}});var n=r(99376),s=r(2265);let a=()=>{let e=(0,n.useRouter)(),t=(0,n.usePathname)(),r=(0,n.useSearchParams)();return{activeTab:r.get("settings"),openSettings:(0,s.useCallback)(function(n){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new URLSearchParams(r);n?a.set("settings",n):a.set("settings","");let i="".concat(t,"?").concat(a.toString());s?e.replace(i):e.push(i)},[t,e,r]),closeSettings:(0,s.useCallback)(()=>{let n=new URLSearchParams(r);n.delete("settings"),e.push("".concat(t,"?").concat(n.toString()))},[t,e,r])}}},18735:function(e,t,r){"use strict";r.d(t,{N:function(){return u}});var n=r(57437),s=r(77712);r(2265);var a=r(94508),i=r(1691),o=r.n(i);let l=(0,s.j)("",{variants:{variant:{default:o().shimmerText,success:o().shimmerTextSuccess}},defaultVariants:{variant:"default"}}),u=e=>{let{children:t,className:r,isShimmering:s=!1,variant:i,...o}=e;return(0,n.jsx)("span",{className:(0,a.cn)(r,s&&l({variant:i})),...o,children:t})}},35974:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var n=r(57437),s=r(77712);r(2265);var a=r(94508);let i=(0,s.j)("inline-flex items-center rounded-sm px-2 py-px text-xs font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",accent:"border-transparent bg-accent text-accent-foreground hover:bg-accent/80",affirmative:"border-transparent bg-affirmative text-affirmative-foreground hover:bg-affirmative/80",outline:"text-foreground border border-border","brand-bubblegum":"bg-brand-bubblegum text-brand-bubblegum-foreground hover:bg-brand-bubblegum/80","brand-tiger":"bg-brand-tiger text-brand-tiger-foreground hover:bg-brand-tiger/80","brand-saffron":"bg-brand-saffron text-brand-saffron-foreground hover:bg-brand-saffron/80","brand-sapphire":"bg-brand-sapphire text-brand-sapphire-foreground hover:bg-brand-sapphire/80","brand-twilight":"bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80","brand-flamingo":"bg-brand-flamingo text-brand-flamingo-foreground hover:bg-brand-flamingo/80"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(i({variant:r}),t),...s})}},19060:function(e,t,r){"use strict";r.d(t,{X:function(){return l}});var n=r(57437),s=r(9270),a=r(2265),i=r(94508),o=r(57346);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.fC,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),...a,children:(0,n.jsx)(s.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(o.Z,{name:"check",className:"h-4 w-4"})})})});l.displayName=s.fC.displayName},57054:function(e,t,r){"use strict";r.d(t,{J2:function(){return o},xo:function(){return l},xp:function(){return u},yk:function(){return c}});var n=r(57437),s=r(27312),a=r(2265),i=r(94508);let o=s.fC,l=s.xz;s.ee;let u=s.x8,c=a.forwardRef((e,t)=>{let{className:r,align:a="center",sideOffset:o=4,...l}=e;return(0,n.jsx)(s.h_,{children:(0,n.jsx)(s.VY,{ref:t,align:a,sideOffset:o,className:(0,i.cn)("z-[10000] w-72 rounded-xl border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...l})})});c.displayName=s.VY.displayName},53647:function(e,t,r){"use strict";r.d(t,{Bw:function(){return p},DI:function(){return c},Ph:function(){return u},Ql:function(){return h},i4:function(){return g},ki:function(){return d},n5:function(){return v}});var n=r(57437),s=r(20653),a=r(56873),i=r(2265),o=r(57346),l=r(94508);let u=a.fC,c=a.ZA,d=a.B4,g=i.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,n.jsxs)(a.xz,{ref:t,className:(0,l.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[s,(0,n.jsx)(a.JO,{asChild:!0,children:(0,n.jsx)(o.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})})]})});g.displayName=a.xz.displayName;let f=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)(a.u_,{ref:t,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",r),...i,children:(0,n.jsx)(s.g8U,{className:"h-4 w-4"})})});f.displayName=a.u_.displayName;let m=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)(a.$G,{ref:t,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",r),...i,children:(0,n.jsx)(s.v4q,{className:"h-4 w-4"})})});m.displayName=a.$G.displayName;let p=i.forwardRef((e,t)=>{let{className:r,children:s,position:i="popper",...o}=e;return(0,n.jsx)(a.h_,{children:(0,n.jsxs)(a.VY,{ref:t,className:(0,l.cn)("relative z-[10000] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-card text-card-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:i,...o,children:[(0,n.jsx)(f,{}),(0,n.jsx)(a.l_,{className:(0,l.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,n.jsx)(m,{})]})})});p.displayName=a.VY.displayName;let v=i.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(a.__,{ref:t,className:(0,l.cn)("px-2 py-1.5 text-sm font-medium",r),...s})});v.displayName=a.__.displayName;let h=i.forwardRef((e,t)=>{let{className:r,children:i,...o}=e;return(0,n.jsxs)(a.ck,{ref:t,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r),...o,children:[(0,n.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(a.wU,{children:(0,n.jsx)(s.nQG,{className:"h-4 w-4"})})}),(0,n.jsx)(a.eT,{children:i})]})});h.displayName=a.ck.displayName,i.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(a.Z0,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=a.Z0.displayName},76818:function(e,t,r){"use strict";r.d(t,{g:function(){return i}});var n=r(57437),s=r(2265),a=r(94508);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("textarea",{className:(0,a.cn)("flex w-full rounded-md bg-muted px-2 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});i.displayName="Textarea"},98015:function(e,t,r){"use strict";r.d(t,{e:function(){return a}});var n=r(21288);r(83079);var s=(0,r(12119).$)("da2287705922bbaa0f34883f5fb3e5ba79e3e1b9");async function a(e,t,r){try{let a=await s(e);if(!a){n.logging.debug("skipping_reporting_error",{error:e,err_message:e.message});return}let i=a.error_type;await r.post("/projects/".concat(t,"/report_error"),{message:null==a?void 0:a.message,error_type:i,meta_data:a})}catch(e){n.logging.error("failed_to_report_intercepted_error",{error:e})}}},94949:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(2265),s=r(26034);let a=()=>({upload:(0,n.useCallback)(async e=>{let{fileName:t,file:r,options:n,continueOnError:a=!0}=e;return(0,s.cT)(t,r,n,a)},[]),download:(0,n.useCallback)(async e=>(0,s.Sv)(e),[])})},65666:function(e,t,r){"use strict";r.d(t,{D:function(){return a},v:function(){return s}});var n=r(99376);let s=()=>{let e=(0,n.useParams)().project_id;return e&&"string"==typeof e?e:null},a=()=>{let e=s();if(!e)throw Error("Project ID is required and should always be set here");return e}},72253:function(e,t,r){"use strict";r.d(t,{I:function(){return g},S:function(){return c}});var n=r(92850),s=r(29827),a=r(2265),i=r(14438),o=r(91115),l=r(49131),u=r(97318);let c=e=>{let{workspaceId:t}=e,{data:r,isLoading:s}=(0,n.a)({queryKey:u.E.supabaseOrganizations(t),queryFn:async()=>{let e=(0,l.SJ)();return await e.get("/workspaces/".concat(t,"/supabase-organizations"))},enabled:!!t}),a=!r||0===r.length;return{supabaseOrganizations:r,isLoading:s,noOrganizations:a}},d=o.z.object({type:o.z.literal("supabaseAuth"),success:o.z.boolean(),error:o.z.string().optional()}),g=e=>{let{workspaceId:t,onConnectSuccess:r}=e,n=(0,s.NL)();(0,a.useEffect)(()=>{let e=async e=>{if(e.origin!==window.location.origin)return;let s=d.safeParse(e.data);s.success&&(s.data.success?(i.Am.success("Connection Successful",{description:"Your Supabase organization has been linked to your workspace. Select a project to finish the setup."}),await n.invalidateQueries({queryKey:u.E.supabaseOrganizations(t)}),null==r||r()):i.Am.error("Connection Failed",{description:s.data.error||"Failed to connect to Supabase. Please try again."}))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[n,t,r])}},2043:function(e,t,r){"use strict";r.d(t,{t:function(){return c}});var n=r(52558),s=r(60256),a=r(6812),i=r(7455),o=r(77113),l=r(71759),u=r(20984);let c=()=>{let e=(0,o.iZ)(e=>e.project),t=(0,l.hO)(e=>e.projectWorkspace),{authUser:r,isAuthenticated:c}=(0,n.Eu)(),{userData:d}=(0,s.SE)(),g=(0,i.c)(e=>e.accessLevel),f=(0,l.hO)(e=>e.memberships).find(e=>e.user_id===(null==r?void 0:r.uid)),m=(0,l.hO)(e=>e.isLoading),p=(0,a.Q)(e=>e.workspaces).some(t=>t.id===(null==e?void 0:e.workspace_id)),v=t&&t.owner_id===(null==r?void 0:r.uid)||(null==f?void 0:f.role)==="owner",h=(null==f?void 0:f.role)==="admin"||v,_=(null==e?void 0:e.user_id)&&(null==e?void 0:e.user_id)===(null==r?void 0:r.uid)||(null==d?void 0:d.is_admin)||(null==e?void 0:e.user_id)==="claimable"||g===u.u.ADMIN||(null==f?void 0:f.role)==="admin"||v,b=g===u.u.WRITE||(null==f?void 0:f.role)==="member"||_,S=e&&r&&e.user_id===r.uid,y=g===u.u.READ||(null==f?void 0:f.role)==="member"||b||(null==e?void 0:e.visibility)==="public";return{isProjectAdmin:_,canEdit:b,isProjectOwner:S,isWorkspaceOwner:v,isLoading:c&&!r||!e||m&&p,isWorkspaceMember:!!f,isWorkspaceAdmin:h,canRead:y}}},26034:function(e,t,r){"use strict";r.d(t,{Sv:function(){return i},_c:function(){return o},cT:function(){return a}});var n=r(49131),s=r(21288);let a=async function(e,t,a){var i,o;let l=!(arguments.length>3)||void 0===arguments[3]||arguments[3],u=null!==(i=null==a?void 0:a.maxFileSize)&&void 0!==i?i:3145728,c=null!==(o=null==a?void 0:a.maxDimension)&&void 0!==o?o:2e3,d=t;if(t.type.startsWith("image/")){let e=new Image;if(e.src=URL.createObjectURL(t),await new Promise(t=>e.onload=t),t.size>u||Math.max(e.width,e.height)>c)try{let{default:e}=await r.e(4937).then(r.bind(r,24937));d=await e(t,{maxSizeMB:u/1024/1024,maxWidthOrHeight:Math.min(c,1920),useWebWorker:!0})}catch(e){if(s.logging.error("Error compressing image:",{error:e}),!l)throw e}}let g={file_name:e,content_type:d.type,status:"uploading"},f=await (0,n.SJ)().post("/files/generate-upload-url",g),m=await fetch(f.url,{method:"PUT",body:d,headers:{"Content-Type":d.type}});if(!m.ok){let t=Error("Upload failed with status ".concat(m.status));if(s.logging.error("File upload failed:",{fileName:e,status:m.status}),!l)throw t}},i=async e=>(0,n.SJ)().post("/files/generate-download-url",e),o=async e=>(0,n.SJ)().post("/files/generate-public-url",e)},24032:function(e,t,r){"use strict";r.d(t,{qG:function(){return S},Eh:function(){return E},WR:function(){return y}});var n=r(57437),s=r(2265),a=r(59625),i=r(89651),o=r(14438),l=r(52558),u=r(94949);let c=async(e,t)=>{let r=await fetch(e),n=await r.blob();return new File([n],t,{type:n.type})},d=e=>{let{upload:t}=(0,u.F)(),{isAuthenticated:r}=(0,l.Eu)(),n=e(e=>e.setImages);return{uploadImages:(0,s.useCallback)(async e=>{if(!r)return;let s=e.filter(e=>!e.uploaded&&!e.uploading);if(0===s.length)return;n(e=>e.map(e=>s.some(t=>t.id===e.id)?{...e,uploading:!0}:e));let a=s.map(async e=>{let r=await c(e.url,e.name);return await t({fileName:e.id,file:r,continueOnError:!0}),e.id}),i=new Set((await Promise.allSettled(a)).filter(e=>"fulfilled"===e.status).map(e=>e.value)),l=new Set(s.filter(e=>!i.has(e.id)).map(e=>e.id));l.size>0&&o.Am.error("Image upload failed",{description:"Failed to upload ".concat(l.size," file").concat(l.size>1?"s":"",". Removing failed uploads.")}),n(e=>e.filter(e=>!l.has(e.id)).map(e=>s.some(t=>t.id===e.id)?{...e,uploading:!1,uploaded:i.has(e.id)}:e))},[t,n,r])}},g={message:"",images:[],imagesAddedViaDropdown:!1,suggestionLabel:void 0,wasCleared:!1},f=e=>({id:e.id,url:e.url,name:e.name,uploaded:e.uploaded}),m=e=>({id:e.id,url:e.url,name:e.name,uploading:!1,uploaded:e.uploaded}),p=async e=>{try{return(await fetch(e)).ok}catch(e){return!1}},v=(e,t)=>{let r=e(e=>e.setMessage),n=e(e=>e.setSuggestionLabel),a=e(e=>e.setImages),o=e(e=>e.setImagesAddedViaDropdown),{uploadImages:l}=d(e),u=(0,s.useRef)(!1),[c,v]=(0,i.Z)("editor-store-".concat(t),{defaultValue:g,storageSync:!1});(0,s.useEffect)(()=>{v(e=>{if(!e.wasCleared){let{message:t,images:s,imagesAddedViaDropdown:i,suggestionLabel:l}=e;Promise.all(s.map(async e=>e.url.startsWith("blob:")?await p(e.url)?e:null:e)).then(e=>{let s=e.filter(e=>null!==e).map(m);r(t),n(l),a(s),o(i)})}return e})},[t,a,o,r,n,v]);let h=(0,s.useCallback)(e=>{v(t=>{if(u.current)return u.current=!1,t;let r={message:e.message,images:e.images.map(f),imagesAddedViaDropdown:e.imagesAddedViaDropdown,suggestionLabel:e.suggestionLabel,wasCleared:!1};return l(e.images),r})},[v,l]);return(0,s.useEffect)(()=>e.subscribe(h),[e,h]),{clearEditorState:(0,s.useCallback)(()=>{u.current=!0,v(e=>({...e,wasCleared:!0})),e.getState().clearEditorState()},[v,e]),restoreEditorState:(0,s.useCallback)(()=>{v(e=>{if(e.wasCleared){let{message:t,images:s,imagesAddedViaDropdown:i,suggestionLabel:l}=e,u=s.map(m);return r(t),n(l),a(u),o(i),{...e,wasCleared:!1}}return e})},[v,r,n,a,o]),setStorageData:v}},h={message:"",images:[],imagesAddedViaDropdown:!1,suggestionLabel:void 0},_=()=>(0,a.Ue)(e=>({...h,setMessage:t=>{e({message:t,suggestionLabel:void 0})},setSuggestionLabel:t=>{e({suggestionLabel:t})},setImages:t=>{Array.isArray(t)?0===t.length?e({images:t,imagesAddedViaDropdown:!1}):e({images:t}):e(e=>{let r=t(e.images);return 0===r.length?{images:r,imagesAddedViaDropdown:!1}:{images:r}})},setImagesAddedViaDropdown:t=>{e({imagesAddedViaDropdown:t})},clearEditorState:()=>{e(h)}})),b=(0,s.createContext)(null),S=e=>{let{children:t,localStorageKey:r}=e,a=(0,s.useRef)(_()),{clearEditorState:i,restoreEditorState:o,setStorageData:l}=v(a.current,r),u=(0,s.useMemo)(()=>({store:a.current,clearEditorState:i,restoreEditorState:o,setStorageData:l}),[i,o,l]);return(0,n.jsx)(b.Provider,{value:u,children:t})};function y(){let e=(0,s.useContext)(b);if(!e)throw Error("useEditorStore must be used within an EditorStoreProvider");return e}function E(e){let{store:t}=y();return t(e)}},22076:function(e,t,r){"use strict";r.d(t,{m:function(){return m},D:function(){return p}});var n=r(57437),s=r(2265),a=r(59625),i=r(98015),o=r(65666),l=r(21288),u=r(91115);let c=u.z.object({message:u.z.string().min(1),stack:u.z.string().optional(),filename:u.z.string().optional(),lineno:u.z.number().optional(),colno:u.z.number().optional(),blankScreen:u.z.boolean().optional()});var d=r(49131);let g=()=>(0,a.Ue)(()=>({runtimeErrors:[],latestBuildTimestamp:0})),f=(0,s.createContext)({store:g(),clearDiagnostics:()=>{},clearBlankScreenErrors:()=>{},updateLatestBuildTimestamp:()=>{},addRuntimeError:()=>{throw Error("ProjectDiagnostics must be used within a ProjectDiagnosticsProvider")}}),m=e=>{let{children:t}=e,r=(0,o.v)();if(!r)throw Error("Project ID is required and should always be set here");let a=(0,s.useRef)();a.current||(a.current=g());let u=(0,d.SJ)(),m={store:a.current,clearDiagnostics:()=>{a.current.setState({runtimeErrors:[]})},addRuntimeError:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RUNTIME_ERROR",n=function(e){let t=c.safeParse(e);return t.success?(t.data.stack||l.logging.warn("diagnostics.runtime_error.stack_missing",{parse_error:t.error,error_data:e}),t.data.filename||l.logging.warn("diagnostics.runtime_error.filename_missing",{parse_error:t.error,error_data:e}),t.data):(l.logging.error("diagnostics.runtime_error.invalid",{parse_error:t.error,error_data:e}),null)}(e);if(!n)return;n.blankScreen&&(0,i.e)({...n,error_type:"runtime"},r,u).catch(e=>{l.logging.error("error_reporting_runtime_error",{error:e})});let s=a.current,o=function(e,t){let r={timestamp:Date.now(),error_type:e,message:t.message||"Unknown error",filename:t.filename||"Unknown file",lineno:t.lineno||0,colno:t.colno||0,stack:t.stack||"Unavailable",has_blank_screen:(null==t?void 0:t.blankScreen)||!1};return r.message.length>1e4&&(r.message=r.message.slice(0,1e4)),r.stack.length>1e4&&(r.stack=r.stack.slice(0,1e4)),r}(t,n);s.setState(e=>{let t=[...e.runtimeErrors],r=t.findIndex(e=>0==e.lineno?e.message===o.message:e.filename===o.filename&&e.colno===o.colno&&e.lineno===o.lineno);-1!==r&&t.splice(r,1),t.push(o);let n=t.reduce((e,t)=>e+v(t),0);for(;n>1e5||t.length>50;){let e=t.shift();if(!e)break;n-=v(e)}return{runtimeErrors:t}})},updateLatestBuildTimestamp:e=>{let t=a.current;e>t.getState().latestBuildTimestamp&&t.setState({latestBuildTimestamp:e})},clearBlankScreenErrors:()=>{let e=a.current;e.setState({runtimeErrors:e.getState().runtimeErrors.filter(e=>!e.has_blank_screen)})}};return(0,n.jsx)(f.Provider,{value:m,children:t})};function p(){return(0,s.useContext)(f)}let v=e=>{var t,r,n,s,a,i;return((null===(t=e.error_type)||void 0===t?void 0:t.length)||0)+((null===(r=e.message)||void 0===r?void 0:r.length)||0)+((null===(n=e.filename)||void 0===n?void 0:n.length)||0)+((null===(s=e.lineno)||void 0===s?void 0:s.toString().length)||0)+((null===(a=e.colno)||void 0===a?void 0:a.toString().length)||0)+((null===(i=e.stack)||void 0===i?void 0:i.length)||0)}},79804:function(e,t,r){"use strict";r.d(t,{V:function(){return i}});var n=r(52274),s=r(49131),a=r(97318);let i={repoAccessibility:e=>{let{projectId:t,userProjectPermissions:r}=e;return(0,n.C)({queryKey:a.pL.repoAccessibility(t),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/repo-accessibility")),enabled:r.edit&&!!t})},installations:e=>{let{enabled:t}=e;return(0,n.C)({queryKey:a.pL.installations(),queryFn:()=>(0,s.SJ)().get("/users/github-installations"),enabled:t})}}},33187:function(e,t,r){"use strict";r.d(t,{W:function(){return l},b:function(){return u}});var n=r(52274),s=r(49131),a=r(21288),i=r(20984),o=r(97318);let l={sourceCode:e=>{let{projectId:t,enabled:r}=e;return(0,n.C)({queryKey:o.iZ.sourceCode(t),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/source-code")),enabled:r})},feedbackStatus:e=>{let{projectId:t}=e;return(0,n.C)({queryKey:o.iZ.feedbackStatus(t),queryFn:async()=>(0,s.SJ)().get("/user/feedback-status")})},presence:e=>{let{projectId:t,authUser:r,enablePresence:a}=e;return(0,n.C)({queryKey:o.iZ.presence(t),queryFn:()=>r?(0,s.SJ)().post("/projects/".concat(t,"/presence")):Promise.resolve(null),enabled:!!r&&!!t&&a,refetchInterval:6e4,refetchOnWindowFocus:!0,refetchOnMount:!0})},magicCode:e=>{let{projectId:t}=e;return(0,n.C)({queryKey:o.iZ.secretLinkId(t),queryFn:async()=>{let e=(0,s.SJ)(),r=(await e.get("/projects/".concat(t,"/magic-codes"))).magic_codes;return r&&0!==r.length?{id:r[0].id}:{id:null}}})},sharedWithMe:()=>(0,n.C)({queryKey:o.iZ.sharedWithMe(),queryFn:async()=>(0,s.SJ)().get("/user/projects/shared")}),collaborators:e=>{let{projectId:t,projectOwnerId:r}=e,i=(0,s.SJ)();return(0,n.C)({queryKey:o.iZ.collaborators(null!=t?t:""),enabled:!!t&&!!r,refetchInterval:6e4,queryFn:async()=>{try{var e;let n=null!==(e=await i.get("/projects/".concat(t,"/collaborators")))&&void 0!==e?e:[];return u({collaborators:n,projectOwnerId:r})}catch(e){return a.logging.error("Failed to fetch collaborators",{error:e}),[]}}})},communityProjects:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"recent",r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return(0,n.C)({queryKey:o.iZ.communityProjects(e,t,r,a),queryFn:async()=>(0,s.Tb)().get("".concat("/projects/community","?limit=").concat(e,"&order_by=").concat(t).concat(r&&"all"!==r?"&category=".concat(r):"").concat(a?"&start_after=".concat(a):"").concat("trending"===t?"&feature_source=trending":""))})},securityWarnings:e=>{let{projectId:t,enabled:r}=e;return(0,n.C)({queryKey:o.iZ.securityWarnings(t),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/security-warnings")),enabled:r})},analytics:e=>{let{projectId:t,timePeriod:r}=e;return(0,n.C)({queryKey:o.iZ.analytics(t,r),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/analytics"),{params:{startDate:r.startDate,endDate:r.endDate,granularity:r.granularity}})})},analyticsTrend:e=>{let{projectId:t}=e;return(0,n.C)({queryKey:o.iZ.analyticsTrend(t),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/analytics/trend")),refetchInterval:6e4})},projectDetails:e=>{let{projectId:t}=e;return(0,n.C)({queryKey:o.iZ.projectDetails(t),queryFn:async()=>(0,s.SJ)().get("/projects/".concat(t,"/details"))})}};function u(e){let{collaborators:t,projectOwnerId:r}=e;return[...t].sort((e,t)=>{let n=r&&e.id===r,s=r&&t.id===r;return n&&!s?-1:!n&&s?1:e.access_level===i.u.ADMIN&&t.access_level!==i.u.ADMIN?-1:e.access_level!==i.u.ADMIN&&t.access_level===i.u.ADMIN?1:(e.email||"").localeCompare(t.email||"")})}},20984:function(e,t,r){"use strict";var n,s;r.d(t,{u:function(){return n}}),(s=n||(n={})).ADMIN="admin",s.WRITE="write",s.READ="read",s.NONE="none"},96771:function(e,t,r){"use strict";var n,s,a,i;r.d(t,{I:function(){return n}}),(a=(s=n||(n={})).type||(s.type={})).AI_UPDATE="ai_update",a.REVERT="revert",a.INITIAL="initial",a.DEVELOPER_UPDATE="developer_update",a.MANUAL_UPDATE="manual_update",(i=s.feedback||(s.feedback={})).POSITIVE="positive",i.NEGATIVE="negative",i.NO_FEEDBACK="no_feedback"},61062:function(e,t,r){"use strict";var n,s;r.d(t,{N:function(){return n}}),(s=n||(n={})).IMMEDIATE_RUNTIME="immediate_runtime",s.RUNTIME="runtime",s.BUILD="build",s.DEPLOY_SUPABASE_FUNCTIONS="deploy_supabase_functions",s.HTTP_CLIENT_ERROR="http_client_error",s.CORS_ERROR="cors_error",s.HTTP_SERVER_ERROR="http_server_error",s.NO_CODE_CHANGE="no_code_change",s.CODE_DIFF="code_diff",s.FILE_EDITED_WITHOUT_PERMISSION="file_edited_without_permission",s.EXCLUDED_FILE_EDITED="excluded_file_edited",s.SUPABASE_EDGE_FUNCTION_ERROR="supabase_edge_function_error",s.DEPENDENCY_INSTALL="dependency_install",s.SUPABASE_SQL_ERROR="supabase_sql_error",s.SEARCH_REPLACE_FAILED="search_replace_failed",s.SEARCH_REPLACE_MISSING_FILE="search_replace_missing_file",s.CHANGED_MISSING_FILE="changed_missing_file",s.RENAME_FAILED="rename_failed",s.DELETION_FAILED="deletion_failed"},74541:function(e,t,r){"use strict";var n,s,a;r.d(t,{r:function(){return n}}),(a=(s=n||(n={})).role||(s.role={})).AI="ai",a.USER="user",(s.tag||(s.tag={})).INSTANT_MODE_MESSAGE="instant-mode-message"},5460:function(e,t,r){"use strict";r.d(t,{G:function(){return s}});var n=r(25566);let s=async e=>{let{projectId:t}=e;if(!t)throw Error("Project ID is required");let r=n.env.NEXT_PUBLIC_PROXY_WORKER_PROTOCOL||"https",s=new URL("".concat(r,"://deployments.").concat("lovable.app"));return await fetch(s.toString(),{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({project_id:t})})}},7163:function(e,t,r){"use strict";r.d(t,{W:function(){return l},p:function(){return a}});var n=r(91115),s=r(61062);let a=n.z.object({frame:n.z.string().optional(),id:n.z.string().optional(),loc:n.z.object({file:n.z.string().optional(),line:n.z.number().optional(),column:n.z.number().optional()}).optional(),message:n.z.string(),plugin:n.z.string().optional(),pluginCode:n.z.string().optional(),stack:n.z.string().optional()}).transform(e=>({...e,error_type:s.N.IMMEDIATE_RUNTIME})),i=n.z.object({body:n.z.string(),message:n.z.string(),status:n.z.number(),statusText:n.z.string().optional(),url:n.z.string()}),o=n.z.object({message:n.z.string(),method:n.z.enum(["OPTIONS","GET","POST","PUT","DELETE","PATCH"]),origin:n.z.string().optional(),stack:n.z.string().optional(),url:n.z.string()}),l=n.z.union([i,o])},1691:function(e){e.exports={shimmerText:"ShimmeringText_shimmerText__SMwG_",shimmer:"ShimmeringText_shimmer__1AZHS",shimmerTextSuccess:"ShimmeringText_shimmerTextSuccess__itzB9"}}}]);